<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta name="theme-color" content="#123456"><meta name="generator" content="Hexo 4.2.0"><title>标签: 小车 - Homepage of Jinghua Xu</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="Homepage of Jinghua Xu"><meta name="msapplication-TileImage" content="/img/photo.jpg"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Homepage of Jinghua Xu"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="144x144" href="/img/photo.jpg"><meta name="description" content="重庆大学2022级明月科创实验班人工智能专业本科在读"><meta property="og:type" content="blog"><meta property="og:title" content="Homepage of Jinghua Xu"><meta property="og:url" content="http://asgard-tim.github.io/"><meta property="og:site_name" content="Homepage of Jinghua Xu"><meta property="og:description" content="重庆大学2022级明月科创实验班人工智能专业本科在读"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://asgard-tim.github.io/img/og_image.png"><meta property="article:author" content="Tim"><meta property="article:tag" content="Blog"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://asgard-tim.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://Asgard-Tim.github.io"},"headline":"Homepage of Jinghua Xu","image":["http://asgard-tim.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Tim"},"publisher":{"@type":"Organization","name":"Homepage of Jinghua Xu","logo":{"@type":"ImageObject","url":"http://asgard-tim.github.io/img/title1.png"}},"description":"重庆大学2022级明月科创实验班人工智能专业本科在读"}</script><link rel="icon" href="/img/photo.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/xt256.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/title1.png" alt="Homepage of Jinghua Xu" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">时间轴</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com">GitHub</a><a class="navbar-item" target="_blank" rel="noopener" title="Contect me on GitHub" href="https://github.com/Asgard-Tim"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">标签</a></li><li class="is-active"><a href="#" aria-current="page">小车</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2024-06-25T18:21:03.000Z" title="2024/6/26 02:21:03">2024-06-26</time>发表</span><span class="level-item"><time datetime="2025-03-02T17:36:08.447Z" title="2025/3/3 01:36:08">2025-03-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a><span>&nbsp;/&nbsp;</span><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%9F%BA%E7%A1%80/">机器人基础</a></span><span class="level-item">1 小时读完 (大约11920个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/26/robot/">串联式机械臂小车</a></p><div class="content"><div id="postchat_postcontent"><h2 id="一、串联式机械臂概括"><a href="#一、串联式机械臂概括" class="headerlink" title="一、串联式机械臂概括"></a>一、串联式机械臂概括</h2><h3 id="1-应用领域总结分析"><a href="#1-应用领域总结分析" class="headerlink" title="1.应用领域总结分析"></a>1.应用领域总结分析</h3><p>近年来，随着工业自动化水平的飞速发展，工业机器人在现代机械制造中发挥着越来越重要的作用，而串联机械臂作为工业制造领域的关键载体对航天、汽车等制造领域正起着越来越重要的作用，尤其在复杂和环境恶劣的作业条件下，更扮演着不可替代的角色。串联机械臂作为一种多学科高度综合的产品，集成了机械、计算机电子、自动控制理论等于一体，其技术水准直接反映了国家工业制造水平，目前广泛应用于汽车及汽车零部件制造业、机械加工行业、木材与家居制造业等领域，提高了各加工制造业的作业效率。比如焊接机器人在机械加工领域中代替传统的人工焊接，不仅提高了焊接效率和焊接精度，而且解决了工人在焊接恶劣条件的安全问题。</p>
<p><img src="/images/robot/media/image3.png" alt="图1：焊接机器人"></p>
<p>由于具有较高的灵活性和多自由度，串联机械臂在许多领域都有广泛应用：</p>
<p>（1）<strong>自动化生产线</strong>：串联机器人在汽车制造、电子产品组装、食品加工等自动化生产线上发挥重要作用。它们可以完成精细的装配、焊接、喷涂等工作，提高生产效率和产品质量。</p>
<p>（2）<strong>医疗和健康</strong>：串联机器人在手术、康复辅助和医疗器械制造等领域得到应用。它们可以进行精确的手术操作、康复训练和辅助活动，提高手术精度和患者疗效。</p>
<p>（3）<strong>仓储和物流</strong>：串联机器人在仓储和物流领域可以完成货物的搬运、分拣和装载等任务。</p>
<p>（4）<strong>精密加工</strong>：串联机器人在精密加工领域扮演着重要角色，如机械零件加工、精密雕刻和模具制造等。其高精度和灵活性使其能够进行微小尺寸和复杂形状的加工操作。</p>
<p>（5）<strong>实验室研究</strong>：串联机器人在科学研究和实验室应用中具有广泛的应用。例如，在化学实验、材料测试和生物医学研究中，串联机器人可以进行精确的液体分注、样品处理和实验操作。</p>
<p>（6）<strong>危险环境</strong>：串联机器人可以在危险环境中代替人工进行操作，如核能厂、爆炸物处理和深海勘探等。它们能够承担高温、高压、有毒或放射性环境下的任务，保护人类的安全。</p>
<p>（7）<strong>娱乐和艺术</strong>：串联机器人还在娱乐和艺术领域展现出其创造力和表演能力。例如，在舞台表演、电影特效和艺术创作中，串联机器人可以呈现出流畅的舞蹈动作、惊人的表演和艺术装置。</p>
<h3 id="2-机械臂技术研发需求"><a href="#2-机械臂技术研发需求" class="headerlink" title="2.机械臂技术研发需求"></a>2.机械臂技术研发需求</h3><p>随着中国工业机器人市场需求的不断增加，开发完全自主的工业机器人控制系统具有不可替代的意义。目前衡量工业机器人性能的重要标准是运行高速以及加工高精度，而这些也是市场非常看重的。其中工业机器人的运动精度和平稳性的基础和保障是平滑的位姿运动，同时速度规划算法的选择决定了机器人运动精度和平滑性，因此<strong>研究机器人的前瞻算法和轨迹规划控制算法</strong>对于提高机器人的控制精度和运行效率具有重要意义。</p>
<p>（1）<strong>机器人轨迹光顺技术</strong></p>
<p>轨迹光顺是机器人轨迹规划中一个不可或缺的部分，通过各种曲线对运行路径进行近似，在满足轨迹弓高误差的情况下，生成新的运动轨迹，消除曲率和切向的不连续性，满足轨迹连续性要求，目前在三轴和五轴机床上应用非常广泛。</p>
<p>（2）<strong>机器人奇异位形规避技术</strong></p>
<p>奇异位形是指机构在运动过程中机构的运动学、动力学性能发生瞬间突变，机构处于死点或者自由度减少，使得机构运动能力失常。串联机器人的运动奇异性由其串联机构所决定的，无法消除，产生的不良影响主要表现在两个方面：①自由度减少；②某些关节角速度趋向无穷大，引起机器人失控。</p>
<p>（3）<strong>机器人同步前瞻技术</strong></p>
<p>速度前瞻是数控加工技术中的重要一环，基本思想是通过预读一段待运行路径，判断该路径上的高曲率约束点和危险点，提前进行速度规划，保证机床末端运行至危险点之前能够降速至合适速度，平稳过渡危险点后在加速至正常速度。</p>
<p>（4）<strong>机器人速度规划和插补技术</strong></p>
<p>速度规划和插补是机器人运动控制中不可缺少的一部分，已知当前段始末点速度和位移，通过速度规划计算出当前段的运动时间，然后插补出每一循环周期的位移。常见的速度规划算法有直线加减速，也被称为梯形加减速，Ｓ曲线加减速，修正梯形加减速，指数型加减速，三角函数加减速等。</p>
<h2 id="二、串联机械臂机构分析"><a href="#二、串联机械臂机构分析" class="headerlink" title="二、串联机械臂机构分析"></a>二、串联机械臂机构分析</h2><h3 id="1-机械臂结构分析"><a href="#1-机械臂结构分析" class="headerlink" title="1.机械臂结构分析"></a>1.机械臂结构分析</h3><p>通过搭建组装机械臂平台，分析其基本结构与传动方式，并对部件具体尺寸进行测量，可以得到如下的机构简图，并建立对应的工具坐标：</p>
<p><img src="/images/robot/media/image4.jpeg" alt="图2：机械臂机构简图"><img src="/images/robot/media/image5.png" alt="图2：机械臂机构简图">其中，经过多次测量取平均值，测得如下物理结构参数（图中已标注)：</p>
<p>表1：机械臂物理参数</p>
<table>
<thead>
<tr>
<th></th>
<th>数值（mm）</th>
</tr>
</thead>
<tbody><tr>
<td><em>L</em>1</td>
<td>152</td>
</tr>
<tr>
<td><em>L</em>2</td>
<td>105</td>
</tr>
<tr>
<td><em>L</em>3</td>
<td>98</td>
</tr>
<tr>
<td><em>L</em>4</td>
<td>182</td>
</tr>
</tbody></table>
<h3 id="2-机械臂正运动学模型"><a href="#2-机械臂正运动学模型" class="headerlink" title="2.机械臂正运动学模型"></a>2.机械臂正运动学模型</h3><p>基于上述坐标系，进一步分析其传动关系与结构，得出如下D-H参数表：</p>
<p>表2：D-H参数表</p>
<table>
<thead>
<tr>
<th>参数\关节</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
</tr>
</thead>
<tbody><tr>
<td><em>a</em>_i</td>
<td>0</td>
<td>0</td>
<td><em>L</em>2</td>
<td><em>L</em>3</td>
<td>0</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td><em>d</em>_i</td>
<td></td>
<td><em>L</em>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td><em>L</em>4</td>
</tr>
<tr>
<td><em>α</em>_i</td>
<td>0</td>
<td>-90°</td>
<td>0</td>
<td>0</td>
<td>-90°</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td><em>θ</em>_i</td>
<td></td>
<td><em>θ</em>1</td>
<td><em>θ</em>2</td>
<td><em>θ</em>3</td>
<td><em>θ</em>4-90°</td>
<td><em>θ</em>5</td>
<td>0</td>
</tr>
</tbody></table>
<p>通过如下变化通式，可以在各连杆的关节坐标系之间进行变换：</p>
<p><img src="/images/robot/media/image6.png"></p>
<p>代入D-H表中对应的参数值即可计算得出对应的位姿矩阵，表中的θ_i（i=1,2,3,4,5）即表示舵机转角（最后一个舵机仅控制夹子夹紧，不影响总体位姿，默认为夹紧状态），在机械臂自身物理参数已经确定的情况下，一旦给定各舵机转角，机械臂末端在全局坐标系中的坐标也可立即得到。在本项目的六轴机械臂模型中，共可建立六个坐标系，得到六个相邻坐标系之间的位姿矩阵T；将六个位姿矩阵按顺序依次右乘，即可得到机械臂末端相对于0坐标系（即全局坐标系）的位姿矩阵:</p>
<p><img src="/images/robot/media/image10.png"></p>
<p>该矩阵中前三行的最后一个元素分别代表了机械臂末端在全局坐标系中的x,y和z坐标。依据这样的原理，通过Matlab编程，可以实现正运动学的计算（附件1），例如设定五个舵机转角分别为0°、-45°、45°、45°、0°，可以计算得出如下的位姿矩阵：<br><img src="/images/robot/media/image11.png" alt="图3：舵机角度[0,-45,45,45,0]对应的位姿矩阵">进一步可以绘制出此时各机械臂关节的位姿图，与实际控制结果进行比照：</p>
<p><img src="/images/robot/media/image12.jpeg" alt="图4：舵机角度[0,-45,45,45,0]对应的机械臂位姿"><img src="/images/robot/media/image13.png" alt="图4：舵机角度[0,-45,45,45,0]对应的机械臂位姿"></p>
<h3 id="3-机械臂逆运动学求解"><a href="#3-机械臂逆运动学求解" class="headerlink" title="3.机械臂逆运动学求解"></a>3.机械臂逆运动学求解</h3><p><img src="/images/robot/media/image14.jpeg" alt="图5：机械臂连杆简图"><img src="/images/robot/media/image15.jpeg" alt="图5：机械臂连杆简图"></p>
<p>通过观察与分析机械臂结构可以发现，由于<em>θ</em>5只影响末端夹子的转动，<em>θ</em>6只影响末端夹子夹紧的程度，即在固定<em>θ</em>5=0°、<em>θ</em>6=90°（夹子夹紧）时，机械臂的位姿与末端坐标只受<em>θ</em>1<em>、θ</em>2<em>、θ</em>3<em>、θ</em>4的控制，故只需求解该四者即可。</p>
<h4 id="（1）求解θ1"><a href="#（1）求解θ1" class="headerlink" title="（1）求解θ1"></a>（1）求解<em>θ</em>1</h4><p>观察连杆简图（上左图），可以发现: <em>θ</em>1为机械臂在x-y平面中的投影与x轴的夹角，即只与机械臂末端的x与y坐标有关：<em>θ</em>1=arctan(<em>y</em>P*/x*P)。</p>
<h4 id="（2）求解θ2、θ3、θ4"><a href="#（2）求解θ2、θ3、θ4" class="headerlink" title="（2）求解θ2、θ3、θ4"></a>（2）求解<em>θ</em>2<em>、θ</em>3<em>、θ</em>4</h4><p>进一步观察机械臂所在平面（上右图）：将原坐标系中的z轴作为纵坐标（y’ = z），将原x轴与y轴映射到机械臂所在平面内作为横坐标（x’ = sqrt(x^2+y^2))；利用几何法，建立方程组对<em>θ</em>2<em>、θ</em>3<em>、θ</em>4分别进行求解。</p>
<p>在求解公式推导的过程中，默认末端机械臂与水平面的夹角α已知，在给定机械臂末端坐标（x,y,z）的情况下，可解得如下结果（必须求出解析解，若将方程组输入Matlab调用求解器求解，可能会出现计算无解但实际有解的情况）：</p>
<p><img src="/images/robot/media/image18.png"></p>
<p>其中：</p>
<p><img src="/images/robot/media/image19.png"></p>
<p>事实上，这样求解得到的结果往往不唯一，为使得机械臂在各位姿转换的过程中更加直接迅速且满足机械结构约束，还需满足如下约束条件：</p>
<p>【1】求解位置不能低于底座：<img src="/images/robot/media/image20.png"></p>
<p>【2】三角形ABC存在的几何约束</p>
<p>【3】三角形ACC’存在的几何约束</p>
<p>【4】运动连续性约束：<img src="/images/robot/media/image21.png"></p>
<p>【5】角度范围约束：<img src="/images/robot/media/image22.png"></p>
<p>实际编写Matlab程序进行求解时，末端机械臂与水平面的夹角α在不同位姿下会发生改变，因此需要在编程时对其在一定范围（-45°到90°之间）内进行遍历，当有合适的满足约束条件的解时输出对应的解并停止循环。</p>
<p>在Matlab程序（附件2）中，将目标机械臂末端坐标[x,y,z]设置为以IN_theta=[0,-45,45,45,0]作为输入的正解结果[300.9396, 0, 97.5528]，得到的逆解结果与IN_theta完全一致，正确性得到验证。</p>
<p><img src="/images/robot/media/image23.png"></p>
<h2 id="三、串联机械臂控制技术分析"><a href="#三、串联机械臂控制技术分析" class="headerlink" title="三、串联机械臂控制技术分析"></a>三、串联机械臂控制技术分析</h2><h3 id="1-电机特性分析"><a href="#1-电机特性分析" class="headerlink" title="1.电机特性分析"></a>1.电机特性分析</h3><p>从本质上来说，电机属于一种能量转换装置，其目的是希望将电能转换为动能（机械能），但在实际的工作过程中这样的转换效率永远不会是100%，而是由于电机线圈的欧姆加热，会有相当部分的能量以热量形式散失；但总而言之，其工作过程本身仍然满足能量守恒定律，即其将输入的电能P_elec转换为输出的机械能P_mech与散失的热能P_heat：</p>
<p><img src="/images/robot/media/image27.png"></p>
<p><img src="/images/robot/media/image28.png" alt="图6：电机理论模型"></p>
<p>图6：电机理论模型</p>
<p>将其改写成电气和机械量：</p>
<p><img src="/images/robot/media/image29.png"></p>
<p>其中v_m为电机端子两端的电压，i是流过电机的电流，τ是电机产生的扭矩，ω是其角速度。</p>
<p>事实上，除此之外，电机内的线圈除具有电阻R之外，还具有电感L。加入电感项后，再将两边同时对电流i求导，可以得到电机的定义方程：</p>
<p><img src="/images/robot/media/image34.png"></p>
<p>其中v_emf为反电动势，与电机转速n成正比，即（其中常数k_v取决于电机设计）:</p>
<p><img src="/images/robot/media/image36.png">电机产生的转矩与通过线圈的电流成正比，即：</p>
<p><img src="/images/robot/media/image38.png">但实际的输出扭矩还需要在此基础上减去负载扭矩与电机轴摩擦扭矩（与电机轴转速成正比，比例系数为电机自身特性)。</p>
<p>基于上述这些公式即可对于一个电机的特性与性能进行相对完整描述，通过对于上述公式进行变形和转换还可以得到电机的速度-扭矩曲线，从而得到失速扭矩与空载速度，为我们更好地把握电机的大致性能提供参考。</p>
<p><img src="/images/robot/media/image39.png" alt="图7：电机的速度-扭矩曲线"></p>
<p>为了后续更精准地对电机进行控制（如调节PID参数等），可以在Simulink中对电机的基本物理特性进行仿真建模：</p>
<p><img src="/images/robot/media/image40.png" alt="图8：电机的Simulink仿真模型"></p>
<p>该模型的输入值为电机电压和负载扭矩，输出值为电机转角、电流与转速，能够很好地描述一个电机的物理特性，可以将其封装成单独的电机模块，并利用PID等控制模块实现对于该电机模块的控制。</p>
<p>不同的电机由于其结构、材料等的不同，性能也会有所差异，具体体现在不同的结构和材料对于上述公式中所涉及到的比例系数都有不同程度的影响，因而能够影响电机的速度-扭矩特性曲线。在对电机进行选型时，厂家往往不会直接给出这些系数，而是给出空载速度等参数以供参考，因此更需要清楚了解这些特性参数所代表的物理意义，从而更好地针对需求进行合适的选型。</p>
<h3 id="2-电机控制策略与PID特性分析"><a href="#2-电机控制策略与PID特性分析" class="headerlink" title="2.电机控制策略与PID特性分析"></a>2.电机控制策略与PID特性分析</h3><p>PID控制器是工业过程控制中广泛采用的一种控制算法，其特点是结构简单灵活、技术成熟、适应性强。在有一定精度和灵敏度要求的电机控制过程中，往往也偏向于采用PID控制器实现电机控制。</p>
<p>P、I、D分别为比例（Proportion）、积分（Integral）、微分（Differential)的简写；将偏差的比例、积分和微分通过线性组合构成控制量，用该控制量对受控对象进行控制，称为PID算法，本质上是对于偏差的控制算法。PID通过对输入的偏差进行比例积分微分运算，将其叠加结果用于控制执行机构。在工程实践中，一般P是必须的，衍生出有PI、PD、PID等多种PID控制器。</p>
<p><img src="/images/robot/media/image41.png" alt="图9：PID控制器工作原理示意图"></p>
<p>连续状态下，PID控制器的计算公式如下：</p>
<p><img src="/images/robot/media/image42.png"></p>
<p>（1）比例部分</p>
<p>作用是对系统瞬间产生的偏差进行快速修正，只有P时会有静差。偏差一旦产生，控制器立即产生控制作用，使控制量向减少偏差的方向变化。比例系数K_p越大，控制作用越强，则过渡过程越快，控制过程的静态偏差也就越小；但是越大，也越容易产生震荡，破坏系统的稳定性。因此，比例系数必须选择恰当，才能达到过渡时间少，静差小且稳定的效果。</p>
<p>（2）积分部分</p>
<p>作用是消除系统偏差，补偿系统的静态误差，只要存在偏差，则其控制作用就不断增加；只有在无偏差时，其积分值才为常数，控制作用才是一个不会增加的常数。积分环节的调节作用虽然会消除静态误差，但也会降低系统的响应速度，增加系统的超调量。积分常数越大，积分的积累作用越弱，这时系统在过渡时才不会产生震荡；但增大积分常数会减慢静态误差的消除过程，消除偏差所需的时间较长，但可以减少超调量，提高系统的稳定性。</p>
<p>（3）微分部分</p>
<p>作用是加快调节过程，阻止偏差的变化。偏差变化的越快，微分控制器的输出就越大，并能在偏差值变大之前进行修正。微分作用的引入，将有助于减少超调量，克服震荡，使系统趋于稳定，特别对高阶系统非常有利，它加快了系统的跟踪速度。但微分的作用对输入信号的噪声很敏感，对那些噪声较大的系统一般不用微分，或在微分起作用之前先对输入信号进行滤波。</p>
<p>总体而言，在PID控制器参数选择的过程中，一般遵循如下步骤顺序：</p>
<p>【1】确定比例系数Kp </p>
<p>【2】确定积分时间常数Ti</p>
<p>【3】确定微分时间常数Td </p>
<p>【4】系统空载、带载联调</p>
<h3 id="3-嵌入式控制系统总结分析"><a href="#3-嵌入式控制系统总结分析" class="headerlink" title="3.嵌入式控制系统总结分析"></a>3.嵌入式控制系统总结分析</h3><p>嵌入式系统是以应用为中心，以现代计算机技术为基础，能够根据用户需求(功能、可靠性、成本、体积、功耗、环境等)灵活裁剪软硬件模块的专用计算机系统。嵌入式系统的硬件和软件必须根据具体的应用任务，以功耗、成本、体积、可靠性、处理能力等为指标来进行选择。嵌入式系统的核心是系统软件和应用软件，由于存储空间有限，因而要求软件代码紧凑、可靠，且对实时性有严格要求。目前常见的嵌入式控制开发板有C51，STM32，Arduino，树莓派等。</p>
<p>本项目中使用的嵌入式控制系统基于Arduino Uno开发板搭建。作为一款便捷灵活、方便上手的开源硬件产品，其具有丰富的接口，有数字I/O口，模拟I/O口，同时支持SPI,IIC,UART串口通信，能通过各种各样的传感器来感知环境，通过控制灯光、马达和其他装置来反馈、影响环境。它没有复杂的单片机底层代码，没有难懂的汇编，只是简单而实用的函数。而且具有简便的编程环境IDE，极大的自由度，可拓展性能非常高，同时其标准化的接口模式也为它的可持续发展奠定了坚实的基础，但其低廉的价格也意味着性能并不尽如人意。</p>
<p><img src="/images/robot/media/image43.png" alt="图10：本项目中使用的Arduino Uno控制板"></p>
<h3 id="4-传感系统总结分析"><a href="#4-传感系统总结分析" class="headerlink" title="4.传感系统总结分析"></a>4.传感系统总结分析</h3><p>传感器是能感受到被测量的信息，并能将感受到的信息，按一定规律变换成为数字/模拟信号或其他所需形式的信息输出，以满足信息的传输、处理、存储、显示、记录和控制等要求的检测装置。传感器具有微型化、数字化、智能化、多功能化、系统化、网络化等特点，它是实现自动检测和自动控制的首要环节。</p>
<p>传感器一般由敏感元件、转换元件、变换电路和辅助电源四部分组成：敏感元件直接感受被测量，并输出与被测量有确定关系的物理量信号；转换元件将敏感元件输出的物理量信号转换为电信号；变换电路负责对转换元件输出的电信号进行放大调制；转换元件和变换电路一般还需要辅助电源供电。</p>
<p>按照其测量的物理量，传感器可大致分为如下种类：</p>
<p>【1】力学量传感器：包括压力传感器、力传感器、位移传感器、加速度传感器、速度传感器、转速传感器等，用于测量力、压力、运动等力学参数。</p>
<p>【2】热学量传感器：热敏电阻/热电偶/红外温度传感器等，用于测量温度。</p>
<p>【3】光学量传感器：如光电二极管、CCD/CMOS图像传感器等，用于检测光强度、颜色、图像信息。</p>
<p>【4】声学量传感器：麦克风，用于声音、噪声的检测。</p>
<p>【5】磁学量传感器：如霍尔效应传感器、磁敏电阻，用于测量磁场强度、磁通量。</p>
<p>【6】化学量传感器：如电化学传感器、气体传感器，用于检测特定气体浓度、pH值、离子浓度等。</p>
<p>本项目中用到的传感器主要有三类：</p>
<p>（1）红外光学传感器：不断发出红外线并通过检测返回的红外线强弱返回不同的电信号，可用于区分亮处/暗处，通过与对应的控制算法相配合可以使小车实现沿黑线完成循迹任务；</p>
<p>（2）超声波测距传感器：不断向前方发出超声波并接收反射回的超声波，通过检测发送与接收同一超声波信号的时间间隔，计算得出前方物体与自身的距离，进行距离的判断，可配合相应控制算法实现对应功能；</p>
<p>（3）视觉传感器：采用Openmv视觉摄像头模块，对摄像头采集的图像进行实时的处理，需要配合编写对应的识别算法并烧录进去，并将识别结果以数字信号的形式反馈到指定的引脚上，与主控制板实现通信，从而根据不同的识别结果执行对应命令。</p>
<h2 id="四、综合实践环节报告"><a href="#四、综合实践环节报告" class="headerlink" title="四、综合实践环节报告"></a>四、综合实践环节报告</h2><h3 id="1-任务目标与任务分解"><a href="#1-任务目标与任务分解" class="headerlink" title="1. 任务目标与任务分解"></a>1. 任务目标与任务分解</h3><p>任务目标：</p>
<p><img src="/images/robot/media/image44.jpeg" alt="图11：项目任务描述"></p>
<p>任务分解：</p>
<p>总体而言，可以将整个项目分解成如下模块：</p>
<p>（1）利用红外传感器模块，实现对于黑线道路的循迹；</p>
<p>（2）利用超声波测距模块与视觉模块，在对应的任务点停下，并根据视觉识别结果执行对应的任务；</p>
<p>（3）在A点处，根据识别到的物块颜色判断应进行左转还是右转；在B点出，根据识别到的物块大小，控制机械臂沿不同的指定轨迹完成运动（写字）。</p>
<p>简而言之，任务主要分为循迹、视觉识别与机械臂控制运动三个模块。</p>
<h3 id="2-本人负责部分的实现过程"><a href="#2-本人负责部分的实现过程" class="headerlink" title="2. 本人负责部分的实现过程"></a>2. 本人负责部分的实现过程</h3><h4 id="（1）任务描述"><a href="#（1）任务描述" class="headerlink" title="（1）任务描述"></a>（1）任务描述</h4><p>我主要负责的任务板块是最终B点处的写字任务，即需要在接收到Openmv模块识别反馈的物块大/小对应的电平信号后，执行对应的机械臂运动，最终达成在墙上写数字”1”或”2”的效果；由于该实现过程中大量涉及到对于Arduino编写C++程序并烧录以实现舵机控制的内容，同时还需要与Openmv视觉模块进行交互，因此我也一并负责了整个测试小车行进业务逻辑的编写与整合工作，将各个模块整合在一起。</p>
<h4 id="（2）技术路径与策略"><a href="#（2）技术路径与策略" class="headerlink" title="（2）技术路径与策略"></a>（2）技术路径与策略</h4><p>在之前的机械臂控制（正/逆解）过程中，由于不涉及到写字任务这一具体情境，只是对于实验平台基本的物理参数进行了测量；但在写字任务中，机械臂末端的夹子需要夹取白板笔，用白板笔的尖端在墙壁上完成写字任务，因此需要对于机械臂的L4参数进行重新测量，端点由夹子末端更改至白板笔的末端，测得新的L4为250mm。</p>
<p>针对写”1”和”2”两个不同的字符，有不同的定位方式：如写”1”只需定位上端点，中间点与下端点即可，而写”2”则根据字形需要定位6个点才能完成任务（为简化控制流程，将各控制点之间的距离设置的较小从而不需要在控制点之间再进行直线插补，目标是仅需要完成字形而并不追求大小）。附件3中的综合控制代码中给出了这些控制点的坐标，在此不详细赘述。事实上，这些点坐标的确定还与小车在停下识别时与墙壁间的距离（即超声测距决定停下识别时的临界距离）有关，实际在反复多次的测试中磨合得出。</p>
<p>为使得机械臂控制流程更加流畅和自然，在基于Matlab实现机械臂正逆解算的代码后，将该算法移植至C++中，并以类的形式封装（名为Arm）,一个Arm对象即对应一个位姿，其构造时需要输入机械臂的结构参数（L1,L2,L3,L4）与希望机械臂末端到达的点坐标，当再次调用其setup()方法时，会自动根据该目标坐标进行逆解算，并控制舵机按照解算出的角度转动，实现控制效果。在舵机控制时，综合了测量出的转动误差，对于各舵机的转动角度都有对应的不同的比例系数实现误差补偿。</p>
<h4 id="（3）核心程序逻辑"><a href="#（3）核心程序逻辑" class="headerlink" title="（3）核心程序逻辑"></a>（3）核心程序逻辑</h4><p>最终完整项目的代码详见附件3，在此仅简要阐述其逻辑。</p>
<p>小车的默认状态为以循迹方式前进，即执行follow()函数；在行进过程中，始终构造一个Arm对象（在armset()函数中），控制机械臂保持一个相对合适的姿态（坐标280，0，320）；当超声波测距返回值小于19时，说明到达了A点，需要进行第一次识别，此时会反馈给Openmv一个高电平，告诉视觉模块需要开始识别颜色；视觉模块在识别完成后通过另一个引脚将识别结果以高/低电平形式反馈给主控Arduino开发板，主板在接收到对应信号后会对应做出向左/向右转的行动（执行turningleft()或turningright()）函数，并在随后的过程中继续完成循迹；在T字路口处，由于我们组并未采取视觉辅助循迹的解决方案，因此只能采取”背板”的方式，在A点处转弯后开始计时，当继续循迹达到30s左右时，根据前面判断执行的左转/右转指令对应再次执行左转/右转；但实际操作过程中”背板”往往无法在路口精准转弯，因此又补充了新的逻辑，在时间差不多的时候提前大角度拐弯并一直沿直线行驶，直到再次回到黑线上就继续循迹，这样就可以绕过T字路口；理想状态下，通过T字路口后再行驶短暂的一段距离后，应该就到达了需要写字的B点，此时与A点处处理类似，当超声测距返回值小于17时停下，通过Openmv模块识别红色物块的大小，并执行对应的机械臂运动操作（写”1”或”2”）。</p>
<h4 id="（4）实现的实际效果"><a href="#（4）实现的实际效果" class="headerlink" title="（4）实现的实际效果"></a>（4）实现的实际效果</h4><p>上述操作逻辑仅仅在理论上可行，而实际测试时，由于没有采用视觉循迹方案，在T字路口屡败屡战，屡战屡败，最终在多次尝试后仍然没有进入T字弯后的B点写字区域；在第二次尝试过程中，由于个人的失误，在补充了绕过T字弯的逻辑之后忘记补充循迹逻辑，导致在到达A点后失去循迹功能，最终宣告失败。但总体而言，除了T字弯之外，其他所有功能的实现都非常良好，不论是前段的循迹，把速度稍微压下来一点但是比较稳不会跑出去，还是A点的颜色判断也非常准确而迅速。在私下练习测试时，物块大小识别与写字功能也非常流畅，正确率极高，只是可惜最后没有办法展示出来了。</p>
<p><img src="/images/robot/media/image45.jpeg" alt="图12：写数字&quot;2&quot;成功效果图"></p>
<h2 id="4-心得体会"><a href="#4-心得体会" class="headerlink" title="4. 心得体会"></a>4. 心得体会</h2><p>其实整个课程与项目过程中的心路历程和工作内容在上面已经基本讲完了，因为我没有打过机器人相关的竞赛，相比于其他同学而言少了很多这方面的经验，不论是这次课程中涉及到的机械臂正逆解算与控制也好，还是视觉模块的引入也好，甚至是超声波测距模块其实对我来说都是初次接触，都是一个迅速的从陌生到熟悉的过程，这个成长过程很突然但也很迅速，效果是拔群的。在后半学期的实践阶段，我一直在努力去主导我们整个组进度的推进，之前课上一些小的checkpoint也都顺利通过了；最终测试中也基本是我在主导整个组进度的推进，以及各模块任务的分配与整体业务逻辑的串联，而且由于我一直在跟随堂测试的机械臂控制部分同时也想充分利用我Matlab代码编写与数据处理计算的优势，我在最终测试中还主要负责了机械臂的控制部分（写字），巧妙利用C++面向对象的编程思想，大大简化了控制流程。但可惜由于我们组经验和技术水平比较有限，没有及时认识到视觉循迹的必要性，导致最终在T字路口功亏一篑，甚至使得最早调完的写字部分前功尽弃，最后一次测试本来调整了逻辑企图通过”歪门邪道”绕过T字弯（纯背板真的太难卡准了），但是由于个人失误导致在A点就提前结束了战斗，也是留下了一些遗憾吧。但总体来说，整个过程给我带来的成长和提升是显而易见的，我开始对于机器人、对于硬件慢慢地从心理上去接受这个事情并且甚至一度乐在其中，也学到了机械臂控制、电机控制等方面的一些知识，课上第一个把电机Simulink模型搭对确实给我增长了很多信心。我们组在编程的过程中除了直接移植部分模块外几乎没有用过Mixly图形化编程，而是直接使用Arduino IDE（虽然这好像也是最后逻辑不清晰留下遗憾的原因之一），这有效地提高了我们的开发效率。这一次从装车开始，到一步步熟悉起小车和开发板的每一个部分，看着程序从一行两行到最后近千行，整体功能不断扩充从一开始只有机械臂位姿控制，到加上循迹，加上与Openmv模块的通信逻辑，以及最后面对T字路口的垂死挣扎，其实在准备过程中也尝试去做视觉辅助循迹，但由于场地各方面条件限制（场地太拥挤，调试的人太多导致环境光源不稳定；摄像头安装位置不合适等），最终还是放弃了视觉循迹方案，选择背板赌一把，很可惜没有成功。</p>
<p>希望在以后的学习实践中，能够充分吸取本次项目的经验，利用好这次学到的理论知识，同时也在做事的过程中汲取这次的经验教训，我相信努力的过程与收获比结果更重要，当然如果能有好的结果也再好不过。感谢这门课一路上三位任课老师与助教学长的辛勤付出，是你们的倾情指导加速了我们成长的速度。</p>
<p>千言万语诉不尽收获与感激。最后，感谢一直努力的自己，以及一直陪伴的老师和朋友。</p>
<h2 id="附件1：Matlab正运动学解算代码"><a href="#附件1：Matlab正运动学解算代码" class="headerlink" title="附件1：Matlab正运动学解算代码"></a>附件1：Matlab正运动学解算代码</h2><figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">clear;clc;</span><br><span class="line"></span><br><span class="line"><span class="comment">%赋予输入值</span></span><br><span class="line">L1=<span class="number">152</span>;</span><br><span class="line">L2=<span class="number">105</span>;</span><br><span class="line">L3=<span class="number">98</span>;</span><br><span class="line">L4=<span class="number">182</span>;</span><br><span class="line">IN_theta=[<span class="number">0</span>,<span class="number">-45</span>,<span class="number">45</span>,<span class="number">45</span>,<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">%建立D-H参数表</span></span><br><span class="line">C_a=[<span class="number">0</span>,<span class="number">0</span>,L2,L3,<span class="number">0</span>,<span class="number">0</span>];</span><br><span class="line">C_d=[<span class="number">0</span>,L1,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,L4];</span><br><span class="line">C_alpha=[<span class="number">0</span>,<span class="number">-90</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-90</span>,<span class="number">0</span>];</span><br><span class="line">C_theta=[<span class="number">0</span>,IN_theta(<span class="number">1</span>),IN_theta(<span class="number">2</span>),IN_theta(<span class="number">3</span>),IN_theta(<span class="number">4</span>)<span class="number">-90</span>,IN_theta(<span class="number">5</span>),<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">i</span>=<span class="number">1</span>;<span class="comment">%i-1=0</span></span><br><span class="line">T0_1=[<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="number">0</span>,C_a(<span class="built_in">i</span>);</span><br><span class="line">    <span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)),-C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>));</span><br><span class="line">    <span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)),C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>));</span><br><span class="line">    <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line"><span class="built_in">i</span>=<span class="number">2</span>;</span><br><span class="line">T1_2=[<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="number">0</span>,C_a(<span class="built_in">i</span>);<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)),-C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>));<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)),C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>));<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line"><span class="built_in">i</span>=<span class="number">3</span>;</span><br><span class="line">T2_3=[<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="number">0</span>,C_a(<span class="built_in">i</span>);<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)),-C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>));<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)),C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>));<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line"><span class="built_in">i</span>=<span class="number">4</span>;</span><br><span class="line">T3_4=[<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="number">0</span>,C_a(<span class="built_in">i</span>);<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)),-C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>));<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)),C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>));<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line"><span class="built_in">i</span>=<span class="number">5</span>;</span><br><span class="line">T4_5=[<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="number">0</span>,C_a(<span class="built_in">i</span>);<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)),-C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>));<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)),C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>));<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line"><span class="built_in">i</span>=<span class="number">6</span>;</span><br><span class="line">T5_6=[<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="number">0</span>,C_a(<span class="built_in">i</span>);<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),-<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)),-C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>));<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">sind</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">sind</span>(C_alpha(<span class="built_in">i</span>)).*<span class="built_in">cosd</span>(C_theta(<span class="built_in">i</span>+<span class="number">1</span>)),<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>)),C_d(<span class="built_in">i</span>+<span class="number">1</span>).*<span class="built_in">cosd</span>(C_alpha(<span class="built_in">i</span>));<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">x0=[<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>];</span><br><span class="line">x1=T0_1(<span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">T0_2=T0_1*T1_2;</span><br><span class="line">x2=T0_2(<span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">T0_3=T0_1*T1_2*T2_3;</span><br><span class="line">x3=T0_3(<span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">T0_4=T0_1*T1_2*T2_3*T3_4;</span><br><span class="line">x4=T0_4(<span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">T0_5=T0_1*T1_2*T2_3*T3_4*T4_5;</span><br><span class="line">x5=T0_5(<span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">T0_6=T0_1*T1_2*T2_3*T3_4*T4_5*T5_6;</span><br><span class="line">x6=T0_6(<span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="comment">% 将点的坐标分别存储在 x, y, z 向量中</span></span><br><span class="line">x = [x0(<span class="number">1</span>), x1(<span class="number">1</span>), x2(<span class="number">1</span>), x3(<span class="number">1</span>), x4(<span class="number">1</span>), x5(<span class="number">1</span>), x6(<span class="number">1</span>)];</span><br><span class="line">y = [x0(<span class="number">2</span>), x1(<span class="number">2</span>), x2(<span class="number">2</span>), x3(<span class="number">2</span>), x4(<span class="number">2</span>), x5(<span class="number">2</span>), x6(<span class="number">2</span>)];</span><br><span class="line">z = [x0(<span class="number">3</span>),x1(<span class="number">3</span>), x2(<span class="number">3</span>), x3(<span class="number">3</span>), x4(<span class="number">3</span>), x5(<span class="number">3</span>), x6(<span class="number">3</span>)];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 绘制三维线</span></span><br><span class="line"><span class="built_in">figure</span>; <span class="comment">% 创建一个新的图窗</span></span><br><span class="line"><span class="built_in">plot3</span>(x, y, z, <span class="string">'-o'</span>); <span class="comment">% 使用 '-o' 绘制带有圆圈标记的线</span></span><br><span class="line">grid on; <span class="comment">% 打开网格</span></span><br><span class="line">xlabel(<span class="string">'X-axis'</span>);</span><br><span class="line">ylabel(<span class="string">'Y-axis'</span>);</span><br><span class="line">zlabel(<span class="string">'Z-axis'</span>);</span><br><span class="line">title(<span class="string">'3D Line Plot Connecting Points'</span>);</span><br><span class="line"></span><br><span class="line">T0_6</span><br></pre></td></tr></tbody></table></figure>

<h2 id="附件2：Matlab逆运动学解算代码"><a href="#附件2：Matlab逆运动学解算代码" class="headerlink" title="附件2：Matlab逆运动学解算代码"></a>附件2：Matlab逆运动学解算代码</h2><figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">clear;clc;</span><br><span class="line"><span class="comment">% 初始化标志变量</span></span><br><span class="line">solution_found = <span class="built_in">false</span>;</span><br><span class="line">x = <span class="number">300.9396</span>;  </span><br><span class="line">y = <span class="number">0</span>;</span><br><span class="line">z = <span class="number">97.5528</span>;</span><br><span class="line">theta1=rad2deg(<span class="built_in">atan</span>(y/x));</span><br><span class="line"><span class="built_in">disp</span>(theta1);</span><br><span class="line">L1 = <span class="number">152</span>;  L2 = <span class="number">105</span>;  L3 = <span class="number">98</span>;   L4 = <span class="number">182</span>;  </span><br><span class="line"><span class="comment">% 遍历 alpha 的值，从 -45 到 90</span></span><br><span class="line"><span class="keyword">for</span> alpha = <span class="number">-45</span>:<span class="number">90</span></span><br><span class="line">    t = <span class="built_in">sqrt</span>(x^<span class="number">2</span> + y^<span class="number">2</span>);</span><br><span class="line">    m=z-L1-L4*<span class="built_in">sind</span>(alpha);</span><br><span class="line">    n=t-L4*<span class="built_in">cosd</span>(alpha);</span><br><span class="line">    theta3=<span class="built_in">acosd</span>((m^<span class="number">2</span>+n^<span class="number">2</span>-L2^<span class="number">2</span>-L3^<span class="number">2</span>)/(<span class="number">2</span>*L2*L3));</span><br><span class="line">    A=L3*<span class="built_in">sind</span>(theta3);</span><br><span class="line">    B=L2+L3*<span class="built_in">cosd</span>(theta3);</span><br><span class="line">    theta2=<span class="built_in">asind</span>(n/<span class="built_in">sqrt</span>(A^<span class="number">2</span>+B^<span class="number">2</span>))-<span class="built_in">acosd</span>(A/<span class="built_in">sqrt</span>(A^<span class="number">2</span>+B^<span class="number">2</span>));</span><br><span class="line">    <span class="keyword">if</span> theta2&lt;<span class="number">0</span></span><br><span class="line">        theta2=<span class="number">180</span>-<span class="built_in">asind</span>(n/<span class="built_in">sqrt</span>(A^<span class="number">2</span>+B^<span class="number">2</span>))-<span class="built_in">acosd</span>(A/<span class="built_in">sqrt</span>(A^<span class="number">2</span>+B^<span class="number">2</span>));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    theta4=theta2-theta3-alpha;</span><br><span class="line">    <span class="comment">% 检查是否找到解</span></span><br><span class="line">    <span class="keyword">if</span> L4*<span class="built_in">sind</span>(alpha)&lt;z &amp;&amp; L3*<span class="built_in">cosd</span>(theta2-theta3)&gt;<span class="number">0</span> &amp;&amp; theta2&gt;<span class="number">0</span> &amp;&amp; theta2&lt;<span class="number">90</span> &amp;&amp; theta3&gt;<span class="number">0</span> &amp;&amp; theta3&lt;<span class="number">90</span> &amp;&amp; theta4&gt;<span class="number">0</span> &amp;&amp; theta4&lt;<span class="number">90</span> </span><br><span class="line">        <span class="comment">% 记录找到解的标志</span></span><br><span class="line">        solution_found = <span class="built_in">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> solution_found</span><br><span class="line">    <span class="comment">% 显示结果</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">'Solution found:'</span>);</span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">'Alpha: '</span>, num2str(alpha)]);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">'Theta1:'</span>);    <span class="built_in">disp</span>(theta1);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">'Theta2:'</span>);    <span class="built_in">disp</span>(-theta2);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">'Theta3:'</span>);    <span class="built_in">disp</span>(theta3);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">'Theta4:'</span>);    <span class="built_in">disp</span>(theta4);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">'No solution found in the given alpha range.'</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="附件3：项目测试完整Arduino控制代码"><a href="#附件3：项目测试完整Arduino控制代码" class="headerlink" title="附件3：项目测试完整Arduino控制代码"></a>附件3：项目测试完整Arduino控制代码</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Servo.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">Servo servo_7;</span><br><span class="line">Servo servo_3;</span><br><span class="line">Servo servo_5;</span><br><span class="line">Servo servo_6;</span><br><span class="line">Servo servo_9;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> L1 = <span class="number">152</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> L2 = <span class="number">105</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> L3 = <span class="number">98</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> L4 = <span class="number">250</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">int</span> item;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> flag_cp1=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> flag_cp2=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> currentTime;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> elapsedTime;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> startTime;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> cmd_return_tmp[<span class="number">64</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> color;</span><br><span class="line"><span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Angles</span> </span><br><span class="line">{</span><br><span class="line">    <span class="type">double</span> theta1;</span><br><span class="line">    <span class="type">double</span> theta2;</span><br><span class="line">    <span class="type">double</span> theta3;</span><br><span class="line">    <span class="type">double</span> theta4;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Points</span> </span><br><span class="line">{</span><br><span class="line">    <span class="type">double</span> x1;</span><br><span class="line">    <span class="type">double</span> y1;</span><br><span class="line">    <span class="type">double</span> z1;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Arm</span> </span><br><span class="line">{</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">      <span class="built_in">Arm</span>(<span class="type">double</span> L1, <span class="type">double</span> L2, <span class="type">double</span> L3, <span class="type">double</span> L4, Points terminal) </span><br><span class="line">      {</span><br><span class="line">          <span class="keyword">this</span>-&gt;L1 = L1;</span><br><span class="line">          <span class="keyword">this</span>-&gt;L2 = L2;</span><br><span class="line">          <span class="keyword">this</span>-&gt;L3 = L3;</span><br><span class="line">          <span class="keyword">this</span>-&gt;L4 = L4;</span><br><span class="line">          <span class="keyword">this</span>-&gt;x0 = terminal.x1;</span><br><span class="line">          <span class="keyword">this</span>-&gt;y0 = terminal.y1;</span><br><span class="line">          <span class="keyword">this</span>-&gt;z0 = terminal.z1;</span><br><span class="line">          Angles angles=<span class="built_in">inverseKinematics</span>(<span class="keyword">this</span>-&gt;x0,<span class="keyword">this</span>-&gt;y0,<span class="keyword">this</span>-&gt;z0);</span><br><span class="line">          <span class="keyword">this</span>-&gt;theta1=angles.theta1;</span><br><span class="line">          <span class="keyword">this</span>-&gt;theta2=angles.theta2;</span><br><span class="line">          <span class="keyword">this</span>-&gt;theta3=angles.theta3;</span><br><span class="line">          <span class="keyword">this</span>-&gt;theta4=angles.theta4;</span><br><span class="line">          Points point=forwardKinematics(<span class="keyword">this</span>-&gt;theta1,<span class="keyword">this</span>-&gt;theta2,<span class="keyword">this</span>-&gt;theta3,<span class="keyword">this</span>-&gt;theta4);</span><br><span class="line">          <span class="keyword">this</span>-&gt;x1=point.x1;</span><br><span class="line">          <span class="keyword">this</span>-&gt;y1=point.y1;</span><br><span class="line">          <span class="keyword">this</span>-&gt;z1=point.z1;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">      </span>{</span><br><span class="line">          <span class="type">double</span> oc1=(<span class="number">140.25</span>+<span class="number">1.12</span>*<span class="keyword">this</span>-&gt;theta1)*<span class="number">2</span>/<span class="number">3</span>;</span><br><span class="line">          <span class="type">double</span> oc2=(<span class="number">180</span>+<span class="number">1.13</span>*<span class="keyword">this</span>-&gt;theta2)*<span class="number">2</span>/<span class="number">3</span>;</span><br><span class="line">          <span class="type">double</span> oc3=(<span class="number">142.5</span>+<span class="number">1.07</span>*<span class="keyword">this</span>-&gt;theta3)*<span class="number">2</span>/<span class="number">3</span>;</span><br><span class="line">          <span class="type">double</span> oc4=(<span class="number">132</span>+<span class="number">1.12</span>*<span class="keyword">this</span>-&gt;theta4)*<span class="number">2</span>/<span class="number">3</span>;</span><br><span class="line">          servo_7.<span class="built_in">write</span>(oc1);</span><br><span class="line">          servo_3.<span class="built_in">write</span>(oc2);</span><br><span class="line">          servo_5.<span class="built_in">write</span>(oc3);</span><br><span class="line">          servo_6.<span class="built_in">write</span>(oc4);</span><br><span class="line">          servo_9.<span class="built_in">write</span>(<span class="number">96</span>);</span><br><span class="line">          <span class="comment">//servo_8.write(270);</span></span><br><span class="line">          Serial.<span class="built_in">print</span>(<span class="string">"x1: "</span>); Serial.<span class="built_in">println</span>(<span class="keyword">this</span>-&gt;x1);</span><br><span class="line">          Serial.<span class="built_in">print</span>(<span class="string">"y1: "</span>); Serial.<span class="built_in">println</span>(<span class="keyword">this</span>-&gt;y1);</span><br><span class="line">          Serial.<span class="built_in">print</span>(<span class="string">"z1: "</span>); Serial.<span class="built_in">println</span>(<span class="keyword">this</span>-&gt;z1);</span><br><span class="line">          Serial.<span class="built_in">print</span>(<span class="string">"terminalx1: "</span>); Serial.<span class="built_in">println</span>(<span class="keyword">this</span>-&gt;x0);</span><br><span class="line">          Serial.<span class="built_in">print</span>(<span class="string">"terminaly1: "</span>); Serial.<span class="built_in">println</span>(<span class="keyword">this</span>-&gt;y0);</span><br><span class="line">          Serial.<span class="built_in">print</span>(<span class="string">"terminalz1: "</span>); Serial.<span class="built_in">println</span>(<span class="keyword">this</span>-&gt;z0);</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">      <span class="type">double</span> L1;</span><br><span class="line">      <span class="type">double</span> L2;</span><br><span class="line">      <span class="type">double</span> L3;</span><br><span class="line">      <span class="type">double</span> L4;</span><br><span class="line">      <span class="type">double</span> x0;</span><br><span class="line">      <span class="type">double</span> y0;</span><br><span class="line">      <span class="type">double</span> z0;</span><br><span class="line">      <span class="type">double</span> theta1;</span><br><span class="line">      <span class="type">double</span> theta2;</span><br><span class="line">      <span class="type">double</span> theta3;</span><br><span class="line">      <span class="type">double</span> theta4;</span><br><span class="line">      <span class="type">double</span> x1;</span><br><span class="line">      <span class="type">double</span> y1;</span><br><span class="line">      <span class="type">double</span> z1;</span><br><span class="line">      <span class="type">bool</span> solution_found = <span class="literal">false</span>;</span><br><span class="line">      <span class="function">Angles <span class="title">inverseKinematics</span><span class="params">(<span class="type">double</span> x0, <span class="type">double</span> y0, <span class="type">double</span> z0)</span> </span></span><br><span class="line"><span class="function">      </span>{</span><br><span class="line">          Angles angles;</span><br><span class="line">          <span class="type">double</span> theta1 = <span class="built_in">atan2</span>(y0,x0) * <span class="number">180.0</span> / PI;</span><br><span class="line">          angles.theta1=theta1;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> alpha = <span class="number">-45</span>; alpha &lt;= <span class="number">90</span>; alpha++) </span><br><span class="line">          {</span><br><span class="line">              <span class="type">double</span> t0 = <span class="built_in">sqrt</span>(x0 * x0 + y0 * y0);</span><br><span class="line">              <span class="type">double</span> m = z0 - <span class="keyword">this</span>-&gt;L1 - <span class="keyword">this</span>-&gt;L4 * <span class="built_in">sin</span>(alpha * PI / <span class="number">180.0</span>);</span><br><span class="line">              <span class="type">double</span> n = t0 - <span class="keyword">this</span>-&gt;L4 * <span class="built_in">cos</span>(alpha * PI / <span class="number">180.0</span>);</span><br><span class="line"></span><br><span class="line">              <span class="type">double</span> cos_theta3 = (m * m + n * n - <span class="keyword">this</span>-&gt;L2 * <span class="keyword">this</span>-&gt;L2 - <span class="keyword">this</span>-&gt;L3 * <span class="keyword">this</span>-&gt;L3) / (<span class="number">2</span> * <span class="keyword">this</span>-&gt;L2 * <span class="keyword">this</span>-&gt;L3);</span><br><span class="line">              <span class="keyword">if</span> (cos_theta3 &lt; <span class="number">-1.0</span> || cos_theta3 &gt; <span class="number">1.0</span>) </span><br><span class="line">                  <span class="keyword">continue</span>;</span><br><span class="line">              <span class="type">double</span> theta3 = <span class="built_in">acos</span>(cos_theta3) * <span class="number">180.0</span> / PI;</span><br><span class="line">              <span class="type">double</span> A = L3 * <span class="built_in">sin</span>(theta3 * PI / <span class="number">180.0</span>);</span><br><span class="line">              <span class="type">double</span> B = L2 + L3 * <span class="built_in">cos</span>(theta3 * PI / <span class="number">180.0</span>);</span><br><span class="line">              <span class="type">double</span> sin_theta2_part = n / <span class="built_in">sqrt</span>(A * A + B * B);</span><br><span class="line">              <span class="type">double</span> cos_theta2_part = A / <span class="built_in">sqrt</span>(A * A + B * B);</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (sin_theta2_part &lt; <span class="number">-1.0</span> || sin_theta2_part &gt; <span class="number">1.0</span> || cos_theta2_part &lt; <span class="number">-1.0</span> || cos_theta2_part &gt; <span class="number">1.0</span>) </span><br><span class="line">                  <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">              <span class="type">double</span> theta2 = <span class="built_in">asin</span>(sin_theta2_part) * <span class="number">180.0</span> / PI - <span class="built_in">acos</span>(cos_theta2_part) * <span class="number">180.0</span> / PI;</span><br><span class="line">              <span class="keyword">if</span> (theta2 &lt; <span class="number">0</span>) </span><br><span class="line">                  theta2 = <span class="number">180.0</span> - <span class="built_in">asin</span>(sin_theta2_part) * <span class="number">180.0</span> / PI - <span class="built_in">acos</span>(cos_theta2_part) * <span class="number">180.0</span> / PI;</span><br><span class="line">              <span class="type">double</span> theta4 = theta2 - theta3 - alpha;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;L4 * <span class="built_in">sin</span>(alpha * PI / <span class="number">180.0</span>) &lt; z0 &amp;&amp; <span class="keyword">this</span>-&gt;L3 * <span class="built_in">cos</span>((theta2 - theta3) * PI / <span class="number">180.0</span>) &gt; <span class="number">0</span> &amp;&amp; theta2 &gt;= <span class="number">0</span> &amp;&amp; theta2 &lt;= <span class="number">90</span> &amp;&amp; theta3 &gt;= <span class="number">0</span> &amp;&amp; theta3 &lt;= <span class="number">90</span> &amp;&amp; theta4 &gt;= <span class="number">0</span> &amp;&amp; theta4 &lt;= <span class="number">90</span>) </span><br><span class="line">              {</span><br><span class="line">                  solution_found = <span class="literal">true</span>;</span><br><span class="line">                  angles.theta2=-theta2;</span><br><span class="line">                  angles.theta3=theta3;</span><br><span class="line">                  angles.theta4=theta4;</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">              }</span><br><span class="line">          }</span><br><span class="line">          <span class="keyword">if</span> (solution_found)</span><br><span class="line">            <span class="keyword">return</span> angles;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="function">Points <span class="title">forwardKinematics</span><span class="params">(<span class="type">double</span> theta1, <span class="type">double</span> theta2, <span class="type">double</span> theta3, <span class="type">double</span> theta4)</span> </span></span><br><span class="line"><span class="function">      </span>{</span><br><span class="line">          Points point;</span><br><span class="line">          <span class="type">double</span> IN_theta[] = {theta1, theta2, theta3, theta4, <span class="number">0</span>};</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 定义DH参数</span></span><br><span class="line">          <span class="type">double</span> C_a[] = {<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">this</span>-&gt;L2, <span class="keyword">this</span>-&gt;L3, <span class="number">0</span>, <span class="number">0</span>};</span><br><span class="line">          <span class="type">double</span> C_d[] = {<span class="number">0</span>, <span class="keyword">this</span>-&gt;L1, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">this</span>-&gt;L4};</span><br><span class="line">          <span class="type">double</span> C_alpha[] = {<span class="number">0</span>, <span class="number">-90</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-90</span>, <span class="number">0</span>};</span><br><span class="line">          <span class="type">double</span> C_theta[] = {<span class="number">0</span>, IN_theta[<span class="number">0</span>], IN_theta[<span class="number">1</span>], IN_theta[<span class="number">2</span>], IN_theta[<span class="number">3</span>] - <span class="number">90</span>, IN_theta[<span class="number">4</span>], <span class="number">0</span>};</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 计算变换矩阵</span></span><br><span class="line">          <span class="type">double</span> T0_1[<span class="number">4</span>][<span class="number">4</span>], T1_2[<span class="number">4</span>][<span class="number">4</span>], T2_3[<span class="number">4</span>][<span class="number">4</span>], T3_4[<span class="number">4</span>][<span class="number">4</span>], T4_5[<span class="number">4</span>][<span class="number">4</span>], T5_6[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">          <span class="type">double</span> T0_2[<span class="number">4</span>][<span class="number">4</span>], T0_3[<span class="number">4</span>][<span class="number">4</span>], T0_4[<span class="number">4</span>][<span class="number">4</span>], T0_5[<span class="number">4</span>][<span class="number">4</span>], T0_6[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">          <span class="built_in">dhMatrix</span>(T0_1, C_theta[<span class="number">1</span>], C_d[<span class="number">1</span>], C_a[<span class="number">0</span>], C_alpha[<span class="number">0</span>]);</span><br><span class="line">          <span class="built_in">dhMatrix</span>(T1_2, C_theta[<span class="number">2</span>], C_d[<span class="number">2</span>], C_a[<span class="number">1</span>], C_alpha[<span class="number">1</span>]);</span><br><span class="line">          <span class="built_in">dhMatrix</span>(T2_3, C_theta[<span class="number">3</span>], C_d[<span class="number">3</span>], C_a[<span class="number">2</span>], C_alpha[<span class="number">2</span>]);</span><br><span class="line">          <span class="built_in">dhMatrix</span>(T3_4, C_theta[<span class="number">4</span>], C_d[<span class="number">4</span>], C_a[<span class="number">3</span>], C_alpha[<span class="number">3</span>]);</span><br><span class="line">          <span class="built_in">dhMatrix</span>(T4_5, C_theta[<span class="number">5</span>], C_d[<span class="number">5</span>], C_a[<span class="number">4</span>], C_alpha[<span class="number">4</span>]);</span><br><span class="line">          <span class="built_in">dhMatrix</span>(T5_6, C_theta[<span class="number">6</span>], C_d[<span class="number">6</span>], C_a[<span class="number">5</span>], C_alpha[<span class="number">5</span>]);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Initialize T0_6 as identity matrix</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) </span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) </span><br><span class="line">                  T0_6[i][j] = (i == j) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 计算最终的变换矩阵</span></span><br><span class="line">          <span class="built_in">multiplyMatrix</span>(T0_1, T1_2, T0_2);</span><br><span class="line">          <span class="built_in">multiplyMatrix</span>(T0_2, T2_3, T0_3);</span><br><span class="line">          <span class="built_in">multiplyMatrix</span>(T0_3, T3_4, T0_4);</span><br><span class="line">          <span class="built_in">multiplyMatrix</span>(T0_4, T4_5, T0_5);</span><br><span class="line">          <span class="built_in">multiplyMatrix</span>(T0_5, T5_6, T0_6);</span><br><span class="line"></span><br><span class="line">          point.x1=T0_6[<span class="number">0</span>][<span class="number">3</span>];</span><br><span class="line">          point.y1=T0_6[<span class="number">1</span>][<span class="number">3</span>];</span><br><span class="line">          point.z1=T0_6[<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">return</span> point;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="type">void</span> <span class="title">dhMatrix</span><span class="params">(<span class="type">double</span> T[<span class="number">4</span>][<span class="number">4</span>], <span class="type">double</span> theta, <span class="type">double</span> d, <span class="type">double</span> a, <span class="type">double</span> alpha)</span> </span></span><br><span class="line"><span class="function">      </span>{</span><br><span class="line">          <span class="type">double</span> radTheta = theta * PI / <span class="number">180.0</span>;</span><br><span class="line">          <span class="type">double</span> radAlpha = alpha * PI / <span class="number">180.0</span>;</span><br><span class="line">          T[<span class="number">0</span>][<span class="number">0</span>] = <span class="built_in">cos</span>(radTheta); T[<span class="number">0</span>][<span class="number">1</span>] = -<span class="built_in">sin</span>(radTheta); T[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>; T[<span class="number">0</span>][<span class="number">3</span>] = a;</span><br><span class="line">          T[<span class="number">1</span>][<span class="number">0</span>] = <span class="built_in">cos</span>(radAlpha) * <span class="built_in">sin</span>(radTheta); T[<span class="number">1</span>][<span class="number">1</span>] = <span class="built_in">cos</span>(radTheta) * <span class="built_in">cos</span>(radAlpha); T[<span class="number">1</span>][<span class="number">2</span>] = -<span class="built_in">sin</span>(radAlpha); T[<span class="number">1</span>][<span class="number">3</span>] = -d * <span class="built_in">sin</span>(radAlpha);</span><br><span class="line">          T[<span class="number">2</span>][<span class="number">0</span>] = <span class="built_in">sin</span>(radAlpha) * <span class="built_in">sin</span>(radTheta); T[<span class="number">2</span>][<span class="number">1</span>] = <span class="built_in">sin</span>(radAlpha) * <span class="built_in">cos</span>(radTheta); T[<span class="number">2</span>][<span class="number">2</span>] = <span class="built_in">cos</span>(radAlpha); T[<span class="number">2</span>][<span class="number">3</span>] = d * <span class="built_in">cos</span>(radAlpha);</span><br><span class="line">          T[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>; T[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>; T[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>; T[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="type">void</span> <span class="title">multiplyMatrix</span><span class="params">(<span class="type">double</span> A[<span class="number">4</span>][<span class="number">4</span>], <span class="type">double</span> B[<span class="number">4</span>][<span class="number">4</span>], <span class="type">double</span> C[<span class="number">4</span>][<span class="number">4</span>])</span> </span></span><br><span class="line"><span class="function">      </span>{</span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) </span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) </span><br><span class="line">              {</span><br><span class="line">                  C[i][j] = <span class="number">0</span>;</span><br><span class="line">                  <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">                      C[i][j] += A[i][k] * B[k][j];</span><br><span class="line">              }</span><br><span class="line">      }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">turnL</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+<span class="number">400</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span>+<span class="number">320</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+<span class="number">320</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span>+<span class="number">320</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">turnR</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+(<span class="number">-400</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span>+(<span class="number">-320</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+(<span class="number">-320</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span>+(<span class="number">-320</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">forward</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+<span class="number">360</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span>+(<span class="number">-320</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+<span class="number">360</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span>+(<span class="number">-320</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">40</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">stop</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+<span class="number">0</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span>+<span class="number">0</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+<span class="number">0</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span>+<span class="number">0</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">turningleft</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span><span class="number">-400</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span><span class="number">-600</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span><span class="number">-400</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span><span class="number">-600</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">700</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">turningright</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+(+<span class="number">600</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span>+(+<span class="number">400</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+(+<span class="number">600</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span>+(+<span class="number">400</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">800</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">leftturningleft</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span><span class="number">-000</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span><span class="number">-800</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span><span class="number">-000</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span><span class="number">-800</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">750</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">leftforward</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+<span class="number">360</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span>+(<span class="number">-360</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+<span class="number">360</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span>+(<span class="number">-360</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">40</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rightturningright</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+<span class="number">800</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span><span class="number">-000</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+<span class="number">800</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span><span class="number">-000</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">750</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rightforward</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">6</span>,<span class="number">1500</span>+<span class="number">360</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">7</span>,<span class="number">1500</span>+(<span class="number">-360</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">8</span>,<span class="number">1500</span>+<span class="number">360</span>,<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">sprintf</span>(cmd_return_tmp, <span class="string">"#%03dP%04dT%04d!"</span>,<span class="number">9</span>,<span class="number">1500</span>+(<span class="number">-360</span>),<span class="number">0</span>); <span class="comment">//组合指令</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(cmd_return_tmp); <span class="comment">//解析ZMotor指令-左电机正向</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">40</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">float</span> <span class="title">checkdistance_A1_A2</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">digitalWrite</span>(A1, LOW);</span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(A1, HIGH);</span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(A1, LOW);</span><br><span class="line">  <span class="type">float</span> distance = <span class="built_in">pulseIn</span>(A2, HIGH) / <span class="number">58.00</span>;</span><br><span class="line">  <span class="comment">//delay(10);</span></span><br><span class="line">  <span class="keyword">return</span> distance;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">follow</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A4) == <span class="number">0</span> &amp;&amp; <span class="built_in">digitalRead</span>(A5) == <span class="number">1</span>) </span><br><span class="line">  {</span><br><span class="line">    item = <span class="number">0</span>;</span><br><span class="line">    forward();</span><br><span class="line">  } </span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A4) == <span class="number">1</span> &amp;&amp; <span class="built_in">digitalRead</span>(A5) == <span class="number">0</span>) </span><br><span class="line">  {</span><br><span class="line">    item = <span class="number">1</span>;</span><br><span class="line">    forward();</span><br><span class="line">  } </span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A4) == <span class="number">0</span> &amp;&amp; <span class="built_in">digitalRead</span>(A5) == <span class="number">0</span>) </span><br><span class="line">    forward();</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (item == <span class="number">0</span> &amp;&amp; (<span class="built_in">digitalRead</span>(A4) == <span class="number">1</span> &amp;&amp; <span class="built_in">digitalRead</span>(A5) == <span class="number">1</span>)) </span><br><span class="line">    <span class="built_in">turnL</span>();</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (item == <span class="number">1</span> &amp;&amp; (<span class="built_in">digitalRead</span>(A4) == <span class="number">1</span> &amp;&amp; <span class="built_in">digitalRead</span>(A5) == <span class="number">1</span>))</span><br><span class="line">    <span class="built_in">turnR</span>();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeone</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  Points p1;</span><br><span class="line">  Points p2;</span><br><span class="line">  Points p3;</span><br><span class="line">  p1.x1=<span class="number">345</span>;</span><br><span class="line">  p1.y1=<span class="number">0</span>;</span><br><span class="line">  p1.z1=<span class="number">400</span>;</span><br><span class="line">  p2.x1=<span class="number">345</span>;</span><br><span class="line">  p2.y1=<span class="number">0</span>;</span><br><span class="line">  p2.z1=<span class="number">360</span>;</span><br><span class="line">  p3.x1=<span class="number">345</span>;</span><br><span class="line">  p3.y1=<span class="number">0</span>;</span><br><span class="line">  p3.z1=<span class="number">320</span>;</span><br><span class="line">  <span class="function">Arm <span class="title">arm1</span><span class="params">(L1,L2,L3,L4,p1)</span></span>;</span><br><span class="line">  arm1.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="function">Arm <span class="title">arm2</span><span class="params">(L1,L2,L3,L4,p2)</span></span>;</span><br><span class="line">  arm2.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="function">Arm <span class="title">arm3</span><span class="params">(L1,L2,L3,L4,p3)</span></span>;</span><br><span class="line">  arm3.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  flag_cp2 = <span class="number">3</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">writetwo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  Points p1;</span><br><span class="line">  Points p2;</span><br><span class="line">  Points p3;</span><br><span class="line">  Points p4;</span><br><span class="line">  Points p5;</span><br><span class="line">  Points p6;</span><br><span class="line">  p1.x1=<span class="number">345</span>;</span><br><span class="line">  p1.y1=<span class="number">40</span>;</span><br><span class="line">  p1.z1=<span class="number">400</span>;</span><br><span class="line">  p2.x1=<span class="number">345</span>;</span><br><span class="line">  p2.y1=<span class="number">-40</span>;</span><br><span class="line">  p2.z1=<span class="number">400</span>;</span><br><span class="line">  p3.x1=<span class="number">345</span>;</span><br><span class="line">  p3.y1=<span class="number">-40</span>;</span><br><span class="line">  p3.z1=<span class="number">360</span>;</span><br><span class="line">  p4.x1=<span class="number">345</span>;</span><br><span class="line">  p4.y1=<span class="number">40</span>;</span><br><span class="line">  p4.z1=<span class="number">360</span>;</span><br><span class="line">  p5.x1=<span class="number">345</span>;</span><br><span class="line">  p5.y1=<span class="number">40</span>;</span><br><span class="line">  p5.z1=<span class="number">320</span>;</span><br><span class="line">  p6.x1=<span class="number">345</span>;</span><br><span class="line">  p6.y1=<span class="number">-40</span>;</span><br><span class="line">  p6.z1=<span class="number">320</span>;</span><br><span class="line">  <span class="function">Arm <span class="title">arm1</span><span class="params">(L1,L2,L3,L4,p1)</span></span>;</span><br><span class="line">  arm1.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="function">Arm <span class="title">arm2</span><span class="params">(L1,L2,L3,L4,p2)</span></span>;</span><br><span class="line">  arm2.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="function">Arm <span class="title">arm3</span><span class="params">(L1,L2,L3,L4,p3)</span></span>;</span><br><span class="line">  arm3.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="function">Arm <span class="title">arm4</span><span class="params">(L1,L2,L3,L4,p4)</span></span>;</span><br><span class="line">  arm4.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="function">Arm <span class="title">arm5</span><span class="params">(L1,L2,L3,L4,p5)</span></span>;</span><br><span class="line">  arm5.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="function">Arm <span class="title">arm6</span><span class="params">(L1,L2,L3,L4,p6)</span></span>;</span><br><span class="line">  arm6.<span class="built_in">run</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  flag_cp2 = <span class="number">3</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">armset</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  Points p0;</span><br><span class="line">  p0.x1=<span class="number">280</span>;</span><br><span class="line">  p0.y1=<span class="number">0</span>;</span><br><span class="line">  p0.z1=<span class="number">320</span>;</span><br><span class="line">  <span class="function">Arm <span class="title">arm0</span><span class="params">(L1,L2,L3,L4,p0)</span></span>;</span><br><span class="line">  arm0.<span class="built_in">run</span>();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  servo_7.<span class="built_in">attach</span>(<span class="number">7</span>);</span><br><span class="line">  servo_3.<span class="built_in">attach</span>(<span class="number">3</span>);</span><br><span class="line">  servo_5.<span class="built_in">attach</span>(<span class="number">5</span>);</span><br><span class="line">  servo_6.<span class="built_in">attach</span>(<span class="number">6</span>);</span><br><span class="line">  servo_9.<span class="built_in">attach</span>(<span class="number">9</span>);</span><br><span class="line">  <span class="comment">//servo_8.attach(8);</span></span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">115200</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">400</span>);</span><br><span class="line">  item = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">pinMode</span>(A1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A2, INPUT_PULLUP);</span><br><span class="line">  <span class="built_in">pinMode</span>(A5, INPUT_PULLUP);</span><br><span class="line">  <span class="built_in">pinMode</span>(A4, INPUT_PULLUP);</span><br><span class="line">  <span class="built_in">pinMode</span>(A0, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A3, INPUT_PULLUP);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> leftflag=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> rightflag=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">if</span> (flag_cp2 == <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">armset</span>();</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (flag_cp2 == <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">writeone</span>();</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (flag_cp2 == <span class="number">2</span>)</span><br><span class="line">    <span class="built_in">writetwo</span>();</span><br><span class="line">  <span class="type">float</span> distance = <span class="built_in">checkdistance_A1_A2</span>();</span><br><span class="line">  <span class="keyword">if</span> (distance &gt; <span class="number">19</span> &amp;&amp; flag_cp1==<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">follow</span>();</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (distance &lt;=<span class="number">19</span> &amp;&amp; flag_cp1==<span class="number">0</span>)</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">stop</span>();</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A0, HIGH);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">3000</span>);</span><br><span class="line">    color = <span class="built_in">digitalRead</span>(A3);<span class="comment">//0-green,1-blue</span></span><br><span class="line">    <span class="keyword">if</span>(color == <span class="number">1</span>)</span><br><span class="line">      <span class="built_in">turningleft</span>();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (color == <span class="number">0</span>)</span><br><span class="line">      <span class="built_in">turningright</span>();</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A0, LOW);</span><br><span class="line">    flag_cp1=<span class="number">1</span>;</span><br><span class="line">    startTime = <span class="built_in">millis</span>();</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (distance &gt;<span class="number">17</span> &amp;&amp; flag_cp1==<span class="number">1</span>)</span><br><span class="line">  {</span><br><span class="line">    currentTime = <span class="built_in">millis</span>();</span><br><span class="line">    elapsedTime = currentTime - startTime;</span><br><span class="line">    <span class="keyword">if</span>(color == <span class="number">1</span>)</span><br><span class="line">    {</span><br><span class="line">      <span class="keyword">if</span> (elapsedTime&lt;=<span class="number">33000</span>)</span><br><span class="line">        <span class="built_in">follow</span>();</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (elapsedTime&gt;<span class="number">33000</span>) </span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span>(leftflag == <span class="number">0</span>)</span><br><span class="line">        {</span><br><span class="line">          <span class="built_in">leftturningleft</span>(); </span><br><span class="line">          <span class="built_in">leftforward</span>();</span><br><span class="line">          leftflag=<span class="number">1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A4) == <span class="number">0</span> &amp;&amp; <span class="built_in">digitalRead</span>(A5) == <span class="number">0</span>)</span><br><span class="line">          <span class="built_in">leftforward</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          <span class="built_in">follow</span>();</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (color == <span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">      <span class="keyword">if</span> (elapsedTime&lt;=<span class="number">34000</span>)</span><br><span class="line">        <span class="built_in">follow</span>();</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (elapsedTime&gt;<span class="number">34000</span>) </span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span>(rightflag == <span class="number">0</span>)</span><br><span class="line">        {</span><br><span class="line">          <span class="built_in">rightturningright</span>(); </span><br><span class="line">          <span class="built_in">rightforward</span>();</span><br><span class="line">          rightflag=<span class="number">1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A4) == <span class="number">0</span> &amp;&amp; <span class="built_in">digitalRead</span>(A5) == <span class="number">0</span>)</span><br><span class="line">          <span class="built_in">rightforward</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          <span class="built_in">follow</span>();</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (distance &lt;=<span class="number">17</span> &amp;&amp; flag_cp1==<span class="number">1</span>)</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">stop</span>();</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A0, HIGH);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">5000</span>);</span><br><span class="line">    size=<span class="built_in">digitalRead</span>(A3);<span class="comment">//0-small,1-big</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(A0, LOW);</span><br><span class="line">    <span class="keyword">if</span> (size==<span class="number">0</span> &amp;&amp; flag_cp2!=<span class="number">3</span>)</span><br><span class="line">      flag_cp2=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (size==<span class="number">1</span> &amp;&amp; flag_cp2!=<span class="number">3</span>)</span><br><span class="line">      flag_cp2=<span class="number">2</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2023-03-05T05:12:58.000Z" title="2023/3/5 13:12:58">2023-03-05</time>发表</span><span class="level-item"><time datetime="2023-08-03T09:18:18.757Z" title="2023/8/3 17:18:18">2023-08-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a><span>&nbsp;/&nbsp;</span><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E5%8E%9F%E7%90%86/">工程原理</a></span><span class="level-item">30 分钟读完 (大约4448个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/05/car/">寻迹小车</a></p><div class="content"><div id="postchat_postcontent"><h4 id="一、绪论"><a href="#一、绪论" class="headerlink" title="一、绪论"></a>一、绪论</h4><hr>
<h5 id="1-1-实验背景"><a href="#1-1-实验背景" class="headerlink" title="1.1 实验背景"></a>1.1 实验背景</h5><h6 id="1-1-1-问题的情景"><a href="#1-1-1-问题的情景" class="headerlink" title="1.1.1 问题的情景"></a>1.1.1 问题的情景</h6><p>长期以来，由于我国是人口大国而且工业基础薄弱，因此早期在我国机器人的发展受到一定的限制。然而随着制造业工人的人力成本的不断上升与社会自动化程度的不断提高，我国也开始着重于发展机器人，并且也取得了较大的进步。在 1995 年，我国沈阳自动化所开始研制HT—100A点焊机器人，是我国较早的机器人了，如图1所示；此后，沈阳新松公司研发出了6 kg弧焊机器人，此机器人不仅实用，而且轻便，如图 2 所示；之后，哈尔滨工业大学机器 人研究所也研发出了便携式机器人，此机器人具有 6 自由度，增强了焊接能力，成为在恶劣环境中实现焊接功能的重要设备。总之，在国家“863 计划”与“十一五”计划的指导下，我国机器人的设计取得了飞速发 展，甚至在机器人的某些关键部件的设计已经接近于世界先进水平，并在世界工业机器人领域已经占有一席之地了。</p>
<p><img src="/images/car/1.png" alt="1"></p>
<p><img src="/images/car/2.png" alt="2"></p>
<h6 id="1-1-2-实验的目的"><a href="#1-1-2-实验的目的" class="headerlink" title="1.1.2 实验的目的"></a>1.1.2 实验的目的</h6><p>目前，机器人的发展趋势非常的迅猛，机器人可以替代人类去从事高危险的工作，减轻了人类的劳动强度。本文通过对机器人的发展史进行简要的介绍，阐明了我国发展机器人的必要性。同时，对于我国的发展而言，我国正处于工业化进程的关键时期，将来的高强度、高危险行业的工人数量将会急剧的下降，机器人将会迎来新的“春天”，所以机器人的发展仍拥有巨大的发展空间。同时，由于我国各机器人的厂商对于机器人的研发能力与金钱投资的不同，在我国的机器人市场上的竞争也会愈演愈烈，最终也将形成我国的机器人研发市场。总之，在未来的几十年里，相信重点发展机器人将会成为社会的发展趋势，不久机器人将会引领未来，加入到我国现代化建设的行列中。小车，也就是轮式机器人，作为以学科交叉、产品创新为特色的明月班同学，切入这个产业不失为优秀的选择，故而选取小车为切入点了解相关知识。</p>
<h5 id="1-2-实验内容"><a href="#1-2-实验内容" class="headerlink" title="1.2 实验内容"></a>1.2 实验内容</h5><h6 id="1-2-1-使用51单片机控制及其元器件"><a href="#1-2-1-使用51单片机控制及其元器件" class="headerlink" title="1.2.1 使用51单片机控制及其元器件"></a>1.2.1 使用51单片机控制及其元器件</h6><p>STC89C52控制板芯片、1.5V干电池x4、L298N电机驱动板x1、红外循迹模块、直流电机x2以及搭建材料若干；</p>
<p><img src="/images/car/3.jpg" alt="3"></p>
<h6 id="1-2-2使用FPGA开发板控制及其元器件"><a href="#1-2-2使用FPGA开发板控制及其元器件" class="headerlink" title="1.2.2使用FPGA开发板控制及其元器件"></a>1.2.2使用FPGA开发板控制及其元器件</h6><p>Cyclonell EP2C5T144控制板芯片1.5V干电池x4、L298N电机驱动板x1、红外循迹模块、直流电机x2以及搭建材料若干；</p>
<p><img src="/images/car/4.jpg" alt="4"></p>
<br>

<h4 id="二、实现过程"><a href="#二、实现过程" class="headerlink" title="二、实现过程"></a>二、实现过程</h4><hr>
<h5 id="2-1-总体工作原理简释"><a href="#2-1-总体工作原理简释" class="headerlink" title="2.1 总体工作原理简释"></a>2.1 总体工作原理简释</h5><h6 id="2-1-2-红外循迹模块"><a href="#2-1-2-红外循迹模块" class="headerlink" title="2.1.2 红外循迹模块"></a>2.1.2 红外循迹模块</h6><p>第一步，位于小车前端的红外模块会释放红外线探测下方是否为黑色区域，并将相应的高低电平信号传递至控制模块（51单片机/FPGA开发板）处理，控制模块随后将发送信息至L298N电机驱动的控制模块，并由此控制左右两轮的转动速度以及转动方向，从而实现对黑线的反应和循迹。</p>
<p>作为电机的驱动模块，该模块对控制小车移动有着重要且直接的作用。</p>
<p><img src="/images/car/5.png" alt="5"></p>
<p>利用红外发射器向地面发射红外线，并用传感器接收由地面反射的红外线。当红外接收模块下方为黑色轨迹时，红外线被黑色轨迹吸收，传感器没有接收到红外线，红外循迹模块输出低电平到单片机。反之，传感器接收到红外线，红外循迹模块输出高电平到单片机。可通过红外循迹模块输出的信号来判断小车是否偏离轨迹。可调电阻可以调节传感器的灵敏度，易于调试。使用红外循迹模块方案也易于实现，红外循迹方案相比于摄像循迹成本更加便宜，软件设计更加简单，设计制作周期短，具备一定可靠性。</p>
<p>对于左电机，共有输入ENA、IN1、IN2，输出OUT1（黑线）、OUT2（红线）、其信号与运动对应如下：（0,X,X）停止、（1,0,0）停止、（1,1,0）正传、（1,0,1）反转、（1,1,1）停止；</p>
<p>对于右电机，共有输入ENB、IN3、IN4，输出OUT3（黑线）、OUT4（红线），其信号与运动对应如下：（0,X,X）停止、（1,0,0）停止、（1,1,0）反传、（1,0,1）正转、（1,1,1）停止。</p>
<h6 id="2-1-3-L298N电机驱动模块"><a href="#2-1-3-L298N电机驱动模块" class="headerlink" title="2.1.3 L298N电机驱动模块"></a>2.1.3 L298N电机驱动模块</h6><p><img src="/images/car/6.jpg" alt="6"></p>
<p>L298N是ST公司的一款电机驱动芯片，也是集成了双H桥，但与上面两个略有不同。电机驱动电压3~48V；可持续工作的输出电流为2A，峰值可达3A。如上图，L298N模块明显有较多的外接元件，这与L298N的内部结构有关。如上图，由于该芯片在H桥上的损耗严重发热较明显（饱和压降大），需要加装散热片，因此在使用上比前两个芯片复杂，体积也相对较大。其各引脚如下图所示。</p>
<p><img src="/images/car/7.png" alt="7"></p>
<h5 id="2-2-使用51单片机部分"><a href="#2-2-使用51单片机部分" class="headerlink" title="2.2 使用51单片机部分"></a>2.2 使用51单片机部分</h5><h6 id="2-2-1-硬件接线"><a href="#2-2-1-硬件接线" class="headerlink" title="2.2.1 硬件接线"></a>2.2.1 硬件接线</h6><p><img src="/images/car/8.png" alt="8"></p>
<p><img src="/images/car/9.png" alt="9"></p>
<p>1为电源输入，与电池盒的输出线相连；2为电源输出，3为驱动板输入，两者需要相连，注意红线为VCC，黑线为GND；4 为单片机IO口引脚，5为驱动板的IN1到 IN4以及ENA和ENB，按照器件上的标注对应连接即可。 6 为与循迹模块的对应接口，按照器件上的标注对应连接即可。 7 和 8 为驱动板与两个电机之间的连线，按照上图所示连接即可。 到这里，基本完成了小车的硬件组装与线路连接，小车要完成循迹进行这些连线就够了，不过在烧录程序到单片机中时还需要 额外的连线，这个将在后面进行说明。</p>
<p>供电上使用四节5号电池。</p>
<h6 id="2-2-2-程序设计"><a href="#2-2-2-程序设计" class="headerlink" title="2.2.2 程序设计"></a>2.2.2 程序设计</h6><p>首先是如何处理红外模块的探测结果。我们需要先对结果进行编码。我们记没有识别到黑线为0，识别到为1，则我们需要一个算式来囊括左右传感器结果并能对不同情况进行表示。在这里，我们记data2为左边的结果，data3为右边的结果，现给出算式data1=data2*10+data3，data1即检测结果。根据data2、data3不同组合：（1,1）在黑线上；（1,0）略向右偏离；（0,1）略向左偏离；（0,0）完全偏离轨道，分别对应了data1的四个取值，即11、10、1、0，亦即四种情况。相应的，我们需要做出四种反馈，即“前进”、“左转”、“右转”、“停下”。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span><span class="comment">//51头文件</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> pwm\_val\_left, pwm\_val\_right; <span class="comment">//中间变量</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> pwm\_left, pwm\_right; <span class="comment">//定义PWM输出高电平的时间的变量（用户操作PWM的变量）</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PWM\_DUTY 100 <span class="comment">//定义PWM的周期，数值为定时器0溢出周期，假如定时器溢出时间为100us，则PWM周期为10ms。</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PWM\_HIGH\_MIN 35 <span class="comment">//限制PWM输出的最小占空比</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PWM\_HIGH\_MAX PWM\_DUTY <span class="comment">//限制PWM输出的最大占空比</span></span></span><br><span class="line"></span><br><span class="line">/\*电机驱动IO定义\*/</span><br><span class="line">sbit leftMotorPwm = P1^<span class="number">5</span>; <span class="comment">//为1 左电机使能</span></span><br><span class="line">sbit IN1 = P1^<span class="number">4</span>; <span class="comment">//为1 左电机正转</span></span><br><span class="line">sbit IN2 = P1^<span class="number">3</span>; <span class="comment">//为1 左电机反转</span></span><br><span class="line">sbit IN3 = P1^<span class="number">2</span>; <span class="comment">//为1 右电机反转</span></span><br><span class="line">sbit IN4 = P1^<span class="number">1</span>; <span class="comment">//为1 右电机正转</span></span><br><span class="line">sbit rightMotorPwm = P1^<span class="number">0</span>; <span class="comment">//为1 右电机使能</span></span><br><span class="line"></span><br><span class="line">sbit leftSensor = P3^<span class="number">4</span>;<span class="comment">//左传感器：为0没有识别到黑线，为1识别到黑线</span></span><br><span class="line">sbit rightSensor = P3^<span class="number">5</span>;<span class="comment">//右传感器：为0没有识别到黑线，为1识别到黑线</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> Timer0\_Init(<span class="type">void</span>); <span class="comment">//定时器初始化</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">LoadPWM</span><span class="params">(<span class="type">void</span>)</span>;<span class="comment">//装入PWM输出值</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">forward</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span>;<span class="comment">//前进</span></span><br><span class="line"><span class="type">void</span> left\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed);<span class="comment">//左转</span></span><br><span class="line"><span class="type">void</span> right\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed);<span class="comment">//右转</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">back</span><span class="params">(<span class="type">void</span>)</span>;<span class="comment">//后退修正</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Tracking</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line"><span class="comment">//为0 没有识别到黑线 为1识别到黑线</span></span><br><span class="line"><span class="type">char</span> data1, data2 = leftSensor,data3 = rightSensor;</span><br><span class="line">data1 = data2\*<span class="number">10</span>+data3;</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">11</span>)<span class="comment">//在黑线上，前进</span></span><br><span class="line">{</span><br><span class="line"><span class="comment">//forward(120,120);//前进</span></span><br><span class="line">forward(<span class="number">70</span>,<span class="number">70</span>);<span class="comment">//前进</span></span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">{</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">10</span>)<span class="comment">//小幅偏右，左转</span></span><br><span class="line">{</span><br><span class="line"><span class="comment">//left\_run(80,160);//左转</span></span><br><span class="line">left\_run(<span class="number">70</span>,<span class="number">70</span>);<span class="comment">//左转</span></span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">1</span>)<span class="comment">//小幅偏左，右转</span></span><br><span class="line">{</span><br><span class="line"><span class="comment">//right\_run(160,80);//右转</span></span><br><span class="line">right\_run(<span class="number">70</span>,<span class="number">70</span>);<span class="comment">//右转</span></span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">0</span>)<span class="comment">//大幅偏左或偏右，已脱离轨道</span></span><br><span class="line">{</span><br><span class="line">back();<span class="comment">//后退校正</span></span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/\*主函数\*/</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line">Timer0\_Init();<span class="comment">//定时0初始化</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">{</span><br><span class="line">Tracking();</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">forward</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed,<span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span></span><br><span class="line">{</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">1</span>;</span><br><span class="line">IN2 = <span class="number">0</span>;</span><br><span class="line">IN3 = <span class="number">0</span>;</span><br><span class="line">IN4 = <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> left\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span><br><span class="line">{</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">1</span>;</span><br><span class="line">IN2 = <span class="number">0</span>;</span><br><span class="line">IN3 = <span class="number">1</span>;</span><br><span class="line">IN4 = <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> right\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span><br><span class="line">{</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">0</span>;</span><br><span class="line">IN2 = <span class="number">1</span>;</span><br><span class="line">IN3 = <span class="number">0</span>;</span><br><span class="line">IN4 = <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">back</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">0</span>;</span><br><span class="line">IN2 = <span class="number">1</span>;</span><br><span class="line">IN3 = <span class="number">1</span>;</span><br><span class="line">IN4 = <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Timer0初始化\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/</span><br><span class="line"><span class="type">void</span> Timer0\_Init(<span class="type">void</span>)</span><br><span class="line">{</span><br><span class="line">TMOD |= <span class="number">0x02</span>;<span class="comment">//定时器0，8位自动重装模块</span></span><br><span class="line">TH0 = <span class="number">164</span>;</span><br><span class="line">TL0 = <span class="number">164</span>;<span class="comment">//11.0592M晶振，12T溢出时间约等于100微秒</span></span><br><span class="line">TR0 = <span class="number">1</span>;<span class="comment">//启动定时器0</span></span><br><span class="line">ET0 = <span class="number">1</span>;<span class="comment">//允许定时器0中断</span></span><br><span class="line">EA = <span class="number">1</span>;<span class="comment">//总中断允许</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Timer0中断函数\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/</span><br><span class="line"><span class="type">void</span> timer0\_int (<span class="type">void</span>) interrupt <span class="number">1</span></span><br><span class="line">{</span><br><span class="line">pwm\_val\_left++;</span><br><span class="line">pwm\_val\_right++;</span><br><span class="line"><span class="keyword">if</span>(pwm\_left &gt; PWM\_HIGH\_MAX) pwm\_left = PWM\_HIGH\_MAX; <span class="comment">//如果左输出写入大于最大占空比数据，则强制为最大占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_left &lt; PWM\_HIGH\_MIN) pwm\_left = PWM\_HIGH\_MIN; <span class="comment">//如果左输出写入小于最小占空比数据，则强制为最小占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_right &gt; PWM\_HIGH\_MAX) pwm\_right = PWM\_HIGH\_MAX; <span class="comment">//如果右输出写入大于最大占空比数据，则强制为最大占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_right &lt; PWM\_HIGH\_MIN) pwm\_right = PWM\_HIGH\_MIN; <span class="comment">//如果右输出写入小于最小占空比数据，则强制为最小占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_left&lt;=pwm\_left) leftMotorPwm = <span class="number">1</span>; <span class="comment">//装载左PWM输出高电平时间</span></span><br><span class="line"><span class="keyword">else</span> leftMotorPwm = <span class="number">0</span>; <span class="comment">//装载左PWM输出低电平时间</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_left&gt;=PWM\_DUTY) pwm\_val\_left = <span class="number">0</span>; <span class="comment">//如果左对比值大于等于最大占空比数据，则为零</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_right&lt;=pwm\_right) rightMotorPwm = <span class="number">1</span>; <span class="comment">//装载右PWM输出高电平时间</span></span><br><span class="line"><span class="keyword">else</span> rightMotorPwm = <span class="number">0</span>; <span class="comment">//装载右PWM输出低电平时间</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_right&gt;=PWM\_DUTY) pwm\_val\_right = <span class="number">0</span>; <span class="comment">//如果右对比值大于等于最大占空比数据，则为零</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h5 id="2-3-使用FPGA开发板部分"><a href="#2-3-使用FPGA开发板部分" class="headerlink" title="2.3 使用FPGA开发板部分"></a>2.3 使用FPGA开发板部分</h5><h6 id="2-3-1-硬件接线"><a href="#2-3-1-硬件接线" class="headerlink" title="2.3.1 硬件接线"></a>2.3.1 硬件接线</h6><p>系统时钟和复位信号必须为PIN17和PIN_90，不过这两个引脚在开发板上已经连接上了，无须手动连接。其它的引脚可以在下表中“FPGA引出I/O”部分选择即可，然后参照之间的51单片机进行连接。</p>
<p>此处附上接线实物图，需要注意的是，FPGA需要独立的接线供电，如充电宝等等。</p>
<p><img src="/images/car/10.jpg" alt="10"></p>
<h6 id="2-3-2程序设计"><a href="#2-3-2程序设计" class="headerlink" title="2.3.2程序设计"></a>2.3.2程序设计</h6><p>逻辑上大体与51相同，此处附上代码部分以及引脚的设置图。</p>
<p><img src="/images/car/11.jpg" alt="11"></p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">LIBRARY ieee;</span><br><span class="line">USE ieee.<span class="built_in">std</span>\_logic\_1164.all;</span><br><span class="line">ENTITY cartracking IS</span><br><span class="line"><span class="title function_">GENERIC</span> <span class="params">(</span></span><br><span class="line"><span class="params">--时钟为<span class="number">50</span>MHz，为了产生<span class="number">100</span>Hz的PWM波，设置计数值为<span class="number">500000</span></span></span><br><span class="line"><span class="params">cnt\_meta : INTEGER := <span class="number">500000</span>;</span></span><br><span class="line"><span class="params">--对应了停止、前进、左转、右转状态IN4到IN1的输出</span></span><br><span class="line"><span class="params">Back : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">"0110"</span>;</span></span><br><span class="line"><span class="params">Forward : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">"1001"</span>;</span></span><br><span class="line"><span class="params">Left\_Go : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">"0101"</span>;</span></span><br><span class="line"><span class="params">Right\_Go : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">"1010"</span></span></span><br><span class="line"><span class="params">)</span>;</span><br><span class="line"></span><br><span class="line">--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*输入输出端口\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*</span><br><span class="line">PORT (</span><br><span class="line">sys\_clk : IN STD\_LOGIC;</span><br><span class="line">sys\_rst\_n : IN STD\_LOGIC;</span><br><span class="line">infrared : IN STD\_LOGIC\_VECTOR(<span class="number">1</span> DOWNTO <span class="number">0</span>);</span><br><span class="line">pwm\_left : OUT STD\_LOGIC;</span><br><span class="line">pwm\_right : OUT STD\_LOGIC;</span><br><span class="line">in\_motor : OUT STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>)</span><br><span class="line">);</span><br><span class="line">END cartracking;</span><br><span class="line"></span><br><span class="line">ARCHITECTURE trans OF cartracking IS</span><br><span class="line">SIGNAL cnt : INTEGER;</span><br><span class="line">SIGNAL duty\_left : INTEGER;</span><br><span class="line">SIGNAL duty\_right : INTEGER;</span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">PROCESS</span> <span class="params">(sys\_rst\_n, infrared)</span></span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(sys\_rst\_n = <span class="string">'0'</span>)</span> THEN</span><br><span class="line">duty\_right &lt;= <span class="number">60</span>;</span><br><span class="line">duty\_left &lt;= <span class="number">60</span>;</span><br><span class="line">ELSE</span><br><span class="line">CASE infrared IS</span><br><span class="line">WHEN <span class="string">"00"</span> =&gt;</span><br><span class="line">in\_motor &lt;= Back;--后退</span><br><span class="line">WHEN <span class="string">"01"</span> =&gt;</span><br><span class="line">in\_motor &lt;= Right\_Go;--右转</span><br><span class="line">--PWM波的占空比，应设置合适的值来控制小车的转速，为了在仿真时可以对比，特将左右轮设置了不同的占空比。</span><br><span class="line">duty\_left &lt;= <span class="number">35</span>;</span><br><span class="line">duty\_right &lt;= <span class="number">55</span>;</span><br><span class="line">WHEN <span class="string">"10"</span> =&gt;</span><br><span class="line">in\_motor &lt;= Left\_Go;--左转</span><br><span class="line">duty\_left &lt;= <span class="number">55</span>;</span><br><span class="line">duty\_right &lt;= <span class="number">35</span>;</span><br><span class="line">WHEN OTHERS =&gt;</span><br><span class="line">in\_motor &lt;= Forward;--前进</span><br><span class="line">duty\_left &lt;= <span class="number">50</span>;</span><br><span class="line">duty\_right &lt;= <span class="number">50</span>;</span><br><span class="line">END CASE;</span><br><span class="line">END IF;</span><br><span class="line">END PROCESS;</span><br><span class="line"></span><br><span class="line">PROCESS (sys\_clk, sys\_rst\_n)</span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(sys\_rst\_n = <span class="string">'0'</span>)</span> THEN</span><br><span class="line">cnt &lt;= <span class="number">0</span>;</span><br><span class="line">ELSIF (sys\_clk<span class="number">'</span>EVENT AND sys\_clk = <span class="string">'1'</span>) THEN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(cnt = cnt\_meta)</span> THEN</span><br><span class="line">cnt &lt;= <span class="number">0</span>;</span><br><span class="line">ELSE</span><br><span class="line">cnt &lt;= cnt + <span class="number">1</span>;</span><br><span class="line">END IF;</span><br><span class="line">END IF;</span><br><span class="line">END PROCESS;</span><br><span class="line"></span><br><span class="line">PROCESS (sys\_clk, sys\_rst\_n)</span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(sys\_rst\_n = <span class="string">'0'</span>)</span> THEN</span><br><span class="line">pwm\_left &lt;= <span class="string">'0'</span>;</span><br><span class="line">pwm\_right &lt;= <span class="string">'0'</span>;</span><br><span class="line">ELSIF (sys\_clk<span class="number">'</span>EVENT AND sys\_clk = <span class="string">'1'</span>) THEN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(cnt &gt;= (cnt\_meta / <span class="number">100</span>)\* duty\_left)</span> THEN</span><br><span class="line">pwm\_left &lt;= <span class="string">'0'</span>;</span><br><span class="line">ELSE</span><br><span class="line">pwm\_left &lt;= <span class="string">'1'</span>;</span><br><span class="line">END IF;</span><br><span class="line">IF (cnt &gt;= (cnt\_meta / <span class="number">100</span>) \* duty\_right) THEN</span><br><span class="line">pwm\_right &lt;= <span class="string">'0'</span>;</span><br><span class="line">ELSE</span><br><span class="line">pwm\_right &lt;= <span class="string">'1'</span>;</span><br><span class="line">END IF;</span><br><span class="line">END IF;</span><br><span class="line">END PROCESS;</span><br><span class="line">END trans;</span><br></pre></td></tr></tbody></table></figure>

<br>

<h4 id="3调试及优化"><a href="#3调试及优化" class="headerlink" title="3调试及优化"></a>3调试及优化</h4><hr>
<h5 id="3-1简单优化"><a href="#3-1简单优化" class="headerlink" title="3.1简单优化"></a>3.1简单优化</h5><p>由于在测试时需要在保证小车前进速度的同时兼顾其转弯的效率和稳定性，特别是如果直行时转速过快会导致小车在转弯时直接冲出赛道而无法循迹。在原本的设计中，我们将未识别到黑线的反应设置为电机停转而使得小车停止，而这会使得小车无法在冲出赛道后进行自我校正。因此，我们将未识别到黑线时的输出信号由“0000”改为“0110”，即使得左右电机均由原本的停转改为反转，从而实现循迹过程中对于轨道循迹的自我修正。</p>
<p>在 PWM 频率设置的时候， PWM 的频率太低可能导致电机转动不稳定，不 是匀速转动，而 PWM 频率过高可能导致电机反应不过来或者超过电路的上限截止频率。事实上，考虑到转弯过程的稳定性与速度问题，包括与直行过程的速度以及传感器的灵敏度调节配合，我们需要通过实际测试来进一步确定在直行、左转、右转和倒退过程中设定的PWM占空比与转速。具体在调试之后所得到的合适参数已经在上面的代码中有所体现，在此不过多赘述。</p>
<p><img src="/images/car/12.png" alt="12"></p>
<p><img src="/images/car/13.png" alt="13"></p>
<h5 id="3-2调试过程"><a href="#3-2调试过程" class="headerlink" title="3.2调试过程"></a>3.2调试过程</h5><p>考虑到验收时的重要评判标准是小车循迹一周的时间，且小车本身运动缓慢，我们首先将目光放在了转速的提高上。修改参数大幅提高了轮子的转速后，我们进行了一次实验：结果出乎意料，小车非但没有预想的那样，反而在行进的过程中持续摇摆。分析原因是行进角度不平行于轨道时容易冲出轨道，后续针对此原因，在红外灵敏度以及直行、左转、右转和倒退过程中设定的PWM占空比与转速多次调试与测试。中途红外模块损坏，经过排查确定后更换了新的。此外，我们注意到行进中的不稳定性还来自于万向轮的松散，我们尝试了不限于胶带、缠绳等各种方式加以限制，效果均不理想，虽然直道可以稳定快速行进，转弯却尤为吃力。</p>
<p>最后51的部分取得了第二名的不错成绩。但是FPGA部分却难遂人意。我们一直将注意力放在数据的调试上却忽略了时间的把控，以至于直到最后快结束才仓促进行测试，测试时还发生了接线断开等突发状况。我们本着希望更加灵活的愿望想别的同学借来充电宝供电，没想到这成为了测试失败的最大缘由——充电宝供电严重不足，导致小车行进乏力，但等到我们重新接上电脑供电确认可以正常运行时，却被告知时间已到，不允许再次测试以保证公平。最后无奈接受这个最慢的成绩。</p>
<br>

<h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><hr>
<p>[1] 默默无闻小菜鸡. 电机驱动芯片（H桥、直流电机驱动方式）——DRV8833、TB6612、A4950、L298N的详解与比较[EB/OL]. <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44897194/article/details/105524808">https://blog.csdn.net/qq_44897194/article/details/105524808</a>, 2020-5-11.</p>
<p>[2] 周海,叶兵. 机器人的发展现状及应用前景[J]. <a target="_blank" rel="noopener" href="https://kns.cnki.net/kcms2/article/abstract?v=3uoqIhG8C44YLTlOAiTRKibYlV5Vjs7iAEhECQAQ9aTiC5BjCgn0Rn5ykE3W8_mbbrKtMuQk3r9gP-p4derKJErhs1XrNO9Y&amp;uniplatform=NZKPT">https://kns.cnki.net/kcms2/article/abstract?v=3uoqIhG8C44YLTlOAiTRKibYlV5Vjs7iAEhECQAQ9aTiC5BjCgn0Rn5ykE3W8_mbbrKtMuQk3r9gP-p4derKJErhs1XrNO9Y&amp;uniplatform=NZKPT</a>, 2017-6-18.</p>
<br>

<h4 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h4><hr>
<p>感谢老师们在本课程中的精心准备与付出。在数电和模电部分得到了曾正教授和袁刚教授的悉心教诲，在后续的项目部分得到了李敏教授和凌睿教授的认真指导，最终得以基本实现预定目标，特此鸣谢！</p>
</div></div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/head2.png" alt="Jinghua Xu"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Jinghua Xu</p><p class="is-size-6 is-block">明月科创实验班人工智能专业 本科大三在读</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>重庆 重庆大学国家卓越工程师学院</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">32</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">22</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">91</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Asgard-Tim" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Asgard-Tim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://www.weibo.com/u/6315188431"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://space.bilibili.com/171895120"><i class="fab fa-bilibili"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:20224546@stu.cqu.edu.cn"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Phone" href="tel:+86 19132050174"><i class="fas fa-phone"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2025/04/23/project02/"><img src="/images/project2/1.png" alt="图像插值算法及其优化"></a></figure><div class="media-content"><p class="date"><time datetime="2025-04-22T18:07:03.000Z">2025-04-23</time></p><p class="title"><a href="/2025/04/23/project02/">图像插值算法及其优化</a></p><p class="categories"><a href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a> / <a href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/">工程数值分析</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/04/18/3DVLA/"><img src="/images/3dvla/6.png" alt="3D-VLA： A 3DVision-Language-Action Generative World Model"></a></figure><div class="media-content"><p class="date"><time datetime="2025-04-18T11:00:03.000Z">2025-04-18</time></p><p class="title"><a href="/2025/04/18/3DVLA/">3D-VLA： A 3DVision-Language-Action Generative World Model</a></p><p class="categories"><a href="/categories/%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">具身智能论文阅读</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/04/10/project01/"><img src="/images/project01/17.png" alt="求矩阵特征值与特征向量：乘幂法及其改进算法"></a></figure><div class="media-content"><p class="date"><time datetime="2025-04-10T09:44:03.000Z">2025-04-10</time></p><p class="title"><a href="/2025/04/10/project01/">求矩阵特征值与特征向量：乘幂法及其改进算法</a></p><p class="categories"><a href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a> / <a href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/">工程数值分析</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/04/07/%E7%AC%AC%E4%BA%8C%E7%AB%A0%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><img src="/images/phi.png" alt="第二章 数据结构"></a></figure><div class="media-content"><p class="date"><time datetime="2025-04-07T05:26:58.000Z">2025-04-07</time></p><p class="title"><a href="/2025/04/07/%E7%AC%AC%E4%BA%8C%E7%AB%A0%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">第二章 数据结构</a></p><p class="categories"><a href="/categories/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80%E8%AF%BE/">算法基础课</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/04/06/RT-1/"><img src="/images/rt1/1.png" alt="RT-1：Robotics Transformer for Real-world Control at Scale"></a></figure><div class="media-content"><p class="date"><time datetime="2025-04-06T09:24:03.000Z">2025-04-06</time></p><p class="title"><a href="/2025/04/06/RT-1/">RT-1：Robotics Transformer for Real-world Control at Scale</a></p><p class="categories"><a href="/categories/%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">具身智能论文阅读</a></p></div></article></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/About-XJH/"><span class="level-start"><span class="level-item">About XJH</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/About-XJH/%E6%98%8E%E6%85%B5/"><span class="level-start"><span class="level-item">明慵</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/About-XJH/%E6%98%8E%E8%AF%9A/"><span class="level-start"><span class="level-item">明诚</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">个人项目</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/"><span class="level-start"><span class="level-item">具身智能论文阅读</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">动手学深度学习</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80%E8%AF%BE/"><span class="level-start"><span class="level-item">算法基础课</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">课程项目</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">产品设计</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%AE%9A%E9%87%8F%E5%B7%A5%E7%A8%8B%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95I/"><span class="level-start"><span class="level-item">定量工程设计方法I</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%AE%9A%E9%87%8F%E5%B7%A5%E7%A8%8B%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95II/"><span class="level-start"><span class="level-item">定量工程设计方法II</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E6%95%88%E5%AD%A6/"><span class="level-start"><span class="level-item">工效学</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E5%8E%9F%E7%90%86/"><span class="level-start"><span class="level-item">工程原理</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/"><span class="level-start"><span class="level-item">工程数值分析</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">工程设计</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E6%95%B0%E5%AD%A6%E7%89%A9%E7%90%86%E6%96%B9%E6%B3%95/"><span class="level-start"><span class="level-item">数学物理方法</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/"><span class="level-start"><span class="level-item">智能图像处理</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">机器人基础</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E6%A6%82%E7%8E%87%E8%AE%BA%E4%B8%8E%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1/"><span class="level-start"><span class="level-item">概率论与数理统计</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"><span class="level-start"><span class="level-item">线性代数</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E8%87%AA%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86/"><span class="level-start"><span class="level-item">自动控制原理</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">软件设计</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/04/"><span class="level-start"><span class="level-item">四月 2025</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/03/"><span class="level-start"><span class="level-item">三月 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/02/"><span class="level-start"><span class="level-item">二月 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/01/"><span class="level-start"><span class="level-item">一月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">十二月 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">六月 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">二月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">一月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">七月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">五月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">三月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/3D-VLA/"><span class="tag">3D-VLA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ADS1292/"><span class="tag">ADS1292</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buck%E5%8F%98%E6%8D%A2%E5%99%A8/"><span class="tag">Buck变换器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C51/"><span class="tag">C51</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/COMSOL/"><span class="tag">COMSOL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ChatGPT/"><span class="tag">ChatGPT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FIR/"><span class="tag">FIR</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FPGA/"><span class="tag">FPGA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FreeRTOS/"><span class="tag">FreeRTOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IIR/"><span class="tag">IIR</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Logistic%E5%9B%9E%E5%BD%92/"><span class="tag">Logistic回归</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MATLAB/"><span class="tag">MATLAB</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Matlab/"><span class="tag">Matlab</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PID%E9%97%AD%E7%8E%AF%E6%8E%A7%E5%88%B6/"><span class="tag">PID闭环控制</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/QQbot/"><span class="tag">QQbot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RANSAC/"><span class="tag">RANSAC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROS/"><span class="tag">ROS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Robotics-Transformer/"><span class="tag">Robotics Transformer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/R%E8%AF%AD%E8%A8%80/"><span class="tag">R语言</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/STM32/"><span class="tag">STM32</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Shewhart%E6%8E%A7%E5%88%B6%E5%9B%BE/"><span class="tag">Shewhart控制图</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unity/"><span class="tag">Unity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VLA/"><span class="tag">VLA</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XJH/"><span class="tag">XJH</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B9%98%E5%B9%82%E6%B3%95/"><span class="tag">乘幂法</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86%E7%B1%BB/"><span class="tag">二分类</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%A7%E5%93%81%E8%B4%A8%E9%87%8F%E7%AE%A1%E7%90%86/"><span class="tag">产品质量管理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%BA%E6%9C%BA%E4%BA%A4%E4%BA%92/"><span class="tag">人机交互</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BC%A0%E7%83%AD%E5%AD%A6/"><span class="tag">传热学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F/"><span class="tag">信号与系统</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/"><span class="tag">假设检验</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/"><span class="tag">傅里叶变换</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%89%E4%BC%8FMPPT/"><span class="tag">光伏MPPT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD/"><span class="tag">具身智能</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A8%E5%8A%9B%E5%AD%A6%E4%BB%BF%E7%9C%9F/"><span class="tag">动力学仿真</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="tag">动手学深度学习</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/"><span class="tag">单片机</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><span class="tag">卷积神经网络</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8C%E4%B8%89%E6%AC%A1%E6%8F%92%E5%80%BC/"><span class="tag">双三次插值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8C%E7%BA%BF%E6%80%A7%E6%8F%92%E5%80%BC/"><span class="tag">双线性插值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/"><span class="tag">可视化</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%9B%E5%B9%B3%E9%9D%A2%E6%8F%92%E5%80%BC/"><span class="tag">四平面插值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E5%83%8F%E6%8F%92%E5%80%BC/"><span class="tag">图像插值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E5%83%8F%E6%94%BE%E5%A4%A7/"><span class="tag">图像放大</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E5%83%8F%E6%97%8B%E8%BD%AC/"><span class="tag">图像旋转</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB/"><span class="tag">图像识别</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%9A%E6%A8%A1%E6%80%81%E5%A4%A7%E6%A8%A1%E5%9E%8B/"><span class="tag">多模态大模型</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="tag">学习笔记</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9A%E9%87%8F%E5%88%86%E6%9E%90/"><span class="tag">定量分析</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%8F%E8%BD%A6/"><span class="tag">小车</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B7%A5%E7%A8%8B%E7%83%AD%E5%8A%9B%E5%AD%A6/"><span class="tag">工程热力学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BF%83%E7%94%B5%E4%BF%A1%E5%8F%B7%E9%87%87%E9%9B%86/"><span class="tag">心电信号采集</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BF%AB%E9%80%9F%E6%88%AA%E6%96%ADHuber%E6%8D%9F%E5%A4%B1/"><span class="tag">快速截断Huber损失</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%89%A9%E6%95%A3%E6%96%B9%E7%A8%8B/"><span class="tag">扩散方程</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/"><span class="tag">支持向量机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%91%E7%81%BE%E6%9C%BA%E5%99%A8%E4%BA%BA/"><span class="tag">救灾机器人</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%80%BC%E8%BF%AD%E4%BB%A3%E6%B1%82%E8%A7%A3/"><span class="tag">数值迭代求解</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"><span class="tag">数字信号处理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%88%86%E6%9E%90/"><span class="tag">数据处理分析</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E5%8F%91%E5%8A%A8%E6%9C%BA/"><span class="tag">斯特林发动机</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E5%BE%AA%E7%8E%AF/"><span class="tag">斯特林循环</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%80%E8%BF%91%E9%82%BB%E6%8F%92%E5%80%BC/"><span class="tag">最近邻插值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%89%E9%99%90%E5%85%83%E4%BB%BF%E7%9C%9F/"><span class="tag">有限元仿真</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%AC%E5%BE%81%E5%80%BC%E6%B1%82%E8%A7%A3/"><span class="tag">本征值求解</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="tag">机器学习</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%BA%E6%A2%B0%E8%87%82/"><span class="tag">机械臂</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%BA%E6%A2%B0%E8%AE%BE%E8%AE%A1/"><span class="tag">机械设计</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9F%94%E6%80%A7%E5%A5%97%E7%B4%A2%E6%83%A9%E7%BD%9A/"><span class="tag">柔性套索惩罚</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%BB%A4%E6%B3%A2%E5%99%A8/"><span class="tag">滤波器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%83%9F%E9%9B%BE%E6%89%A9%E6%95%A3/"><span class="tag">烟雾扩散</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E6%9C%BA%E6%8E%A7%E5%88%B6/"><span class="tag">电机控制</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC/"><span class="tag">矩阵特征值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="tag">算法与数据结构</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"><span class="tag">线性代数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%9F%E8%AE%A1%E8%BF%87%E7%A8%8B%E6%8E%A7%E5%88%B6/"><span class="tag">统计过程控制</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%87%AA%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86/"><span class="tag">自动控制原理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%87%AA%E5%8A%A8%E8%B0%83%E5%85%89/"><span class="tag">自动调光</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%87%AA%E7%BC%96%E7%A0%81%E5%99%A8/"><span class="tag">自编码器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%88%B9/"><span class="tag">船</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/"><span class="tag">计算机视觉</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%80%9D%E7%BB%B4/"><span class="tag">设计思维</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%9D%E7%A6%BB%E7%89%B9%E6%80%A7/"><span class="tag">距离特性</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/"><span class="tag">路径规划</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%97%AD%E7%8E%AF%E6%8E%A7%E5%88%B6/"><span class="tag">闭环控制</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/"><span class="tag">频谱分析</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%AB%98%E6%96%AF%E6%A0%B8%E5%87%BD%E6%95%B0/"><span class="tag">高斯核函数</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/title1.png" alt="Homepage of Jinghua Xu" height="28"></a><p class="is-size-7"><span>© 2025 Tim</span>&nbsp;&nbsp;Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>&nbsp;&amp;&nbsp;<a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© Copyright by Jinghua Xu</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Asgard-Tim"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer=""></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer=""></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer=""></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer=""></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer=""></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer=""></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer=""></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer=""></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer=""></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer=""></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer=""></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/chitose.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script>
    <link rel="stylesheet" href="https://ai.tianli0.top/static/public/postChatUser_summary.min.css">
    <script>
        let tianliGPT_key = 'S-TA3IX28M1ZT7TILW';
        let tianliGPT_postSelector = '#postchat_postcontent';
        let tianliGPT_Title = '文章摘要';
        let tianliGPT_postURL = '/^https?://[^/]+/[0-9]{4}/[0-9]{2}/[0-9]{2}/';
        let tianliGPT_blacklist = '';
        let tianliGPT_wordLimit = '1000';
        let tianliGPT_typingAnimate = true;
        let tianliGPT_theme = 'default';
        var postChatConfig = {
          backgroundColor: "#3e86f6",
          bottom: "16px",
          left: "16px",
          fill: "#FFFFFF",
          width: "44px",
          frameWidth: "375px",
          frameHeight: "600px",
          defaultInput: true,
          upLoadWeb: true,
          showInviteLink: true,
          userTitle: "PostChat",
          userDesc: "如果你对网站的内容有任何疑问，可以来问我哦～",
          addButton: true,
          beginningText: "这篇文章介绍了",
          userIcon: "https://ai.tianli0.top/static/img/PostChat.webp",
          userMode: "magic",
          defaultChatQuestions: ["你好","你是谁"],
          defaultSearchQuestions: ["视频压缩","设计"]
        };
    </script>
    <script data-postchat_key="S-TA3IX28M1ZT7TILW" src="https://ai.tianli0.top/static/public/postChatUser_summary.min.js"></script>
  </body></html>