<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="theme-color" content="#123456"><meta name="generator" content="Hexo 4.2.0"><title>XJH&#039;s Secret Base</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="XJH&#039;s Secret Base"><meta name="msapplication-TileImage" content="/img/logo.png"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="XJH&#039;s Secret Base"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="144x144" href="/img/logo.png"><meta name="description" content="XJH的秘密基地"><meta property="og:type" content="blog"><meta property="og:title" content="XJH&#039;s Secret Base"><meta property="og:url" content="http://asgard-tim.github.io/"><meta property="og:site_name" content="XJH&#039;s Secret Base"><meta property="og:description" content="XJH的秘密基地"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://asgard-tim.github.io/img/og_image.png"><meta property="article:author" content="明诚"><meta property="article:tag" content="XJH&#039;s blogs"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://asgard-tim.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://Asgard-Tim.github.io"},"headline":"XJH's Secret Base","image":["http://asgard-tim.github.io/img/og_image.png"],"author":{"@type":"Person","name":"明诚"},"publisher":{"@type":"Organization","name":"XJH's Secret Base","logo":{"@type":"ImageObject","url":"http://asgard-tim.github.io/img/title.png"}},"description":"XJH的秘密基地"}</script><link rel="icon" href="/img/logo.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/xt256.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/title.png" alt="XJH&#039;s Secret Base" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">时间轴</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com">GitHub</a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Asgard-Tim"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-28T07:54:58.000Z" title="2023/5/28 15:54:58">2023-05-28</time>发表</span><span class="level-item"><time dateTime="2023-08-03T09:23:21.357Z" title="2023/8/3 17:23:21">2023-08-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/About-XJH/">About XJH</a></span><span class="level-item">15 分钟读完 (大约2243个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/28/life/">生命是什么</a></p><div class="content"><p>看到一段很有趣的问答：“跨年的时候，烟花在想什么？”“我生如夏花之绚烂，死如秋叶之静美。”</p>
<p>谈到生命是什么、生命的意义这一类话题的时候，气氛总会没来由地变得郑重起来，总觉得这是一个很宏大的问题，我们穷尽一生可能也找不到答案。但我们仔细想想，即使是生命高等如人类，也逃不过生死的命运。于是“生命”的第一个要素就自然而然地出现了——生与死。如果把时间看作一条轴，每一个生命的过程都占据了其中的一段，那么生就意味着开端，而死自然意味着终结。而不管这段过程中发生了什么，生与死这两个概念始终都伴随着每一个生命，绽放后再慢慢走向凋零。但显然这样的描述不够准确，事实上绝大部分事物都有自己诞生与消逝的一刻，小到草木大至太阳都无一幸免。生命之所以是生命，正是因为他们有另一些特质，使得他们的生与死富有更多的意义。</p>
<p>我们不妨通过一些实例来加快我们思考的进度：在人们的固有印象中，石头不是生命，而参天大树是生命；水流不是生命，而凶禽猛兽是生命……在这样的枚举之中，我们不难发现，在我们的认知中，生命具有的另一个显著特征是，他们能够通过某种方式，从自己诞生的那一刻起，自发地从外界汲取资源，以维持自己的生存。乍一看这好像并无特别之处，但关键在“维持”二字。花草需要光合作用获取养分，猛兽需要捕食猎物获取食物，生命总需要依靠自己的能力获取些什么不断成长，这本身无可厚非。但我们不妨从另一面再次看待生命：花草如果一直生长在阴暗的环境与贫瘠的土壤中，获取不到足够的养分，会迅速枯萎而无法生长，甚至从一开始就无法萌芽；猛兽如果始终捕食不到足够的猎物，获取不到足够的营养，也会发育不良，饥饿至死。生命区别于其他事物的一大特征就在于，他们必须时刻依靠自己的能力从外界获取资源以维系自身生存，否则就会被环境淘汰而死去。石头在风化分崩离析之前依然是石头，太阳在聚变燃烧殆尽之前也依旧是太阳，他们不需要为了自己的生存去自发地做些什么，但生命需要。生命之所以是生命，即是因为他们必须时刻为了生存而奋斗，为了避免终结的那一刻过早地到来。</p>
<p>但仅仅将生命与其他的非生命体区分开来是远远不够的，尽管实际上具有以上两大特征的我们都可以称之为生命。如果我们再进入更深层的观察与思考，不难发现，其实对于大多数生命来说，假设没有其他因素的干扰且外界资源无限多，只需要通过能力维系生存这件事情本身并没有太大的难度，可这条假设显然并不成立。我们生活在同一个地球上，地球上的资源就这么多，太阳也总会有衰竭殆尽的那一天，作为生命的每一个个体也无时不刻不在彼此的交互中影响着各自的命运。在这样一个资源极其有限的混沌系统中，每一个生命个体都并非彼此割裂独立，这就导致了看似简单的维系生存事实上绝非易事。作为人类的我们，也是在经历了不断的进化以及社会演化发展后，才步入了如今衣食无忧的生活。但我们不妨回过头去观照我们的先辈，他们也曾经因寻找食物与安定的家园而四处奔波，时至今日仍然需要与随时可能发生的地震、台风、海啸等自然灾害作斗争。人类的生存维系远远没有我们日常生活中所遇到的那么简单，一些看似简单的行为也不过是长期进化而来的习以为常罢了。在人类发展的漫长历程中，我们始终与周遭的环境不断地做着一遍又一遍的斗争才从夹缝中觅得了如今的生存空间，在这个过程中，我们习惯把我们所抗争的事物称作“大自然”，也逐渐从与大自然斗争到从大自然索取再到如今的与大自然和谐共生。这个过程无疑是曲折而充满艰辛的，人类之所以伟大也正是因为我们在不断地运用自己的智慧克服无穷的艰难险阻，通过自己的努力为自己赢得更美好的明天。而事实上也不仅人类如此，无论是植物还是动物都在一代代的演化中无论是从脑力水平还是从生理结构功能上都在不断地适应着、改变着这个世界，用不懈的坚持为自己和族群赢得更长远的未来。正是因为这不对现实与自然力量屈服的毅力与勇气，生命才能称之为生命，而这样顽强不屈的抗争与奋斗精神以及不断向上成长迸发的精神活力，才是生命的魅力所在，也是生命的真正本质。因此，在我们的语言体系中，也将这样的精神本质赋予为“生命力”的体现。在与自然抗争的过程中，生命也在不断为适应环境而发生着一次又一次的进化，也因此生命与生命之间的差别越来越大，分化出了不同的种群，又在数千百年的发展中锻炼出了分工合作的可贵品格，产生了一定的社会性，这自然也是生命的一大特质，在彼此的交互之中生命才显得更有活力。</p>
<p>在分析完如上三个生命特质之后，我们不妨再回到“生与死”的概念上来，再结合后面两条，生命的另一层意义也呼之欲出。作为一个生命个体，我们自诞生以来，出于本能而不断为了自己的生存利用自己的智慧与生理能力不断拼搏奋斗，从外界环境中汲取养分，为的就是逃离那根随时可能到来的死亡之线，逃得越远越好。可似乎是命运冥冥之中已经注定，无论生命多么拼命的抗争，自然规律永远是我们无法逾越的天堑，就像光速永远是三乘十的八次方米每秒一样，我们终究会归于死亡。</p>
<p>可是，明知结局是无尽的死寂，太阳也会有熄灭的那一天，但所有的生命，都不约而同的选择在命运的洪流之中逆流而上，即使是本着“能多活一秒是一秒”的心态，也在不断地尽自己所能为自己和其他的生命赢得哪怕一丝生的希望。于是，生命才真正成为生命。</p>
<p>你无法阻止波涛汹涌，但你可以学会踏浪而行。</p>
<p>如果已经拼尽全力绚烂过，死亡又有何惧？</p>
<p>谁又知道死亡何尝不是又一次的新生？</p>
<p>生命要么是一场伟大的冒险，要么什么都不是。</p>
<p>生命的意义，就是即使知晓痛苦的结局，依然向着命运抗争。</p>
<p>生如远舟，向死而生。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-19T06:18:58.000Z" title="2023/5/19 14:18:58">2023-05-19</time>发表</span><span class="level-item"><time dateTime="2023-08-03T09:17:34.127Z" title="2023/8/3 17:17:34">2023-08-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a><span> / </span><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%AE%9A%E9%87%8F%E5%B7%A5%E7%A8%8B%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95I/">定量工程设计方法I</a></span><span class="level-item">1 小时读完 (大约12861个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/19/boat/">具有一定扶正能力的船舶设计</a></p><div class="content"><p>本项目定量分析部分Matlab代码已同步上传至Github,仓库链接：<a target="_blank" rel="noopener" href="https://github.com/Asgard-Tim/QEA-Boat">Asgard-Tim&#x2F;QEA-Boat: 重庆大学明月科创实验班定量工程设计方法课程项目 (github.com)</a></p>
<h4 id="一、项目介绍"><a href="#一、项目介绍" class="headerlink" title="一、项目介绍"></a>一、项目介绍</h4><hr>
<p>在该项目中，我们需要设计制造一艘小船，该小船需要满足以下条件：该艘船的倾覆角度须满足在120°至140°的范围之内，即在倾斜角度到达120°之前都能够回正，同时在超过140°之后不再具有扶正的能力；此外，船体具备一定的载重能力（两罐听装可乐），不会沉没或者有太大（平衡位置甲板与水面夹角超过10°的倾斜）。为了达到以上的指标要求，我们将使用Matlab软件进行相应的定量分析设计，并以木板为材料进行加工制作。具体的呈现详见下文。</p>
<br>

<h4 id="二、第一性原理分析"><a href="#二、第一性原理分析" class="headerlink" title="二、第一性原理分析"></a>二、第一性原理分析</h4><hr>
<p><img src="/images/boat/2-1.png" alt="1"></p>
<p><img src="/images/boat/2-2.png" alt="2"></p>
<p>在明确需要达成的指标之后，我们需要使用第一性原理对需要解决的问题进行回归、逐层拨开，回到基本的数学物理公式之中，以便进行较为精确的定量化设计。深入过程见上图。</p>
<br>

<h4 id="三、船体设计"><a href="#三、船体设计" class="headerlink" title="三、船体设计"></a>三、船体设计</h4><hr>
<h5 id="3-1设计方向"><a href="#3-1设计方向" class="headerlink" title="3.1设计方向"></a>3.1设计方向</h5><h6 id="3-1-1第一性原理的实现"><a href="#3-1-1第一性原理的实现" class="headerlink" title="3.1.1第一性原理的实现"></a>3.1.1第一性原理的实现</h6><p><strong>倾覆角度（120°~140°）实现：</strong></p>
<p>设计灵感来源于鱼漂（鱼漂主要分为漂尾、漂身、漂脚，三部分。漂脚大致分为碳脚、竹脚、钢脚等，漂脚的材质不同，自身的重量就不相同，漂脚越重整支鱼漂的重心就会偏下，使鱼漂入水后翻身站立的时间缩短，也就是我们常说的翻身快。）鱼漂的结构恰好可以很好地解决90°以上倾覆角回正的问题，即“头轻脚重”。通过为船体加装舰岛等提供浮力的模块以及合理调节船体各部分高度来进一步精确化满足倾覆角区间。</p>
<p><strong>载重能力（约700g）实现：</strong></p>
<p>除去船体本身的重量将实现700g左右的载重。船体设计将在船体舰岛中为所载货物预留空间，并且预留出排水体积（即预留最大吃水深度），以满足载重要求。</p>
<p><strong>稳定性实现：</strong></p>
<p>当船舶受到外力倾斜时，其重力的大小位置不发生变化，浮力的大小也不变，但浮力的中心位置会发生偏移。我们知道浮力作用的中心是水下体积的中心，当船舶倾斜时，水下体积形状发生改变，倾斜下沉一侧的水下体积会增加，此时浮力的作用中心会向倾斜的一侧移动，浮力和重力不在同一条直线上，他们形成的力矩和倾斜力矩相反，这就是船舶的复原力矩。只要船舶倾斜，船舶的复原力矩就必然出现，方向永远和船舶的倾斜方向相反，这就是船舶拥有稳性的原因。我们将船舶这种受到外力矩（如风浪等）的作用而发生倾斜，在外力矩消失后自行恢复到原来平衡位置的能力，称为船舶的稳性。</p>
<p>我们对船的剖面演示分析可以发现。当船发生倾斜时，浮心位置改变，我们将浮心所在的垂线于船体中心线交点称为稳心。当稳心在船舶的重心之上时，船舶可以回正。当稳心在重心之下，船舶就发生了倾覆。那么船舶横摇的角度达到多大的时候，我们的船会发生倾覆呢？我们分析研究稳性力臂随着船身倾斜角度变化的曲线。当稳心与重心等高时，也就是这条曲线由正变为负的时候，所对应的船身倾斜角度叫做稳性消失角。当船体的倾斜超过了这个角度，船就会翻。也就是说船舶倾斜在稳性消失角之前，稳心的位置比重心高，稳性力臂为正，复原力矩值也就为正，这时即使船体倾斜，也会回复到船舶原有的平衡位置。当船舶倾斜角度超过了这个稳性消失角，稳心位置就比重心低，稳性力臂比为负，复原力矩值也就为负数，那么这个时候就会发生翻船。这样就解释了船受到外力作用会在海中左右摇摆，随着外力的增加摇摆的更加激烈，船的横摇由于复原力矩的存在，能使其回正，但若超过了稳定消失角这个值，就会发生倾覆。</p>
<p>提高船体稳定性一是降低船体的重心来提高船舶的稳性。例如比赛帆船，通过加中竖龙骨的方法来降低它的重心，使其稳性消失角能够达到150度~170度的角度，接近于永不颠覆的船。另外，增加船宽也可以使船舶获得更高的稳性。例如对安全性要求较高的原油运输船，船体会比较宽，船型比较的矮胖。其他还有多种方式可以抵御船舶倾覆的风险。</p>
<p><strong>动力实现：</strong></p>
<p>动力大致分为驱动和电控两个模块，以及电池，螺旋桨的装配，选取适当控制模块来实现。</p>
<h6 id="3-1-2船体造型与其他功能的实现"><a href="#3-1-2船体造型与其他功能的实现" class="headerlink" title="3.1.2船体造型与其他功能的实现"></a>3.1.2船体造型与其他功能的实现</h6><p>本次项目设计船舶计划设计类似军舰外形的船体，并且达到船体轻巧，航速较快的目标，在此基础上可以实现节能，造价低廉的非硬性目标。</p>
<h5 id="3-2船体初步设计方案"><a href="#3-2船体初步设计方案" class="headerlink" title="3.2船体初步设计方案"></a>3.2船体初步设计方案</h5><p><img src="/images/boat/3-1.jpg" alt="3"></p>
<p>根据本次项目要求以及船型设计初衷（类军舰）采用了以上减小阻力的第一种设计类型，即通过收窄船体且前尖后宽的方式。</p>
<p>船头借鉴了05式两栖装甲突击车前减阻板的结构，并与上图传统船型结合的联合减租模型。</p>
<p><em><strong>关于中国05式两栖装甲突击车</strong></em></p>
<p>新型国产高速两栖突击车首先列装海军陆战队，已经成为海军利器。它不但能在摇摆的海上，精准摧毁敌方阵地工事，而且其强大的威力足以摧毁各型主战坦克。中国05式两栖突击车，操作简单，已没有离合器，具备浮渡精准射击能力。</p>
<p><strong>简介</strong></p>
<p>ZBD-05两栖步兵战车又被称为05式两栖步兵战车，是中华人民共和国研制的”<a target="_blank" rel="noopener" href="https://baike.so.com/doc/24591108-25466394.html">05式两栖装甲车族</a>“一员，装备<a target="_blank" rel="noopener" href="https://baike.so.com/doc/6712980-6927021.html">中国人民解放军海军陆战队</a>和陆军两栖机械化部队的滑水型高速两栖装甲车辆，部分言论称它与<a target="_blank" rel="noopener" href="https://baike.so.com/doc/5411251-5649352.html">美国海军陆战队</a>的”远征战斗车”(Expeditionary Fighting Vehicle, EFV)在概念上相似。</p>
<p><strong>评价</strong></p>
<p>该车外形新颖，车体前部的防浪板是带加强筋的，不但外形宽大而且具有液压伸直调节功能，可以根据海浪的高低和需要的航速自行调节其前倾角度，这就使得整个车体具有了滑行板的功能，在水中行驶时，通过滑行板将水的浮力和速度转化为上抬的力量，类似快艇一样，可以将整个车体短时抬离水面，降低阻力，提高速度。车体前后的防浪板再加上车体两侧打开的侧裙板，可以使得整个车体和水的接触面积大大增加，既增加了该型车在航渡中的稳定性和安全性，还能使得大口径武器如<a target="_blank" rel="noopener" href="https://baike.so.com/doc/5929834-6142759.html">轻型坦克</a>上的105mm火炮具有了在航渡过程中随时可以开火而不致翻沉。在正常陆战使用中，防浪板和后调节板收回车体，还能起到装甲防护的作用。</p>
<p><strong>总结</strong></p>
<p>05式两栖突击车独特巧妙的外形设计是它能快速机动的重要原因。车体前后部的防浪板外形宽大，能根据海浪的高低和需要的航速自行调节前倾角度。突击车在水中行驶时，防浪板将水的浮力转化为向上的力量，再配合车体两侧打开的侧裙板，将突击车短时抬离水面，从而大大降低阻力，提高速度。</p>
<p><img src="/images/boat/3-2jpg.jpg" alt="4"></p>
<p>舰岛部分以空心提供浮力为主，辅助来进行大角度回调。</p>
<p>驱动控制部分设计为电路模块，包括信号揭发部分，电动机控制部分；驱动模块包括电子调速器，电动机，螺旋桨模块以及锂电池。行进方式采用双桨无舵型，以两个推进器的差速法控制船体行进方向。</p>
<p><em>※具体实现以及其他细节后续介绍这里不再给出</em></p>
<br>

<h4 id="四、程序定量设计"><a href="#四、程序定量设计" class="headerlink" title="四、程序定量设计"></a>四、程序定量设计</h4><hr>
<h5 id="4-1-量化指标的数学物理分析"><a href="#4-1-量化指标的数学物理分析" class="headerlink" title="4.1 量化指标的数学物理分析"></a>4.1 量化指标的数学物理分析</h5><p>基于上述对实际问题的第一性原理分析后，我们不难得出，要使得负有一定载重的船体呈现出满足要求的扶正能力，关键在于对于船体稳定性的量化考察与计算。具体而言，我们可以通过重心、浮心、扶正力矩与稳性消失角等一系列量化参数对于船体的扶正能力进行进一步的定量描述，并根据定量分析结果调整船体设计使其具有相应的扶正能力。</p>
<h6 id="4-1-1-重心"><a href="#4-1-1-重心" class="headerlink" title="4.1.1 重心"></a>4.1.1 重心</h6><p>重心（Centroids）即为重力中心，本质上是物体在重力场中所受重力作用的等效作用点。在对于船体扶正能力的定量分析中，我们需要通过物体重心与浮心的位置关系判断扶正力矩的正负从而得到稳性消失角以衡量船体的扶正能力。</p>
<p>事实上，由于实验环境处于重力场相对均匀的地表，重心和质心(Center of Mass)在误差允许范围之内可视为重合，因此在定量计算时，我们实际上是将重心等效于质心，通过对于船体质量中心的计算间接得到重力中心的三维坐标。</p>
<p>在上述理论事实的支撑下，我们成功地将问题转化为“如何求取物体质量中心”。不可忽略的一点是，在实际定量计算中，对于物体质量中心的求取首先要将整个物体进行离散化处理，即将物体视作由许多质点组成的质点系，再对这些离散的点进行处理；同时，由于项目中的船体负有载重，离散化的质点系处理过程还便于额外添加船体外壳之外的其他额外质量点（如配重的质心等）。因此，控制物体离散化（本质上是从x,y,z三个方向进行微分）的精度是使得质心坐标结果更为精确的重要一环。在离散化的基础之上，对于N（该项目中N&#x3D;3）维空间中的质点系而言，在坐标系中有以下质量中心坐标计算公式：</p>
<p><img src="/images/boat/4-1.jpg" alt="5"></p>
<p>其中X表示某一坐标轴；mi表示物质系统中，某i质点的质量；xi表示物质系统中，某i质点的坐标。</p>
<p>而具体到本项目中所处的三维环境下，又有如下更为细化的公式：</p>
<p><img src="/images/boat/4-2.png" alt="6"></p>
<p>其中，x(y,z)为各坐标轴下质点分布的方程，ρ为船体材料的密度，dA为微分后每一小块的体积。</p>
<p>通过这一公式，就可以得出三维空间中物体离散化后的质点系的质量中心坐标。当离散化程度足够（微分步长足够小）时，在地表实验环境下，这一坐标同时也就是物体重心的坐标。</p>
<h6 id="4-1-2-浮心"><a href="#4-1-2-浮心" class="headerlink" title="4.1.2 浮心"></a>4.1.2 浮心</h6><p>浮心（Center of Buoyancy）是指浮体或潜体水下部分体积的形心，本质上是浮力的等效作用点。当浮体方位在铅直面内发生偏转时，其水下部分的体积虽保持不变，但其形状却发生变化，因而浮心的位置也相应的移动。在对于船体扶正能力的定量分析中，我们需要通过物体重心与浮心的位置关系判断扶正力矩的正负从而得到稳性消失角以衡量船体的扶正能力。</p>
<p>当物体放入流体中时，由于物体与流体的上下接触面受到流体的压强不等，上小下大，故会产生压强差，进而物体会受到流体竖直向上的压力，即受到流体的浮力。依据阿基米德定律，可得出物体受浮力大小为物体排开那部分流体所受到的重力。自然的，浮心的位置即为被排开流体部分的重心位置。若被排开流体的几何形状是规则的，那么浮心就在被排开的流体原先的几何中心。</p>
<p>事实上，在不同的倾斜角度情况下，物体在水下部分的形状都各不相同，因此随着倾斜角度的改变，浮心也在时刻发生着改变。而在某一固定倾斜角度时，对于浮心的求取本质上即为对于物体排开部分的水的重心求取。在上一节中我们详细阐述了如何计算物体的重心，只是在这里我们需要在不同的倾斜角度下分别求取水下部分的重心，具体计算原理完全一致，在此不过多赘述。但在浮心求取中涉及到的另一个问题是，应该如何确定船体水下部分的船体形状呢？在这里，我们引入水线的概念，即对于船体截面而言，水下部分与水上部分的分界线。上面提到，随着倾斜角度的改变，尽管排开水体部分的形状不尽相同，但提供的浮力大小一致，由阿基米德原理不难得出，即排开水的体积始终不变。因此，我们可以依据这条原理，得到各倾斜角度下水线的方程，与船体截面方程在水线之下的部分共同框定水下部分的形状，从而进行浮心的计算。</p>
<h6 id="4-1-3-扶正力臂（矩）与稳性消失角"><a href="#4-1-3-扶正力臂（矩）与稳性消失角" class="headerlink" title="4.1.3 扶正力臂（矩）与稳性消失角"></a>4.1.3 扶正力臂（矩）与稳性消失角</h6><p>船的稳性消失角(AVS)是角度θ，当船体的倾斜角度达到该角度后，船体就会倾覆而不再能够自动回倾。利用前两节给出的方法，我们可以得到船体的重心与浮心坐标，它们同时也是重力与浮力作用在船体上的等效作用点。而在这两个力的作用下，会对船体产生一个由重心与浮心之间的距离创建的力矩臂，浮力作用在该臂上以产生扭矩。随着倾斜角度的改变，扭矩的大小与正负也在不断改变，这里不妨规定船体扶正的力矩方向为正。在倾斜角度增大的过程中，力矩臂从正到负，而船体则在力矩臂由正转负的转折点时达到其AVS从而倾覆。当这一浮力产生的扭矩能够使得船体回到稳定平衡的原始位置时，它就是扶正力矩。为此，重心与浮心必须大致满足垂直对齐。如果这两个点稍微偏离对齐状态，则会产生一个扶正扭矩，将两个点推回到对齐状态。两点对齐的下一个可能角度是不稳定的平衡，这意味着如果稍微偏移，系统将无法恢复到其原始状态。当系统稍微偏离不稳定的平衡状态时，所产生的扭矩将改变角度，以使两点变得更加偏离对齐状态。</p>
<p>基于上述对于扶正力矩的定义阐述与分析，我们可以得出以下公式：</p>
<p><img src="/images/boat/4-3.png" alt="7"></p>
<p>式中的GZ为重力作用线与浮力作用线的垂直距离，称为扶正力臂；而MR则为扶正力矩。</p>
<p>扶正力矩与扶正力臂在受力分析图中的呈现如下图所示：</p>
<p><img src="/images/boat/4-4.png" alt="8"></p>
<p><img src="/images/boat/4-5.png" alt="9"></p>
<p>上述分析中提到，稳性消失角仅仅与扶正力矩由正转负的过程有关。通过对于上述式子的观察，不难发现，由于船体扶正或倾覆仅仅取决于扶正力矩的正负，而该计算式中扶正力矩的正负仅仅由扶正力臂的正负所决定，因此基于我们的分析需求，要得到稳性消失角以衡量扶正能力，只需要关注扶正力臂的正负而不关心具体的数值大小，事实上由公式可知扶正力矩只是在扶正力臂的基础上乘上了恒为正的系数（浮力大小）。于是，关键即在于对于坐标系中扶正力臂的求取。具体到坐标系中扶正力臂的计算公式会在后续Matlab程序仿真实现时详细推导与阐述，在此不详细展开。</p>
<p>对于不同的倾斜角度而言，由于淹没部分的形状不同导致浮心位置不同，扶正力臂的大小和正负自然也不同。因此，为了得到稳性消失角，我们可以通过绘制不同倾斜角度下的扶正力臂数值图像，从而得出图像零点处的倾斜角度（横坐标）即为稳性消失角（如下图)。</p>
<p><img src="/images/boat/4-6.png" alt="10"></p>
<h5 id="4-2船体模型构建与仿真模拟"><a href="#4-2船体模型构建与仿真模拟" class="headerlink" title="4.2船体模型构建与仿真模拟"></a>4.2船体模型构建与仿真模拟</h5><h6 id="4-2-1设计思路"><a href="#4-2-1设计思路" class="headerlink" title="4.2.1设计思路"></a>4.2.1设计思路</h6><p>基于以上数学物理分析，结合定量分析的需求，我们制定如下设计流程：</p>
<p>具体到实际的设计流程中，我们考虑到如下事实：当船底形状越平，该船的重心越低，船在载重的时候越不容易倾斜，船的平衡性更好。因此，我们基于以上原理，首先通过设计手绘图纸（见附件：切片.docx）的形式确定每一个切片（即船体沿长度方向的横截面）的轮廓形状，然后将切片以草图的形式在Fusion360建模软件中进行绘制，再对各切片草图进行放样操作即可得到船体外壳建模模型；在建模的草图绘制过程中，同时又在y(宽度)方向以一定步长进行采样，得到一系列离散坐标点，从而导入Matlab中进行进一步的仿真定量分析，最终得到符合要求的稳性消失角。</p>
<p><img src="/images/boat/4-7.png" alt="11"></p>
<h6 id="4-2-2基于Fusion-360软件实现船体建模"><a href="#4-2-2基于Fusion-360软件实现船体建模" class="headerlink" title="4.2.2基于Fusion 360软件实现船体建模"></a>4.2.2基于Fusion 360软件实现船体建模</h6><p>具体实现步骤如下：</p>
<ol>
<li>将绘制的切片曲线草图依次插入作为画布，并根据草图轮廓（适当修正）利用多点曲线拟合工具得到每一个切片的草图（如下图），各切片之间相隔特定的长度。</li>
<li>在绘制草图曲线的过程中，对于拟合后的放样曲线在宽度方向上以0.5cm为步长进行采样，结合各切片所在的长度坐标可得到船体的点云数据(详见附件our boat.xlsx)，以供后续Matlab仿真处理。</li>
<li>切换至曲面工具，对得到的每一个切片草图的曲线轮廓进行放样操作，得到船体模型大致的表面曲线；再修改选择使用曲面切线，使得曲线更加符合设计草图并更加自然流畅；最后进行封顶，完成船体外形的大致建构。</li>
</ol>
<p><img src="/images/boat/4-8.jpg" alt="12"></p>
<p><img src="/images/boat/4-9.jpg" alt="13"></p>
<p><img src="/images/boat/4-10.png" alt="14"></p>
<h6 id="4-2-3基于Matlab软件构造船体外壳曲面数学模型"><a href="#4-2-3基于Matlab软件构造船体外壳曲面数学模型" class="headerlink" title="4.2.3基于Matlab软件构造船体外壳曲面数学模型"></a>4.2.3基于Matlab软件构造船体外壳曲面数学模型</h6><p>通过上述利用Fusion360进行的建模过程，我们成功地将切片的草图实体化成了3D模型，并在这一过程中获得了点云数据坐标。接下来，我们将记录在excel表格中的x、y、z点云坐标分别导入Matlab中的mat文件并命名为“X.mat”、“Y.mat”和“Z.mat”存储下来。随后，通过load命令将三个数据文件导入Matlab中的工作区，并利用cftool指令使用曲线拟合器，分别选择X、Y、Z数据，通过多项式对点云数据进行拟合，效果如下图所示。（详情见文件”ourboat.sfit”）</p>
<p><img src="/images/boat/4-11.png" alt="15"></p>
<p>值得注意的是，在点云的获取过程中，我们以船体最下方的点在船体前端的投影作为坐标原点，以船体的长度方向作为x轴，由船头向船尾延伸；船体的宽度方向为y轴，以船的中轴线为分界线，沿x正方向看去左边y值为负，右边y值为正；船底到船顶为z轴正方向。</p>
<p>将所得到的拟合图与建构出的3D模型进行对比，除去比例尺的因素外，外壳形状基本一致，说明模型建构有效，数据与拟合函数可信度高，可以进行下一步仿真。在验证数据有效性的同时，我们也得到了拟合出的曲面函数（如图中右下“结果”框图所示），将其存于函数文件“calculate.m”中，便于后续仿真验证时进行调用。</p>
<p>除此之外，在仿真验证的程序中，我们在导入点集数据之外还需要对船体的各项参数进行定义，并给出微分步长，同时对已有的点集数据进行适当的处理使结果更加合理。</p>
<p>下面给出船体数学模型建立部分的Matlab实现代码：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%Step1:船体数学模型建立</span></span><br><span class="line"><span class="comment">%导入船体点集数据</span></span><br><span class="line">load(<span class="string">&#x27;X.mat&#x27;</span>);</span><br><span class="line">load(<span class="string">&#x27;Y.mat&#x27;</span>);</span><br><span class="line">load(<span class="string">&#x27;Z.mat&#x27;</span>);</span><br><span class="line"><span class="comment">%定义船体参数 单位：cm g</span></span><br><span class="line"><span class="comment">%以下参数都基于对于船体实物的测量给出</span></span><br><span class="line">boat.L =<span class="number">39.9</span>; <span class="comment">%长</span></span><br><span class="line">boat.W = <span class="number">17.4</span>; <span class="comment">%宽</span></span><br><span class="line">boat.HB = boat.W / <span class="number">2</span>; <span class="comment">%半宽</span></span><br><span class="line">boat.D = <span class="number">5.4</span>; <span class="comment">%深</span></span><br><span class="line">density_water = <span class="number">1</span>;    <span class="comment">% g / cm^3</span></span><br><span class="line">boat.mass = <span class="number">2000</span>; <span class="comment">%船体外壳总质量</span></span><br><span class="line"><span class="comment">%x为长，y为宽，z为深，做切片（微分）；切片数量为num</span></span><br><span class="line"><span class="comment">%dx,dy,dz即为三个方向的微分步长</span></span><br><span class="line">num=<span class="number">100</span>;</span><br><span class="line">dy = boat.W/num; </span><br><span class="line">dz = boat.D/num; </span><br><span class="line">dx = boat.L/num;</span><br><span class="line"><span class="comment">%构建船体外壳曲面模型</span></span><br><span class="line">mesh.xs = <span class="number">0</span>:dx:boat.L;</span><br><span class="line">mesh.ys = -boat.HB:dy:boat.HB; </span><br><span class="line">mesh.zs = <span class="number">0</span>:dz:boat.D;</span><br><span class="line">[mesh.ygrid,mesh.zgrid] = <span class="built_in">meshgrid</span>(mesh.ys,mesh.zs);</span><br><span class="line">[Xi,Yi]=<span class="built_in">meshgrid</span>(mesh.xs,mesh.ys);</span><br><span class="line">Zi=griddata(X,Y,Z, Xi,Yi);</span><br><span class="line"><span class="comment">%griddata:对二维或三维散点数据插值——增加有效数据量，减少误差</span></span><br><span class="line">surf(Xi,Yi,Zi);</span><br><span class="line">shading flat;</span><br><span class="line">axis(<span class="string">&#x27;equal&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>在这里，我们运用了griddata插值函数，对于取样的点云进行了进一步的补充，使得拟合的函数模型曲面更接近于实际情况。所得到的船体曲面模型如下图所示。</p>
<p><img src="/images/boat/4-12.png" alt="16"></p>
<p><img src="/images/boat/4-13.png" alt="17"></p>
<p>至此，我们成功地在Matlab中对我们设计的船体进行了数学函数的拟合，并通过对于函数图像的绘制模拟出船体的外壳模型，同时在程序中对于船体的点云数据以及宏观参数与微分步长都进行了导入与定义，为后续的仿真过程做好准备。</p>
<h6 id="4-2-4船体重心与浮心三维坐标计算及其Matlab实现"><a href="#4-2-4船体重心与浮心三维坐标计算及其Matlab实现" class="headerlink" title="4.2.4船体重心与浮心三维坐标计算及其Matlab实现"></a>4.2.4船体重心与浮心三维坐标计算及其Matlab实现</h6><p><strong>重心计算</strong>：在前面的原理分析部分，我们已经给出物体重心的详细计算方法。</p>
<p>下面给出了Matlab中的实现代码：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%Step2:计算船体重心的三维坐标:</span></span><br><span class="line">COM_x=<span class="number">0</span>;<span class="comment">%x轴上的重心</span></span><br><span class="line">COM_y=<span class="number">0</span>;<span class="comment">%y轴上的重心</span></span><br><span class="line">COM_z=<span class="number">0</span>;<span class="comment">%z轴上的重心</span></span><br><span class="line">tnt=<span class="number">0</span>;<span class="comment">%有效点个数</span></span><br><span class="line"><span class="built_in">i</span>=<span class="built_in">find</span>(<span class="built_in">isnan</span>(Zi));</span><br><span class="line">Zi(<span class="built_in">i</span>)=<span class="number">0</span>;<span class="comment">%去掉NaN点的影响</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:num</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:num</span><br><span class="line">            COM_x=COM_x+Xi(<span class="built_in">i</span>,<span class="built_in">j</span>);</span><br><span class="line">            COM_y=COM_y+Yi(<span class="built_in">i</span>,<span class="built_in">j</span>);        </span><br><span class="line">            COM_z=COM_z+Zi(<span class="built_in">i</span>,<span class="built_in">j</span>);</span><br><span class="line">            tnt=tnt+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">%加入除船壳外的结构，数据均通过实际测量得出</span></span><br><span class="line"><span class="comment">%可乐1</span></span><br><span class="line">m1=<span class="number">500</span>;</span><br><span class="line">boat.finalmass=boat.mass+m1;</span><br><span class="line">x1=<span class="number">10</span>;</span><br><span class="line">y1=<span class="number">0</span>;</span><br><span class="line">z1=<span class="number">1</span>;</span><br><span class="line"><span class="comment">%可乐2</span></span><br><span class="line">m2=<span class="number">500</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m2;</span><br><span class="line">x2=<span class="number">30</span>;</span><br><span class="line">y2=<span class="number">0</span>;</span><br><span class="line">z2=<span class="number">1</span>;</span><br><span class="line"><span class="comment">%桅杆</span></span><br><span class="line">m3=<span class="number">1000</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m3;</span><br><span class="line">x3=<span class="number">20</span>;</span><br><span class="line">y3=<span class="number">0</span>;</span><br><span class="line">z3=<span class="number">8</span>;</span><br><span class="line"><span class="comment">%最终的重心三维坐标：COM_x, COM_y, COM_z</span></span><br><span class="line">density=boat.mass/tnt;</span><br><span class="line">COM_x=(COM_x*density+m1*x1+m2*x2+m3*x3)/boat.finalmass;</span><br><span class="line">COM_y=(COM_y*density+m1*y1+m2*y2+m3*y3)/boat.finalmass;</span><br><span class="line">COM_z=(COM_z*density+m1*z1+m2*z2+m3*z3)/boat.finalmass;</span><br></pre></td></tr></table></figure>

<p>通过运行上述程序，我们可以得到我们设计的船在加上配重与桅杆后的最终重心坐标为：</p>
<p><img src="/images/boat/4-14.png" alt="18"></p>
<p><strong>各倾角下浮心计算</strong>：在原理分析部分我们提到，船体的浮心位置会随倾斜角度的改变而不断改变。结合我们在获取稳性消失角时的绘图需求，我们采用循环结构，对从0度到180的所有倾斜角度进行遍历，分别求出各角度下的浮心坐标。</p>
<p>以下是浮心三维坐标计算的Matlab实现代码：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%Step3:计算船体浮心三维坐标</span></span><br><span class="line"><span class="comment">%初始化：COB_x,COB_y,COB_z记录每个切片的浮心（2D）</span></span><br><span class="line">COB_x=[];</span><br><span class="line">COB_y=[];</span><br><span class="line">COB_z=[];</span><br><span class="line">MMass=[];<span class="comment">%每个浮心点的权重（质量）</span></span><br><span class="line">tot_mass=<span class="number">0</span>;<span class="comment">%总质量</span></span><br><span class="line">Y=[];</span><br><span class="line"><span class="comment">%遍历1-180度的所有theta值</span></span><br><span class="line"><span class="keyword">for</span> theta=<span class="number">1</span>:<span class="number">1</span>:<span class="number">180</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span> :num   <span class="comment">%对每个x积分</span></span><br><span class="line">        ZZ=[];<span class="comment">%记录该X下的Z轴坐标</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span> :num+<span class="number">1</span> <span class="comment">%讨论y从-boat.HB到boat.HB</span></span><br><span class="line">            t=calculate(<span class="built_in">i</span>*dx,mesh.ys(<span class="number">1</span>,<span class="built_in">j</span>));</span><br><span class="line">            ZZ=[ZZ t];</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        boat.hull = mesh.zgrid &gt; ZZ; <span class="comment">%在所计算的Z的值之上的就是船的截面</span></span><br><span class="line">        <span class="comment">%不同theta下的水线表示</span></span><br><span class="line">        <span class="comment">%确定重力浮力平衡以迭代调整水线</span></span><br><span class="line">        d =water_line(mesh,theta,boat,dx,dy,dz,num);<span class="comment">%寻找函数零点</span></span><br><span class="line">        y = mesh.ys;</span><br><span class="line">        z = -<span class="built_in">tand</span>(theta).*y+d;</span><br><span class="line">        <span class="keyword">if</span> theta&gt;<span class="number">90</span> &amp;&amp; theta&lt;=<span class="number">180</span></span><br><span class="line">            water = (mesh.zgrid-boat.D/<span class="number">2</span>) &lt; z;</span><br><span class="line">        <span class="keyword">elseif</span> theta&lt;=<span class="number">90</span> &amp;&amp; theta&gt;=<span class="number">0</span></span><br><span class="line">            water = (mesh.zgrid-boat.D/<span class="number">2</span>) &gt; z;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">%定义淹没区域</span></span><br><span class="line">        sub_region = <span class="built_in">flipud</span>(boat.hull)&amp;water;</span><br><span class="line"><span class="comment">%矩阵交集,求取排水体积;&amp;位与运算（都是1才得1）</span></span><br><span class="line">        <span class="comment">%计算船体浮心</span></span><br><span class="line">        COB = centerOfMass2(sub_region,mesh);</span><br><span class="line">        COB_z=[COB_z COB(<span class="number">1</span>,<span class="number">2</span>)];</span><br><span class="line">        COB_y=[COB_y COB(<span class="number">1</span>,<span class="number">1</span>)];</span><br><span class="line">        COB_x=[COB_x <span class="built_in">i</span>*dx];</span><br><span class="line">        MMass=[MMass matrixSum(sub_region)];</span><br><span class="line">        tot_mass=tot_mass+matrixSum(sub_region);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">%得出三维浮心坐标</span></span><br><span class="line">    ANS=centerOfMass3(COB_x,COB_y,COB_z,MMass,tot_mass,num);<span class="comment">%计算三维浮心</span></span><br><span class="line">    COB_x=ANS(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    COB_y=ANS(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    COB_z=ANS(<span class="number">1</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>从而我们可以得到不同倾斜角度theta下的浮心三维坐标。</p>
<p>在上述计算浮心的程序实现中，事实上我们是对于整个船体的浮心进行了整体的求取，具体而言是将船体沿x轴（长度）方向以一定步长微分为num（船体模型建构程序段中有给出定义，是微分的分数）份切片，每一片都分别求取重心的y-z坐标并最终沿x轴方向叠加得到整个船体的浮心。</p>
<p>具体到对于每一个切片的浮心求取，虽然实际情况中是船体在水中倾斜，但为了方便计算，我们不妨处理成船体不动而水线不断改变，当船体的倾斜角度为theta时，水线的斜率应为-tan(theta)；同时在计算时，基于浮力大小不变的原则，即船体淹没部分的体积不变，可以通过函数water_line进行迭代从而得到水线在船体切片的二维y-z坐标系的截距（在数据处理上对于迭代次数与精度进行限制以节约计算时间）。经过上述处理，我们可以得到各倾斜角度theta下各个切片平面中的水线方程。值得注意的是，这里为了使结果更加精确，我们将各点的x,y坐标重新带入了建构模型时所得到的calculate函数从而得到与实际更加接近的z值坐标，并以此来框定各个切片下的函数方程描述。在原理分析部分提到，在某一切片平面中，水线与水线之下的船体函数共同框定了水体淹没面积，对这一部分进行重心的求取即为切片的浮心。</p>
<p>下面给出water_line函数的代码实现：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">D_line</span> = <span class="title">water_line</span><span class="params">(mesh,theta,boat,dx,dy,dz,num)</span>   </span></span><br><span class="line">     number = <span class="number">1</span>;</span><br><span class="line">     <span class="built_in">i</span>=<span class="number">1</span>;</span><br><span class="line">     d = <span class="number">-0.02</span>;</span><br><span class="line">     d_gap = <span class="number">0.07</span>;</span><br><span class="line">     density_water = <span class="number">1000</span>; </span><br><span class="line"><span class="keyword">while</span> number&lt;<span class="number">100</span></span><br><span class="line">     y = mesh.ys;</span><br><span class="line">     z = -<span class="built_in">tand</span>(theta).*y+d;</span><br><span class="line">     <span class="keyword">if</span> theta&gt;<span class="number">90</span> &amp;&amp; theta&lt;=<span class="number">180</span></span><br><span class="line">        water = (mesh.zgrid-boat.D/<span class="number">2</span>) &lt; z;</span><br><span class="line">     <span class="keyword">elseif</span> theta&lt;=<span class="number">90</span> &amp;&amp; theta&gt;=<span class="number">0</span></span><br><span class="line">        water = (mesh.zgrid-boat.D/<span class="number">2</span>) &gt; z;</span><br><span class="line">     <span class="keyword">end</span>                      <span class="comment">%水线下的水体矩阵</span></span><br><span class="line"></span><br><span class="line">     sub_region = <span class="built_in">flipud</span>(boat.hull)&amp;water;   <span class="comment">%矩阵交集，求取排水体积</span></span><br><span class="line"></span><br><span class="line">    force=sub_region.*density_water*dz*dy*dx;    <span class="comment">%计算单个微分方块的力</span></span><br><span class="line">   </span><br><span class="line">    lift= matrixSum(force);                     <span class="comment">%整体浮力</span></span><br><span class="line">    up_force=lift-(boat.finalmass/num);                <span class="comment">%浮力剩余值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> up_force&lt;<span class="number">0</span>                           </span><br><span class="line">        d=d+d_gap/<span class="built_in">i</span>;                        </span><br><span class="line">    <span class="keyword">elseif</span> up_force&gt;<span class="number">0</span></span><br><span class="line">        d=d-d_gap/<span class="built_in">i</span>;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> up_force&gt;<span class="number">-0.01</span>&amp;&amp;up_force&lt;<span class="number">0.01</span>              <span class="comment">%判断阈值，水线收敛</span></span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">i</span>=<span class="built_in">i</span>*<span class="number">2</span>;                                      <span class="comment">%缩短步长</span></span><br><span class="line">    number=number+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">    D_line = d;</span><br><span class="line">    </span><br><span class="line">End</span><br></pre></td></tr></table></figure>

<p>此处同时展示部分功能函数：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">COM</span> = <span class="title">centerOfMass2</span><span class="params">(masses,mesh)</span></span></span><br><span class="line">    <span class="comment">% centerOfMass2: computes center of mass in 2D</span></span><br><span class="line">    <span class="comment">% masses: matrix of masses</span></span><br><span class="line">    <span class="comment">% mesh: structure containing ygrid and zgrid</span></span><br><span class="line">    <span class="comment">% returns: Vector [ycom,zcom]</span></span><br><span class="line">    M = matrixSum(masses);</span><br><span class="line">    ycom = matrixSum(masses .* mesh.ygrid) / M;</span><br><span class="line">    zcom = matrixSum(masses .* mesh.zgrid) / M;</span><br><span class="line">    COM = [ycom,zcom];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">plotMatrix</span><span class="params">(A,mesh,cmap)</span></span></span><br><span class="line">    <span class="comment">% plotMatrix: plots a matrix using image</span></span><br><span class="line">    <span class="comment">% A: matrix</span></span><br><span class="line">    <span class="comment">% mesh: srtruct containing ys and zs</span></span><br><span class="line">    <span class="comment">% cmap: Colormap</span></span><br><span class="line">    colormap(cmap);</span><br><span class="line">    image(mesh.ys,mesh.zs,<span class="built_in">flipud</span>(A),<span class="string">&#x27;AlphaData&#x27;</span>,<span class="number">0.5</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">M</span> = <span class="title">matrixSum</span><span class="params">(masses)</span></span></span><br><span class="line">    <span class="comment">% matrixSum: returns total of all elements in the matrix</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">% normally sum(m) computes the sums of the columns</span></span><br><span class="line">    <span class="comment">% selecting m(:) flattens the matrix and computes the sum of all elements</span></span><br><span class="line">    <span class="comment">% see https://stackoverflow.com/questions/1721987/what-are-the-ways-to-sum-matrix-elements-in-matlab</span></span><br><span class="line">    M = sum(masses(:));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ANS</span>=<span class="title">centerOfMass3</span><span class="params">(XMass,YMass,ZMass,MMass,m,num)</span></span></span><br><span class="line">x=<span class="number">0</span>;</span><br><span class="line">y=<span class="number">0</span>;</span><br><span class="line">z=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:num</span><br><span class="line">        x=x+XMass(<span class="number">1</span>,<span class="built_in">i</span>)*MMass(<span class="number">1</span>,<span class="built_in">i</span>)/m;</span><br><span class="line">        y=y+YMass(<span class="number">1</span>,<span class="built_in">i</span>)*MMass(<span class="number">1</span>,<span class="built_in">i</span>)/m;</span><br><span class="line">        z=z+ZMass(<span class="number">1</span>,<span class="built_in">i</span>)*MMass(<span class="number">1</span>,<span class="built_in">i</span>)/m;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    ANS=[x,y,z];</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h6 id="4-2-5-船体扶正力臂计算与图像绘制"><a href="#4-2-5-船体扶正力臂计算与图像绘制" class="headerlink" title="4.2.5 船体扶正力臂计算与图像绘制"></a>4.2.5 船体扶正力臂计算与图像绘制</h6><p><strong>扶正力臂计算原理与公式推导</strong>：</p>
<p>在原理分析部分中，我们给出了扶正力矩的定义与扶正力臂的图示，并揭示了只需要计算扶正力臂即可通过判断其正负来获得稳性消失角，但并没有给出具体在坐标系中的计算公式。在这里，将进行计算方法的推导并给出扶正力臂的计算公式。</p>
<p>在上述对于浮心坐标求取的代码实现阐述中，我们提出可以将水中船体的倾斜等效为以船体为参考系下水线的旋转。基于这样的分析思路，我们给出了如下左图所示的示意图，以对于扶正力臂的计算进行进一步的推导。</p>
<p><img src="/images/boat/4-15.jpg" alt="19"></p>
<p><img src="/images/boat/4-16.png" alt="20"></p>
<p>值得注意的是，尽管图中所表示的仅仅是船体的一个截面，但在实际情况中，若船体在无干扰情况下能稳定在水中平稳漂浮，船体重心与浮心的x坐标在误差允许范围内应可以视为一致，因此在仿真计算中，我们暂时忽略重心与浮心的x坐标而仅仅关心两者的位置关系及这一关系在y-z坐标上的体现。</p>
<p>基于这样的分析，结合上述图示，我们不难得出如上右图所示公式。</p>
<p>另外，所谓扶正力矩必然能够使得船体回正而非倾覆，这就要求力矩的方向应与倾斜角度theta增加的方向相反，因此我们不妨规定这一方向为正方向，在图中第二种情况中显示为船体向右（顺时针方向）倾斜，于是扶正力矩（臂）则以逆时针方向为正。基于这一原理，我们给出了如下方法以判定其正负性，这也是得到最终稳性消失角的关键一环。</p>
<p><img src="/images/boat/4-17.jpg" alt="21"></p>
<p>在完成了上述推导之后，即可根据推导分析结果设计Matlab程序实现仿真验证。</p>
<p>该部分的程序实现代码如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%Step4:求恢复力臂</span></span><br><span class="line">    k1 = -<span class="built_in">tand</span>(theta);</span><br><span class="line">    <span class="keyword">if</span> ((k1*COB_z+COB_y-COM_y)/k1)-COM_z&lt;<span class="number">0</span></span><br><span class="line">        flag1=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        flag1=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    l = flag1*<span class="built_in">abs</span>(COB_y+k1*COB_z-k1*COM_z-COM_y)/(k1^<span class="number">2</span>+<span class="number">1</span>)^<span class="number">0.5</span>;<span class="comment">%恢复力臂</span></span><br><span class="line">    Y=[Y,l];</span><br><span class="line"><span class="keyword">end</span>  </span><br></pre></td></tr></table></figure>

<p><strong>扶正力臂-倾斜角度图像绘制与稳性消失角</strong>：</p>
<p>在扶正力臂的求取部分，我们在不同的theta情况下用矩阵Y来存储各角度下的扶正力臂值，以便于绘制θ-l图像，从而根据观察图像得出稳性消失角。</p>
<p>以下为该部分代码实现：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%Step5:绘制扶正力臂曲线</span></span><br><span class="line">x=<span class="number">1</span>:<span class="number">1</span>:<span class="number">180</span>;</span><br><span class="line">x1=<span class="number">1</span>:<span class="number">1</span>:<span class="number">180</span>;</span><br><span class="line">y1=interp1(x,Y,x1,<span class="string">&#x27;spline&#x27;</span>);</span><br><span class="line"><span class="built_in">plot</span>(x1,y1);</span><br></pre></td></tr></table></figure>

<p><img src="/images/boat/4-18.png" alt="22"></p>
<p>最终得到的图像如下图所示。通过观察图像，可以得到我们的船体模型的稳性消失角大致在120-140度之间，满足稳定性要求。</p>
<h6 id="4-2-6误差分析"><a href="#4-2-6误差分析" class="headerlink" title="4.2.6误差分析"></a>4.2.6误差分析</h6><p><u>(1)采样点云、拟合曲线与实际船体模型的误差</u>：</p>
<p>由于采样的点云坐标是在对于手绘草图的建模刻画过程中进行读取的，与手绘出的供船体加工的切片草图仍然存在一定的差距，这会带来一定的误差；而在对于点云数据的插值与函数拟合过程中也存在着一定的误差。除此之外，载重的测量误差以及船体在实际加工建造时产生的误差也不可忽略。但由于缺乏一定的工具对于我们建造出的船体实体进行精确的测量与3D模型建构，在数据处理的过程中我们已经对于一些偏差较大的离散点数据进行了纠正或删除处理，使得最终的结果仍然在预期范围之内，并与实际情况相一致。</p>
<p><u>(2)Matlab仿真时微分步长不足够细分而引起的误差</u>：</p>
<p>在程序仿真设计过程中，我们对于船体从x、y、z三个方向按一定步长分割为若干份，并重点研究沿x轴方向进行切分的各切片以求得船体的重心与浮心坐标。但在实际程序实现的过程中，考虑到运算速度与准确度等多方面因素，各个方向进行分割的份数num不可能做到逼近于现实的无穷大，在上述程序中我们经过测试得到的一个较为合适的num值为100，这导致我们的仿真计算与实际的情况仍然存在一定的误差。但由于采样点的数量也较为有限，num的有限选取也不会对最终的结果造成致命的影响，仍然可以使得船体的稳性消失角最终呈现在可控的目标范围。</p>
<br>

<h4 id="五、初代船体制造与实现效果"><a href="#五、初代船体制造与实现效果" class="headerlink" title="五、初代船体制造与实现效果"></a><strong>五、</strong>初代船体制造与实现效果</h4><hr>
<h5 id="5-1船型外壳"><a href="#5-1船型外壳" class="headerlink" title="5.1船型外壳"></a><strong>5.1</strong>船型外壳</h5><h6 id="5-1-1结构设计实现"><a href="#5-1-1结构设计实现" class="headerlink" title="5.1.1结构设计实现"></a><strong>5.1.1</strong>结构设计实现</h6><p>为了减轻船体重量，采用了木制板材作为船体材料，通过骨架搭建，外层包裹来实现船模外壳的搭建，过程中主要用到了实木板，白乳胶等材料，加工过程使用绳锯，切割机，打磨机以及电钻等工具。</p>
<p>首先，我们根据最初的船体建模，对模型进行切片处理，以此来获得设计船的肋骨图纸和甲板图纸的必要参数，并根据设计出的肋骨图纸以及甲板图纸加工船体骨架，并进行拼装（详见下图）。</p>
<p><img src="/images/boat/4-19.jpg" alt="23"></p>
<p><img src="/images/boat/4-20.jpg" alt="24"></p>
<p><img src="/images/boat/4-21.jpg" alt="25"></p>
<p><img src="/images/boat/4-22.jpg" alt="26"></p>
<p><img src="/images/boat/4-23.jpg" alt="27"></p>
<p><img src="/images/boat/4-24.jpg" alt="28"></p>
<p><img src="/images/boat/4-25.jpg" alt="29"></p>
<p><img src="/images/boat/4-26.jpg" alt="30"></p>
<p><img src="/images/boat/4-27.jpg" alt="31"></p>
<p><img src="/images/boat/4-28.jpg" alt="32"></p>
<p><img src="/images/boat/4-29.jpg" alt="33"></p>
<p><img src="/images/boat/4-30.jpg" alt="34"></p>
<p>然后利用乳胶，热熔胶和木板，将船体外构型粘贴以达到塑性目的。</p>
<p><img src="/images/boat/4-31.jpg" alt="35"></p>
<h6 id="5-1-2舰岛设计"><a href="#5-1-2舰岛设计" class="headerlink" title="5.1.2舰岛设计"></a><strong>5.1.2</strong>舰岛设计</h6><p>同样利用模板拼接的方式，构筑舰岛模型。此设计中舰岛的上半部分与下半部分并未粘接，属于分体，用于装载货物使用。</p>
<p><img src="/images/boat/4-32.jpg" alt="36"></p>
<h5 id="5-2-动力装置"><a href="#5-2-动力装置" class="headerlink" title="5.2 动力装置"></a><strong>5.2</strong> 动力装置</h5><p><img src="/images/boat/4-33.jpg" alt="37"></p>
<p>电池：3.5V锂电池</p>
<p>130电机：3.5V 0.7W 双发推力约1.5N</p>
<p>电路板含有电机控制模块（MX1919H实现）与信号接收处理模块。此外设计了对水的感应电路，螺旋桨触水可以遥控发动，离水则发生断路不可发动</p>
<p>螺旋桨部分采用万向结构，这样来减弱偏移对传动的影响。</p>
<h5 id="5-3-防水设计"><a href="#5-3-防水设计" class="headerlink" title="5.3 防水设计"></a><strong>5.3</strong> 防水设计</h5><p>对于船体设计采用了报纸与乳胶混合贴合加固船体的方法，使船体表面硬化并做到初步防水，在彩绘之后涂刷丙烯酸透明防水胶达到更高水平的防水效果。</p>
<p>*<em>船舶防水涂料的应用止水胶防水施工技术。止水胶是一种单组分，无溶剂，遇水膨胀的聚氨酯类无定型膏体，在隧道二次初砌施工缝处设止水胶防水带，以及在钢筋，管线等周围设置止水胶，当接缝中有水渗入时，止水胶的弹性压缩应力和遇水膨胀压力双重作用填塞缝隙，可以有效的防止因接缝不密封出现的渗漏情况，具有较好的密封止水性能，能抗大的水压力。</em></p>
<p><img src="/images/boat/4-34.jpg" alt="38"></p>
<p>在舰岛可拆卸部分的设计中，我们采用了轮廓加橡塑胶带的方法，一方面使舱盖固定，另一方面填充缝隙达到防水的效果。</p>
<p><img src="/images/boat/4-35.jpg" alt="39"></p>
<h5 id="5-4-实现效果"><a href="#5-4-实现效果" class="headerlink" title="5.4 实现效果"></a><strong>5.4</strong> 实现效果</h5><p>在额外载重约700g时，“冲浪者号”吃水过深，并且行进速度大幅降低，全速只有约0.15m&#x2F;s，而且倾覆角度区间难以满足，于是我们对船体进行了进一步的改进与升级，以达到最初的设计要求。</p>
<br>

<h4 id="六、基于定量分析的迭代"><a href="#六、基于定量分析的迭代" class="headerlink" title="六、基于定量分析的迭代"></a><strong>六、基于定量分析的迭代</strong></h4><hr>
<h5 id="6-1-迭代方案思路"><a href="#6-1-迭代方案思路" class="headerlink" title="6.1 迭代方案思路"></a>6.1 迭代方案思路</h5><p>基于上述的实验效果并结合Matlab建模仿真的结果进行比照，尽管从船型设计上来讲我们所设计的初代船体外形已经达到了额定的稳性消失角要求，具有一定的扶正能力，但在实际的工程测试过程中我们发现，由于船型设计得过小，在装载上配重后整体的吃水深度较大导致船舶在水中航行的稳定性与扶正力矩相关指标的实际表现并不尽如人意；除此之外，在Matlab仿真过程中给出的除船体外壳外的离散质量点的坐标数据也较为模糊，对于稳性消失角模拟的结果造成了一定程度上的印象。通过以上的分析，我们初步设想在迭代过程中尽可能对船体进行再加工，通过延长船体长度的方式扩大相同吃水深度下排开水的体积以提供更大的浮力，从而控制船体满载情况下的吃水深度仍然在可控范围内；同时在仿真模拟的过程中增加对于电力驱动模块中的电机、电池等具有相当质量的组件的坐标导入与运算，并对于各离散质量点的坐标进行精细化处理使其更接近于实际情况，以提高仿真模拟的准确度与有效性。</p>
<h5 id="6-2-迭代方案的定量分析"><a href="#6-2-迭代方案的定量分析" class="headerlink" title="6.2 迭代方案的定量分析"></a>6.2 迭代方案的定量分析</h5><h6 id="6-2-1-船体外形的修正"><a href="#6-2-1-船体外形的修正" class="headerlink" title="6.2.1 船体外形的修正"></a>6.2.1 船体外形的修正</h6><p>基于上述的分析结果与初步迭代思路，我们初步定下了延长船体长度的再加工方案，结合对于已有船体的加工现状分析与船体的稳定性考虑，最终决定将船体长度延长至74cm。以下代码给出了对于重新设计的船体的基本参数的定义与设置：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%定义船体参数 单位：cm g</span></span><br><span class="line"><span class="comment">%以下参数都基于对于船体实物的测量给出</span></span><br><span class="line">boat.L = <span class="number">74</span>; <span class="comment">%长</span></span><br><span class="line">boat.W = <span class="number">16.5</span>; <span class="comment">%宽</span></span><br><span class="line">boat.HB = boat.W / <span class="number">2</span>; <span class="comment">%半宽</span></span><br><span class="line">boat.D = <span class="number">7</span>; <span class="comment">%深</span></span><br><span class="line">density_water = <span class="number">1</span>;    <span class="comment">% g / cm^3</span></span><br><span class="line">boat.mass = <span class="number">653.8</span>; <span class="comment">%船体外壳总质量</span></span><br></pre></td></tr></table></figure>

<p>除了船体的宏观参数调整之外，相应的，我们还需要在原有的点集数据基础之上对于延长后的部分进行数据的补充，并将新的点云数据集存储在Matlab文件中，再利用cftool曲线拟合器工具获得新的拟合函数表达式并导入函数文件calculate.m中以在后续的仿真模拟中重复调用。下图展示了新点云数据集所拟合出的函数曲面图像以及对应拟合函数的表达式：</p>
<p><img src="/images/boat/6-1.png" alt="40"></p>
<p>在仿真验证的程序中，我们在导入新的点云数据后，为了进一步验证数学模型建构的准确性，仍然需要通过插值函数griddata补充数据并绘制函数曲面图像与fusion 360建模结果进行一定的比对，效果图如下:</p>
<p><img src="/images/boat/6-2.png" alt="41"></p>
<p><img src="/images/boat/6-3.png" alt="42"></p>
<h6 id="6-2-2-离散数量点数据的校准与补充"><a href="#6-2-2-离散数量点数据的校准与补充" class="headerlink" title="6.2.2 离散数量点数据的校准与补充"></a>6.2.2 离散数量点数据的校准与补充</h6><p>在第一代船的仿真模拟数据中，我们在船体外壳的点云数据之外仅补充了配重与桅杆两部分的质心坐标数据及其质量，而忽略了电控模块其余组件的相关数据，且显然由于电控模块中电池与电机的重量相对于船体整体重量来说并不可忽略不计，所以在本次迭代过程中，在Matlab仿真程序的代码实现中对于这一部分进行了补充，同时对于船体中各零散组件的质心坐标及其质量进行了相对精准的测量与估算，从而提高仿真模拟的准确度，使其更加贴近实际情况。补充调整后船体内的离散质量点的相关数据如下列程序段所示：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%加入除船壳外的结构</span></span><br><span class="line"><span class="comment">%可乐1</span></span><br><span class="line">m1=<span class="number">356</span>;</span><br><span class="line">boat.finalmass=boat.mass+m1;</span><br><span class="line">x1=<span class="number">34</span>;</span><br><span class="line">y1=<span class="number">0</span>;</span><br><span class="line">z1=<span class="number">9.8</span>;</span><br><span class="line"><span class="comment">%可乐2</span></span><br><span class="line">m2=<span class="number">356</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m2;</span><br><span class="line">x2=<span class="number">44</span>;</span><br><span class="line">y2=<span class="number">0</span>;</span><br><span class="line">z2=<span class="number">9.5</span>;</span><br><span class="line"><span class="comment">%桅杆</span></span><br><span class="line">m3=<span class="number">116</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m3;</span><br><span class="line">x3=<span class="number">39</span>;</span><br><span class="line">y3=<span class="number">0</span>;</span><br><span class="line">z3=<span class="number">49.5</span>;</span><br><span class="line"><span class="comment">%上层外壳</span></span><br><span class="line">m4=<span class="number">116.1</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m4;</span><br><span class="line">x4=<span class="number">0</span>;</span><br><span class="line">y4=<span class="number">39</span>;</span><br><span class="line">z4=<span class="number">12.5</span>;</span><br><span class="line"><span class="comment">%尾部甲板</span></span><br><span class="line">m5=<span class="number">49.4</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m5;</span><br><span class="line">x5=<span class="number">64.5</span>;</span><br><span class="line">y5=<span class="number">0</span>;</span><br><span class="line">z5=<span class="number">6.2</span>;</span><br><span class="line"><span class="comment">%电池</span></span><br><span class="line">m6=<span class="number">185.1</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m6;</span><br><span class="line">x6=<span class="number">12</span>;</span><br><span class="line">y6=<span class="number">0</span>;</span><br><span class="line">z6=<span class="number">5.5</span>;</span><br><span class="line"><span class="comment">%电机1</span></span><br><span class="line">m7=<span class="number">190.4</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m7;</span><br><span class="line">x7=<span class="number">53</span>;</span><br><span class="line">y7=<span class="number">4</span>;</span><br><span class="line">z7=<span class="number">3</span>;</span><br><span class="line"><span class="comment">%电机2</span></span><br><span class="line">m8=<span class="number">191.6</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m8;</span><br><span class="line">x8=<span class="number">53</span>;</span><br><span class="line">y8=<span class="number">-4</span>;</span><br><span class="line">z8=<span class="number">3</span>;</span><br><span class="line"><span class="comment">%电调1</span></span><br><span class="line">m9=<span class="number">49.4</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m9;</span><br><span class="line">x9=<span class="number">20.5</span>;</span><br><span class="line">y9=<span class="number">6</span>;</span><br><span class="line">z9=<span class="number">7</span>;</span><br><span class="line"><span class="comment">%电调2</span></span><br><span class="line">m10=<span class="number">49.6</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m10;</span><br><span class="line">x10=<span class="number">20.5</span>;</span><br><span class="line">y10=<span class="number">-6</span>;</span><br><span class="line">z10=<span class="number">7</span>;</span><br><span class="line"><span class="comment">%船桨1</span></span><br><span class="line">m11=<span class="number">43.5</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m11;</span><br><span class="line">x11=<span class="number">73.5</span>;</span><br><span class="line">y11=<span class="number">3.8</span>;</span><br><span class="line">z11=<span class="number">1</span>;</span><br><span class="line"><span class="comment">%船桨2</span></span><br><span class="line">m12=<span class="number">40.3</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m12;</span><br><span class="line">x12=<span class="number">73.5</span>;</span><br><span class="line">y12=<span class="number">-3.8</span>;</span><br><span class="line">z12=<span class="number">1</span>;</span><br><span class="line"><span class="comment">%前端甲板</span></span><br><span class="line">m13=<span class="number">18.2</span>;</span><br><span class="line">boat.finalmass=boat.finalmass+m13;</span><br><span class="line">x13=<span class="number">20.5</span>;</span><br><span class="line">y13=<span class="number">0</span>;</span><br><span class="line">z13=<span class="number">6.3</span>;</span><br><span class="line"><span class="comment">%最终的重心三维坐标</span></span><br><span class="line">density=boat.mass/tnt;</span><br><span class="line">COM_x=(COM_x*density+m1*x1+m2*x2+m3*x3+m4*x4+m5*x5+m6*x6+m7*x7+m8*x8+m9*x9+m10*x10+m11*x11+m12*x12+m13*x13)/boat.finalmass;</span><br><span class="line">COM_y=(COM_y*density+m1*y1+m2*y2+m3*y3+m4*y4+m5*y5+m6*y6+m7*y7+m8*y8+m9*y9+m10*y10+m11*y11+m12*y12+m13*y13)/boat.finalmass;</span><br><span class="line">COM_z=(COM_z*density+m1*z1+m2*z2+m3*z3+m4*z4+m5*z5+m6*z6+m7*z7+m8*z8+m9*z9+m10*z10+m11*z11+m12*z12+m13*z13)/boat.finalmass;</span><br></pre></td></tr></table></figure>

<p>在获得了更加精准的离散质量点的相关数据后，我们可以利用上述程序段的最后部分来计算整个船体在装载了配重与电力驱动模块后的重心在x、y、z轴上的坐标，结果如下图所示：</p>
<p><img src="/images/boat/6-4.png" alt="43"></p>
<h6 id="6-2-3-稳性消失角的最终呈现"><a href="#6-2-3-稳性消失角的最终呈现" class="headerlink" title="6.2.3 稳性消失角的最终呈现"></a>6.2.3 稳性消失角的最终呈现</h6><p>经过上述结合实际情况后对于点云与离散质量点的数据补充与完善，我们将新的数据导入Matlab程序并再次运行，最终得到了如下图所示的l-θ图像以反映船体倾斜角度与扶正力臂之间的函数关系：</p>
<p><img src="/images/boat/6-5.png" alt="44"></p>
<p>该图也成功体现了改进后的船型设计仍然能够使得稳性消失角维持在120-140度之间，能够满足对于船体稳定性与扶正能力的相关要求，可以进行下一步的迭代加工操作。</p>
<br>

<h4 id="七、迭代产品制造过程与实现效果"><a href="#七、迭代产品制造过程与实现效果" class="headerlink" title="七、迭代产品制造过程与实现效果"></a>七、迭代产品制造过程与实现效果</h4><hr>
<h5 id="7-1-迭代产品制造"><a href="#7-1-迭代产品制造" class="headerlink" title="7.1 迭代产品制造"></a><strong>7.1</strong> <strong>迭代产品制造</strong></h5><h6 id="7-1-1-船体再制造"><a href="#7-1-1-船体再制造" class="headerlink" title="7.1.1 船体再制造"></a><strong>7.1.1</strong> 船体再制造</h6><p>为解决原有船体载重后吃水过深的问题，第二代的“刃海级”加长了“冲浪者号”船体长度，本次船体长度在制造前进行了较为周密的运算（各模块重量数据见程序部分），通过对各模块质量的初步掌握，以及配重块和所载重物的估计重量，结合原船型截面面积，计算出额在不改变原有船模外形的前提下，所需加长船身的长度以及大致的吃水情况(船体加长至74cm，空载预估吃水2.87cm，满载预估吃水4.56cm，后经实验实际情况与估计值差距不超过10%)</p>
<p><img src="/images/boat/7-1.jpg" alt="45"></p>
<h6 id="7-1-2-电控系统改进"><a href="#7-1-2-电控系统改进" class="headerlink" title="7.1.2 电控系统改进"></a><strong>7.1.2</strong> 电控系统改进</h6><p>由于船体整体加大增重以及为解决之前动力不足的问题，更换了另外一套控制系统（功率更大的电机，螺旋桨，电池，电子调速器以及信号接收发遥控系统），改进后的推力更强，满足了设计要求中对动力的需求。</p>
<p><img src="/images/boat/7-2.png" alt="46 螺旋桨与电调"></p>
<p>电机参数情况：</p>
<p><img src="/images/boat/7-3.png" alt="47"></p>
<p><img src="/images/boat/7-4.png" alt="48"></p>
<p><img src="/images/boat/7-5.png" alt="49"></p>
<p><img src="/images/boat/7-6.png" alt="50"></p>
<p><img src="/images/boat/7-7.png" alt="51 电池参数"></p>
<p>实际安装情况：</p>
<p><img src="/images/boat/7-8.png" alt="52 电机及螺旋桨安装"></p>
<p><img src="/images/boat/7-9.png" alt="53 电池及电调安装"></p>
<h6 id="7-1-3-驱动优化以及节能设计"><a href="#7-1-3-驱动优化以及节能设计" class="headerlink" title="7.1.3 驱动优化以及节能设计"></a><strong>7.1.3</strong> 驱动优化以及节能设计</h6><p>在更换大功率电机之后，电机发热明显增加，为了提高船舶的安全性，可靠性，在迭代过程中，加入了水冷却系统。除此之外为了合理利用船体空间并节约一定能源，在船舶顶部加装了与冷却系统相连的供电装置。</p>
<p><img src="/images/boat/7-10.png" alt="54 电动机水冷系统与船舶后外置水泵"></p>
<p><img src="/images/boat/7-11.png" alt="55 电动机水冷系统与船舶后外置水泵"></p>
<p>太阳能板与内置电池串联，同时并联水泵与控制板，达到水冷与控制喷水的效果。</p>
<p><img src="/images/boat/7-12.png" alt="56 太阳能板"></p>
<p>额定发电电压：6V</p>
<p>发电最大：150mA</p>
<p>尺寸：60mm*110mm</p>
<h5 id="7-2-迭代产品实现效果"><a href="#7-2-迭代产品实现效果" class="headerlink" title="7.2 迭代产品实现效果"></a><strong>7.2</strong> <strong>迭代产品实现效果</strong></h5><h6 id="7-2-1-实验效果"><a href="#7-2-1-实验效果" class="headerlink" title="7.2.1 实验效果"></a><strong>7.2.1</strong> 实验效果</h6><p><img src="/images/boat/7-13.jpg" alt="57 正常行驶"></p>
<p>空载条件下，倾覆角150°</p>
<p>载有饮料的条件下倾覆角大约为130°</p>
<h6 id="7-2-2-微调满足设计要求"><a href="#7-2-2-微调满足设计要求" class="headerlink" title="7.2.2 微调满足设计要求"></a><strong>7.2.2</strong> 微调满足设计要求</h6><p>船舶下水后未调整前倾覆角明显大于140°，于是在船体舰岛舱内加装配重块（仓顶左右两侧各25g），空载倾覆角135°左右，满载倾覆角125°左右。</p>
<br>

<h4 id="八、最终成品与总结"><a href="#八、最终成品与总结" class="headerlink" title="八、最终成品与总结"></a>八、最终成品与总结</h4><hr>
<h5 id="8-1-“刃海级”"><a href="#8-1-“刃海级”" class="headerlink" title="8.1 “刃海级”"></a><strong>8.1</strong> <strong>“刃海级”</strong></h5><p><img src="/images/boat/8-1.jpg" alt="58 成品实物图片"></p>
<p><img src="/images/boat/8-2.jpg" alt="59 成品实物图片"></p>
<p><img src="/images/boat/8-3.jpg" alt="60 成品实物图片"></p>
<h5 id="8-2-项目总结与感悟"><a href="#8-2-项目总结与感悟" class="headerlink" title="8.2 项目总结与感悟"></a><strong>8.2</strong> 项目总结与感悟</h5><p>本次项目历经两次迭代，最后基本实现了项目设计要求，产品还存在需要改进的地方。第一代“冲浪者号”设计中在定量化设计步骤中有疏忽掉配重块的问题，帮助我们发现了我们定量化设计方法的问题所在，总结了第一代的经验之后第二代“刃海级”较为成功地实现了项目设计地要求。</p>
<p>产品的研发设计离不开严格的定量化分析，更离不开多次地迭代更新，在这个过程中我们可以不断学习用到的相关知识，包括电路，控制，材料，结构，力学，软件等等一系列的相关知识，给了我们更开阔的眼界，也锻炼了我们的能力和意志。最重要的是教会了我们定量化分析的思想，为以后项目及产品的开发提供了极大的帮助！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-01T16:55:59.000Z" title="2023/5/2 00:55:59">2023-05-02</time>发表</span><span class="level-item"><time dateTime="2023-08-03T09:19:43.720Z" title="2023/8/3 17:19:43">2023-08-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a><span> / </span><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/">软件设计</a></span><span class="level-item">1 小时读完 (大约6812个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/02/vendition/">进销存管理系统</a></p><div class="content"><p>本项目全部代码已同步上传至Github,仓库链接：<a target="_blank" rel="noopener" href="https://github.com/Asgard-Tim/Vendition">Asgard-Tim&#x2F;Vendition: 重庆大学明月科创实验班软件设计课程作业 (github.com)</a></p>
<h4 id="一、需求分析"><a href="#一、需求分析" class="headerlink" title="一、需求分析"></a>一、需求分析</h4><hr>
<h5 id="1-1-进销存管理业务概述"><a href="#1-1-进销存管理业务概述" class="headerlink" title="1.1 进销存管理业务概述"></a>1.1 进销存管理业务概述</h5><p>随着近年来世界各方面的发展进步和物联网时代的到来及其不断发展，货物销售行业发生了翻天覆地的巨大变革，随着从卖方市场向买方市场的转变，我国的零售行业迅速崛起，并且时时刻刻面临着日益激烈并不断变化的竞争环境。因此，提高进销存管理水平，探索降低成本的方法成为提高企业竞争力的必然选择[1]。</p>
<p>伴随着企业规模的不断扩大和企业效益的进一步发展，原先的管理已经不能跟上企业的发展步伐，更无法满足企业对管理工作快速、准确的要求。在销售业务不断增长的同时，公司日常所需要处理的数据量不断增长，公司内部运转周转的中间传递环节也逐渐增多，进而发展到非常的复杂的经营管理模式，同时，现在复杂多变的市场，人工管理等传统的方法方式在相关方面已无法应对。更为重要的是商品的进销存方面缺乏实时处理的相关分析，管理人员对及时传递资料和命令的需求得无法实现。最后发现如果能够在面对不同种类的货物信息时，能够让管理人员实时掌握销售流程及销售情况，进而支持管理人员对相关商品销售的运营并且可以有效地加速的周转率，从而可以进一步提高行业的服务质量。这时可以组建一个记录、更新、保存数据信息的数据库以建立和支持一个合理高效的软件项目[2]。</p>
<p>具体而言，进销存管理业务的核心是对于商品流动信息的储存与管理，主要涉及到商品品类的新增与删除、进货、商品销售与盘点、平库等相互关联的诸多业务流程。因此，在进销存管理系统中，我们需要让这些业务流程在系统中有所体现，从而达到高效管理的目的。</p>
<h5 id="1-2-功能性需求"><a href="#1-2-功能性需求" class="headerlink" title="1.2 功能性需求"></a>1.2 功能性需求</h5><h6 id="1-2-1-商品信息管理"><a href="#1-2-1-商品信息管理" class="headerlink" title="1.2.1 商品信息管理"></a>1.2.1 商品信息管理</h6><p>在进销存管理系统中，需要提供渠道给操作管理人员以录入或删除商品信息，同时对于日常的进货与销售过程予以记录，并在需要的时候对库存中已有的商品种类与数量进行盘点，必要时还需要进行平库操作。这些流程会涉及到公司内的诸多部门，诸如采购部、市场部、财务部等，组织架构的复杂性也对软件系统设计的联动能力与处理效率提出了较高的要求。因此，我们不仅需要通过程序设计实现与实际操作对应的相关功能，对于操作人员在系统中输入的文本信息进行读取与必要的处理以模拟上述诸多对于商品实体的实际操作流程，同时还需要建立与实际仓库所对应的商品的数据库，通过对于所有商品的编号、名称、单价、库存数量与计量单位等具体信息进行存储，并在管理人员进行操作的过程中对库中存储的商品信息进行与实际情况同步的改动，实现更加高效的管理。</p>
<h6 id="1-2-2-系统安全"><a href="#1-2-2-系统安全" class="headerlink" title="1.2.2 系统安全"></a>1.2.2 系统安全</h6><p>对于公司而言，系统的安全性是软件系统设计过程中一个至关重要的考虑因素，由于系统缺乏维护管理与必要的保护措施所造成的损失与影响将是不可估量且难以弥补的。在进销存管理系统中，系统安全的问题主要可能出现在操作权限与非法输入等方面。基于这样的考虑，软件系统在处理数据时，需要对于非法的输入进行区分并给予用户一定的操作提示；在功能上，需要通过账户密码匹配的机制以对于操作人员的权限进行一定的限制从而保证系统的安全性；在存储数据时，应对于存入的数据在写入文件的同时进行一定的加密操作，防止外部人员盗取或进行修改；同时在用户进行操作时，需要同步保留用户的操作记录，在必要时以供核查。</p>
<h5 id="1-3-非功能性需求"><a href="#1-3-非功能性需求" class="headerlink" title="1.3 非功能性需求"></a>1.3 非功能性需求</h5><h6 id="1-3-1-性能需求"><a href="#1-3-1-性能需求" class="headerlink" title="1.3.1 性能需求"></a>1.3.1 性能需求</h6><p>   1.系统必须具备高可用性，能够保证系统长时间连续运行的需求；</p>
<p>​    2.系统的响应时间应尽可能的短，系统登陆、信息保存等操作响应时间小于1.5秒，信息查询等复杂操作时间小于2秒；</p>
<p>​    3.数据库容量要大，能够满足商品采购、销售、库存管理等详细信息长时间保存的需求；</p>
<p>​    4.可供多个用户分时使用该系统平台。</p>
<h6 id="1-3-2-易用性需求"><a href="#1-3-2-易用性需求" class="headerlink" title="1.3.2 易用性需求"></a>1.3.2 易用性需求</h6><p>   1.系统的相关提示信息一致，如进货、销售、删除、查询等操作功能，应尽可能使人容易理解；</p>
<p>​    2.有明确的输入限制提示信息；</p>
<p>​    3.中英文对应正确。</p>
<h6 id="1-3-3-可扩展性需求"><a href="#1-3-3-可扩展性需求" class="headerlink" title="1.3.3 可扩展性需求"></a>1.3.3 可扩展性需求</h6><p>   在系统底层设计时，需要强化系统的配置和扩展能力，主要体现在以下方面：</p>
<p>​    1.系统底层支持的可扩展性；</p>
<p>​    2.系统数据结构可搭建；</p>
<p>​    3.系统信息展示的可配置性。</p>
<br>

<h4 id="二、系统设计"><a href="#二、系统设计" class="headerlink" title="二、系统设计"></a>二、系统设计</h4><hr>
<h5 id="2-1-系统开发方案"><a href="#2-1-系统开发方案" class="headerlink" title="2.1 系统开发方案"></a>2.1 系统开发方案</h5><p>进销存系统需要在简单快速，并且容易维护的、安全性强的开发环境中进行设计[3]。</p>
<h6 id="2-1-1-系统开发技术"><a href="#2-1-1-系统开发技术" class="headerlink" title="2.1.1 系统开发技术"></a>2.1.1 系统开发技术</h6><p>事实上，进销存管理的过程，本质上是由操作人员对货物信息进行的一系列操作，而不论是操作人员还是货物，都是系统中的对象，操作人员具有账户和密码等属性，货物则具有编号、名称、数量的属性。基于这样的考量，本进销存管理系统基于命令行界面进行设计，利用面向对象的思想，选用Microsoft Visual Studio Code 作为系统开发工具，后台数据库采用txt格式的文本文件，开发语言选择C++语言。</p>
<h5 id="2-2-技术架构设计"><a href="#2-2-技术架构设计" class="headerlink" title="2.2 技术架构设计"></a>2.2 技术架构设计</h5><p>系统技术架构上，从上往下分为表示层、业务逻辑层和数据层。系统对每一层定义功能明确的功能接口，同时在层次内实现组件化的接口实现。层次化、模块组件化的实现，使系统具备了最大程度的灵活度，从而能对业务需求的变化作出快速的反应，使系统具有很好的扩展性。</p>
<p>表现层主要是调用业务逻辑层的功能与用户直接进行交互。</p>
<p>业务逻辑层包含了所有业务逻辑的设计与实现，如用户登录、新增商品种类、删除商品种类、商品进货、商品销售、浏览商品信息、显示操作记录、盘点等。</p>
<p>数据层指具体存储系统各种业务数据的数据库系统，在本进销存管理系统中，选用了txt格式的文本文件作为数据库，以便于数据的快速读写。</p>
<p>本进销存管理系统的总体架构如图2.1所示。</p>
<p><em>图2.1 系统体系架构图</em></p>
<p><img src="/images/vendition/2-1.png" alt="1"></p>
<h5 id="2-3-功能结构与模块设计"><a href="#2-3-功能结构与模块设计" class="headerlink" title="2.3 功能结构与模块设计"></a>2.3 功能结构与模块设计</h5><h6 id="2-3-1-系统管理"><a href="#2-3-1-系统管理" class="headerlink" title="2.3.1 系统管理"></a>2.3.1 系统管理</h6><p>该系统包括系统界面初始化、用户注册账户、用户登录等相关功能。系统管理模块主要具体实现以下功能：</p>
<p><strong>1.系统界面初始化</strong></p>
<p>用户进入系统，为用户显示操作功能菜单，提示用户进行相应操作；在用户完成一项操作后，刷新界面并重新初始化当前界面。</p>
<p><strong>2.用户注册账户</strong></p>
<p>若用户第一次使用该系统，需要注册自己的账号并设置密码，不符合规定的密码无效，需要重新注册；完成注册操作后，系统会自动将输入的账号与密码配对并存入数据库中，供登录时进行比对。</p>
<p><strong>3.用户登录</strong></p>
<p>若用户已有账号或已完成注册，可输入自己的账号、密码进行登录操作，若与数据库中的已有条目相一致，则说明该用户具有操作权限，可进入进销存系统内部模块进行下一步操作；若输入的账号与密码不匹配或输入有误，会提示用户重新进行输入。</p>
<h6 id="2-3-2-商品采购、销售与库存管理"><a href="#2-3-2-商品采购、销售与库存管理" class="headerlink" title="2.3.2 商品采购、销售与库存管理"></a>2.3.2 商品采购、销售与库存管理</h6><p>商品采购、销售与库存管理系统主要包括新增商品种类、删除商品种类、商品进货、商品销售、浏览商品信息、显示操作记录、盘点与平库等相关功能。商品信息管理模块主要具体实现以下功能：</p>
<p><strong>1.新增商品种类</strong></p>
<p>输入需要录入系统的商品的编号、名称、单价、计量单位与库存数量等基本信息，增加商品种类，并同步在数据库中存入该商品的相关信息与操作记录。</p>
<p><strong>2.删除商品种类</strong></p>
<p>输入需要删除的商品种类的编号，即可在系统数据库删除该商品的所有条目信息，并在数据库中留下操作记录；若输入的商品编号无法在数据库中检索到，则该操作无效并给予用户反馈提示。</p>
<p><strong>3.商品进货</strong></p>
<p>对于数据库中已有的商品种类可以进行该操作，否则提示操作失败；输入需要进货的商品种类的编号，界面中会出现数据库中该商品的所有信息，再输入需要进货的数量，若进货的数量有效（为正数），会对应增加该商品的数量并存入数据库中，同时留下操作记录。</p>
<p><strong>4.商品销售</strong></p>
<p>对于数据库中已有的商品种类可以进行该操作，否则提示操作失败；输入需要销售的商品种类的编号，界面中会出现数据库该商品的所有信息，再输入需要销售出去的货物数量，若销售的数量有效（小于等于库存量且为正数），会对应减少该商品的数量并存入数据库中，同时留下操作记录。</p>
<p><strong>5.浏览商品信息</strong></p>
<p>可以将数据库中已有的所有商品的编号、名称、单价、计量单位与库存数量等基本信息以表格的形式展示在界面中以供操作人员进行核对查验。</p>
<p><strong>6.显示操作记录</strong></p>
<p>可以显示改变商品数量的所有操作的操作记录，包括每一次操作的操作类型、操作参数（输入的库存改变量）、操作人员账号和操作时间；其中平库操作进行标红处理。</p>
<p><strong>7.盘点与平库</strong></p>
<p>可以将数据库中已有的所有商品的编号、名称、单价、计量单位与库存数量等基本信息以表格的形式展示在界面中以供操作人员进行核对查验；在盘点完成后，若数据库中的商品数量与实际情况存在出入，在确认原因后可以选择进行平库操作，对于特定商品进行额外的出库或入库操作；平库操作会进行标红处理。</p>
<p><strong>8.数据存储</strong></p>
<p>为了保留已有的操作结果与操作记录，在每一次对于数据库中的商品进行操作时，都会从数据库中重新读取商品信息数据，并在操作完成后将改动之后的商品数据重新存入磁盘的数据库中，并在数据库中保留操作的记录以供日后查验；这也有利于不同操作人员在该系统平台上的协同操作，同时重新启动系统时程序的状态也不会发生改变。</p>
<h5 id="2-4-设计目的与优势"><a href="#2-4-设计目的与优势" class="headerlink" title="2.4 设计目的与优势"></a>2.4 设计目的与优势</h5><h6 id="2-4-1-设计目的"><a href="#2-4-1-设计目的" class="headerlink" title="2.4.1 设计目的"></a>2.4.1 设计目的</h6><p>在系统界面与整体功能架构的设计上，对于两个模块均采取了先初始化界面显示操作列表、再根据用户的操作指令给予对应的提示、完成相应操作的模式进行设计，并在各个功能的完成过程中贯穿了对于数据库的读写操作以实时修改，以功能实现为导向，希望帮助操作用户更加高效地实现商品信息的读取与写入。</p>
<h6 id="2-4-2-设计优势"><a href="#2-4-2-设计优势" class="headerlink" title="2.4.2 设计优势"></a>2.4.2 设计优势</h6><p>1.界面简洁自然，各项功能列表一目了然，方便操作人员迅速完成操作，减少误操作的概率；</p>
<p>2.对于所有输入的位点都进行了规范化处理，保证输入的数据格式都是合乎要求的，同时对于非法的输入操作都给予了反馈警告，便于用户快速上手；</p>
<p>3.设计功能齐全，可以满足大多数情况下商品的采购、销售与库存管理操作；</p>
<p>4.运用数据库实时储存用户信息、商品信息与操作记录，方便必要时进行查询，同时也有利于保存数据，支持多用户对于系统进行操作；</p>
<p>5.用户登录机制与操作记录保存机制为系统的安全性提供了一定的保障。</p>
<br>

<h4 id="三、系统实现"><a href="#三、系统实现" class="headerlink" title="三、系统实现"></a>三、系统实现</h4><hr>
<p>本系统的具体框架如下图3.1所示。当成功登录窗口后，用户即进入到主界面中，此时用户可以通过模块选择在自己操作权限范围内的操作，并可在各个功能模块之间进行切换。</p>
<p><em>图3.1 系统功能流程图</em></p>
<p><img src="/images/vendition/3-1.png" alt="2"></p>
<h5 id="3-1-命令行界面的初始化实现"><a href="#3-1-命令行界面的初始化实现" class="headerlink" title="3.1 命令行界面的初始化实现"></a>3.1 命令行界面的初始化实现</h5><p>在设计时，我们根据需求，希望系统的界面能够在完成一项指令操作后刷新并重新加载操作功能菜单以使用其他功能。因此，在登录窗口与系统内部商品处理两个模块的界面加载中，采用了相同的实现逻辑以达到这一效果。具体实现逻辑如下图3.2所示。最终实现效果符合预期。</p>
<p><em>图3.2 命令行界面初始化流程图</em></p>
<p><img src="/images/vendition/3-2.png" alt="3"></p>
<h5 id="3-2-登录界面——用户权限管理实现"><a href="#3-2-登录界面——用户权限管理实现" class="headerlink" title="3.2 登录界面——用户权限管理实现"></a>3.2 登录界面——用户权限管理实现</h5><p>在登录界面，系统为用户提供了三个选项卡：用户登录、用户注册与退出系统，并分别有与之对应的操作代码。具体实现时，采用了选择分支结构，对于用户输入的功能编号进行检测，并对非法的输入给予反馈，提示需要重新输入正确的功能编号（本系统中所有需要输入操作代码的地方均采用了该流程，后面不再赘述）。</p>
<p>对于文件的读写，在程序中创建了相应的文件操作对象以进行相应的读写操作，并在每一次操作完成后关闭文件并重新打开以重置读写指针，防止影响到后续的操作。（进销存模块的文件读写操作与这里方式相同，后面不再赘述）。</p>
<p>对于用户的个人信息，设计了类user，具有用户名和密码两个私有属性，并设计了一系列公有函数对其进行读写，随后在用户注册与登录环节对该类进行实例化，并对实例化后的对象进行一系列的读写操作以实现功能。（在进销存模块中，对于商品类goods与操作记录类operations也采取了相同的方式进行处理，后面不再赘述）。</p>
<p>若选择“退出系统”选项卡，会提示用户是否确认退出：若确认推出，则立刻自动关闭窗口，反之则重新加载界面。效果图如图3.3。</p>
<p>若选择“用户注册”选项卡，会提示用户输入自己想要设置的用户名与密码（会提示用户用户名和密码只能包含字母和数字；用户名若与库中已有的用户名重复，会提示注册失败；密码还限制了位数不得少于六位，若不足六位也会提示注册失败，需要重新注册）；注册成功后，用户的信息会自动存入用户数据库文件“userinformation.txt”，同时重新加载界面。效果图如图3.4。</p>
<p>若选择“用户登录”选项卡，会提示用户输入用户名和密码，输入完成后与数据库中的对应文件进行匹配，若匹配成功则进入进销存系统模块（在程序编写过程中具体体现为进入函数login），反之则提示输入有误，请重新输入，并重新加载界面。效果图如图3.5。</p>
<p>该模块的详细实现代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">user</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    string username;</span><br><span class="line">    string password;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putusername</span><span class="params">()</span></span>&#123;cin&gt;&gt;username;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putpassword</span><span class="params">()</span></span>&#123;cin&gt;&gt;password;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getusername</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> username;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getpassword</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> password;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;********************************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*           欢迎您使用进销存系统           *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                                          *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                1.用户登录                *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                2.用户注册                *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                0.退出系统                *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                                          *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;********************************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;请输入您需要执行的功能编号:&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fstream userinformation;</span><br><span class="line">        userinformation.<span class="built_in">open</span>(<span class="string">&quot;userinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">        <span class="built_in">initialize</span>();<span class="comment">//初始化界面</span></span><br><span class="line">        <span class="comment">//账号注册与登录模块</span></span><br><span class="line">        string op1;</span><br><span class="line">        cin&gt;&gt;op1;</span><br><span class="line">        <span class="keyword">if</span>(op1==<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//用户登录，先让用户输入账号和密码   </span></span><br><span class="line">            user user1;</span><br><span class="line">            <span class="type">int</span> flagin=<span class="number">0</span>;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;请输入您的用户名:&quot;</span>;</span><br><span class="line">            user1.<span class="built_in">putusername</span>();</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;请输入您的用户密码:&quot;</span>;</span><br><span class="line">            user1.<span class="built_in">putpassword</span>();</span><br><span class="line">            <span class="comment">//将用户录入的与文件中保存的账号密码进行比对</span></span><br><span class="line">            string use=user1.<span class="built_in">getusername</span>()+<span class="string">&quot; &quot;</span>+user1.<span class="built_in">getpassword</span>();</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                string inform;</span><br><span class="line">                <span class="built_in">getline</span>(userinformation,inform);</span><br><span class="line">                <span class="keyword">if</span>(inform==<span class="string">&quot;&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span>(use==inform)</span><br><span class="line">                &#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;亲爱的用户&quot;</span>&lt;&lt;user1.<span class="built_in">getusername</span>()&lt;&lt;<span class="string">&quot;,欢迎您登录本系统&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">                    <span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">                    <span class="built_in">login</span>(user1.<span class="built_in">getusername</span>());<span class="comment">//进入进销存系统</span></span><br><span class="line">                    flagin=<span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(flagin==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;您输入的账号或密码错误,请检查后重新输入&quot;</span>;</span><br><span class="line">                <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op1==<span class="string">&quot;2&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//用户注册，输入用户名与密码</span></span><br><span class="line">            user user1;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;请输入您的用户名(仅可使用数字与字母):&quot;</span>;</span><br><span class="line">            user1.<span class="built_in">putusername</span>();</span><br><span class="line">            <span class="comment">//判断用户名是否已经存在</span></span><br><span class="line">            <span class="type">int</span> flag=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                string name;</span><br><span class="line">                userinformation&gt;&gt;name;</span><br><span class="line">                string empty;</span><br><span class="line">                <span class="built_in">getline</span>(userinformation,empty);</span><br><span class="line">                <span class="keyword">if</span>(name==<span class="string">&quot;&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span>(user1.<span class="built_in">getusername</span>()==name)</span><br><span class="line">                &#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;您输入的用户名已经存在,注册失败,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">                    flag=<span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            userinformation.<span class="built_in">close</span>();</span><br><span class="line">            userinformation.<span class="built_in">open</span>(<span class="string">&quot;userinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="keyword">if</span>(flag==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;请输入您的用户密码(仅可使用数字或字母,不小于6位):&quot;</span>;</span><br><span class="line">                user1.<span class="built_in">putpassword</span>();</span><br><span class="line">                <span class="comment">//判断用户输入的密码是否符合要求，若符合要求则录入文件</span></span><br><span class="line">                string pass=user1.<span class="built_in">getpassword</span>();</span><br><span class="line">                <span class="keyword">if</span>(pass.<span class="built_in">length</span>()&lt;<span class="number">6</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;您输入的密码小于6位,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;您已成功注册,请进行登录&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    userinformation&lt;&lt;user1.<span class="built_in">getusername</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;user1.<span class="built_in">getpassword</span>()&lt;&lt;endl;</span><br><span class="line">                    <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op1==<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> fl=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(fl==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;您确认要退出该系统吗?(是请按1,否请按0)&quot;</span>;</span><br><span class="line">                <span class="type">int</span> opp;</span><br><span class="line">                cin&gt;&gt;opp;</span><br><span class="line">                <span class="keyword">if</span>(opp==<span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(opp==<span class="number">0</span>)</span><br><span class="line">                    fl=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;您输入有误,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;您输入了无效的操作代码,请重新输入&quot;</span>;</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        userinformation.<span class="built_in">close</span>();</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>图3.3 “退出系统”功能效果图</em></p>
<p><img src="/images/vendition/3-3.png" alt="4"></p>
<p><em>图3.4 “用户注册”功能效果图</em></p>
<p><img src="/images/vendition/3-4.png" alt="5"></p>
<p><img src="/images/vendition/3-5.png" alt="6"></p>
<p><img src="/images/vendition/3-6.png" alt="7"></p>
<p><em>图3.5 “用户登录”功能效果图</em></p>
<p><img src="/images/vendition/3-7.png" alt="8"></p>
<p><img src="/images/vendition/3-8.png" alt="9"></p>
<h5 id="3-3-商品进销存功能实现"><a href="#3-3-商品进销存功能实现" class="headerlink" title="3.3 商品进销存功能实现"></a>3.3 商品进销存功能实现</h5><p>进入进销存模块界面，系统为用户提供了八个选项卡：新增商品种类、删除商品种类、商品进货、商品销售、浏览商品信息、显示操作记录、盘点、退出登录，并分别有与之对应的操作代码。</p>
<p>若选择“退出登录”选项卡，会直接退出登录，停顿一秒后回到登录主界面。效果图如图3.6。</p>
<p>若选择“新增商品种类”选项卡，会提示用户输入需要新增种类的商品编号（不得与数据库中已有的商品编号相同，否则会提示重新输入），并依次提示输入商品的名称、单位、价格与库存数量；提示添加成功后，该商品的信息会自动存入商品数据库文件“goodsinformation.txt”，而相应的操作记录（包括操作编号、操作的商品编号、操作的种类、操作的商品数量、操作人的用户名与操作时间等详细信息）会被录入操作数据库文件“operationinformation.txt”(“删除商品种类”、“商品进货”、“商品销售”、“盘点”等操作也会在操作完成后录入该数据库，后面不再赘述)，同时重新加载界面。效果图如图3.7。</p>
<p>若选择“删除商品种类”选项卡，会提示用户输入需要删除的商品编号（必须是库中已有的商品种类，否则会提示重新输入）；提示删除成功后，数据库中该商品的条目信息也会一并删除，同时留下操作记录，并重新加载界面。效果图如图3.8。</p>
<p>若选择“商品进货”选项卡，会提示用户输入需要进货的商品编号（必须是库中已有的商品种类，否则会提示重新输入），并相应显示该商品的详细信息；用户还需要输入进货量（不可以为负数，否则提示重新输入）。提示进货成功后，数据库中该商品的库存量也会相应增加，同时留下操作记录，并重新加载界面。效果图如图3.9。</p>
<p>若选择“商品销售”选项卡，会提示用户输入需要销售的商品编号（必须是库中已有的商品种类，否则会提示重新输入），并相应显示该商品的详细信息；用户还需要输入销售量（不可以为负数或小于库存量，否则提示重新输入）。提示销售成功后，数据库中该商品的库存量也会相应减少，同时留下操作记录，并重新加载界面。效果图如图3.10。</p>
<p>若选择“浏览商品信息”选项卡，将会把数据库中所有货物的详细信息列举出来以供查看。效果图如图3.11。</p>
<p>若选择“显示操作记录”选项卡，将会把数据库中所有操作记录的具体信息列举出来以供查看。其中，平库过程中的出库与入库操作均会被标红。效果图如图3.12。</p>
<p>若选择“盘点”选项卡，将会把数据库中所有货物的详细信息列举出来以供查看，并在下方提示是否需要平库。若选择不需要平库，则会直接重新加载界面；若选择需要平库，则需选择需要出库或者入库（此行会被标红以示警告），出库操作与商品销售类似，而入库操作则与商品进货类似，在此不再重复。效果图如图3.13。</p>
<p>该模块的详细实现代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function">string <span class="title">gettime</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">time_t</span> t=<span class="built_in">time</span>(<span class="literal">NULL</span>);</span><br><span class="line">        tm *now=<span class="built_in">localtime</span>(&amp;t);</span><br><span class="line">        <span class="type">int</span> year=<span class="number">1900</span>+now-&gt;tm_year;</span><br><span class="line">        <span class="type">int</span> mon=<span class="number">1</span>+now-&gt;tm_mon;</span><br><span class="line">        <span class="type">int</span> day=now-&gt;tm_mday;</span><br><span class="line">        <span class="type">int</span> hour=now-&gt;tm_hour;</span><br><span class="line">        <span class="type">int</span> min=now-&gt;tm_min;</span><br><span class="line">        <span class="type">int</span> sec=now-&gt;tm_sec;</span><br><span class="line">        string to_year=<span class="built_in">to_string</span>( year );</span><br><span class="line">        string to_month=<span class="built_in">to_string</span>( mon );</span><br><span class="line">        string to_day=<span class="built_in">to_string</span>( day );</span><br><span class="line">        string to_hour=<span class="built_in">to_string</span>( hour );</span><br><span class="line">        string to_min=<span class="built_in">to_string</span>( min );</span><br><span class="line">        string to_sec=<span class="built_in">to_string</span>( sec );</span><br><span class="line">        <span class="keyword">return</span> to_year+<span class="string">&quot;-&quot;</span>+to_month+<span class="string">&quot;-&quot;</span>+to_day+<span class="string">&quot; &quot;</span>+to_hour+<span class="string">&quot;:&quot;</span>+to_min+<span class="string">&quot;:&quot;</span>+to_sec;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">goods</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    string no;</span><br><span class="line">    string name;</span><br><span class="line">    string count;</span><br><span class="line">    string price;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putno</span><span class="params">()</span></span>&#123;cin&gt;&gt;no;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putname</span><span class="params">()</span></span>&#123;cin&gt;&gt;name;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putcount</span><span class="params">()</span></span>&#123;cin&gt;&gt;count;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putprice</span><span class="params">()</span></span>&#123;cin&gt;&gt;price;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putnum</span><span class="params">()</span></span>&#123;cin&gt;&gt;num;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putnum</span><span class="params">(<span class="type">int</span> input)</span></span>&#123;num=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putno</span><span class="params">(string input)</span></span>&#123;no=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putname</span><span class="params">(string input)</span></span>&#123;name=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putcount</span><span class="params">(string input)</span></span>&#123;count=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putprice</span><span class="params">(string input)</span></span>&#123;price=input;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getno</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> no;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getname</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> name;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getcount</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> count;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getprice</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> price;&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getnum</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> num;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">operations</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    string no;</span><br><span class="line">    string kinds;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    string acount;</span><br><span class="line">    string date;</span><br><span class="line">    <span class="type">int</span> flag;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putno</span><span class="params">(string input)</span></span>&#123;no=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putkinds</span><span class="params">(string input)</span></span>&#123;kinds=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putnum</span><span class="params">(<span class="type">int</span> input)</span></span>&#123;num=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putacount</span><span class="params">(string input)</span></span>&#123;acount=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">putdate</span><span class="params">()</span></span>&#123;date=<span class="built_in">gettime</span>();&#125;</span><br><span class="line">    <span class="function">string <span class="title">getno</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> no;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getkinds</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> kinds;&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getnum</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> num;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getacount</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> acount;&#125;</span><br><span class="line">    <span class="function">string <span class="title">getdate</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> date;&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">putflag</span><span class="params">(<span class="type">int</span> input)</span></span>&#123;flag=input;&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getflag</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> flag;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">systeminitialize</span><span class="params">(string username)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;******************************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                 功能菜单               *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                                        *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             1.新增商品种类             *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             2.删除商品种类             *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             3.商品进货                 *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             4.商品销售                 *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             5.浏览商品信息             *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             6.显示操作记录             *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             7.盘点                     *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*             0.退出登录                 *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*                                        *&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;******************************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;亲爱的用户&quot;</span>&lt;&lt;username&lt;&lt;<span class="string">&quot;,欢迎进入进销存管理平台&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;请输入您需要执行的功能编号:&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">CharToStr</span><span class="params">(<span class="type">char</span> * contentChar)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string tempStr;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;contentChar[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        tempStr+=contentChar[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tempStr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DelLineData</span><span class="params">(<span class="type">char</span>* fileName, <span class="type">int</span> lineNum)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ifstream in;</span><br><span class="line">    in.<span class="built_in">open</span>(fileName);</span><br><span class="line">    </span><br><span class="line">    string strFileData = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> line = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> lineData[<span class="number">1024</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">while</span>(in.<span class="built_in">getline</span>(lineData, <span class="built_in">sizeof</span>(lineData)))</span><br><span class="line">    &#123;</span><br><span class="line">        line++;</span><br><span class="line">        <span class="keyword">if</span> (line == lineNum)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            strFileData += <span class="built_in">CharToStr</span>(lineData);</span><br><span class="line">            strFileData += <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    in.<span class="built_in">close</span>();</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//写入文件</span></span><br><span class="line">    ofstream out;</span><br><span class="line">    out.<span class="built_in">open</span>(fileName);</span><br><span class="line">    out.<span class="built_in">flush</span>();</span><br><span class="line">    out&lt;&lt;strFileData;</span><br><span class="line">    out.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">login</span><span class="params">(string username)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fstream goodsinformation;</span><br><span class="line">        goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">        fstream operationinformation;</span><br><span class="line">        operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">        <span class="built_in">systeminitialize</span>(username);<span class="comment">//初始化界面</span></span><br><span class="line">        <span class="comment">//进销存系统内部操作</span></span><br><span class="line">        string op2;</span><br><span class="line">        cin&gt;&gt;op2;</span><br><span class="line">        <span class="keyword">if</span>(op2==<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            goods good1;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;请输入商品编号:&quot;</span>;</span><br><span class="line">            good1.<span class="built_in">putno</span>();</span><br><span class="line">            <span class="comment">//检测输入商品的编号，若编号与之前的一致，则需要重新输入</span></span><br><span class="line">            <span class="type">int</span> flag1=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                string no;</span><br><span class="line">                goodsinformation&gt;&gt;no;</span><br><span class="line">                string empty1;</span><br><span class="line">                <span class="built_in">getline</span>(goodsinformation,empty1);</span><br><span class="line">                <span class="keyword">if</span>(goodsinformation.<span class="built_in">eof</span>())<span class="comment">//判断是否读取到文件末尾</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span>(good1.<span class="built_in">getno</span>()==no)</span><br><span class="line">                &#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;您输入的商品种类已经存在,本次录入操作失败,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">                    flag1=<span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="keyword">if</span>(flag1==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                </span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;请输入商品名称:&quot;</span>;</span><br><span class="line">                good1.<span class="built_in">putname</span>();</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;请输入商品单位:&quot;</span>;</span><br><span class="line">                good1.<span class="built_in">putcount</span>();</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;请输入商品价格:&quot;</span>;</span><br><span class="line">                good1.<span class="built_in">putprice</span>();</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;请输入商品库存数量:&quot;</span>;</span><br><span class="line">                good1.<span class="built_in">putnum</span>();</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;添加商品种类成功&quot;</span>&lt;&lt;endl;</span><br><span class="line">                goodsinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good1.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good1.<span class="built_in">getname</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good1.<span class="built_in">getcount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good1.<span class="built_in">getprice</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good1.<span class="built_in">getnum</span>()&lt;&lt;endl;</span><br><span class="line">                <span class="comment">//保留操作记录</span></span><br><span class="line">                operations operate1;</span><br><span class="line">                operate1.<span class="built_in">putno</span>(good1.<span class="built_in">getno</span>());</span><br><span class="line">                operate1.<span class="built_in">putkinds</span>(<span class="string">&quot;新增商品种类&quot;</span>);</span><br><span class="line">                operate1.<span class="built_in">putnum</span>(good1.<span class="built_in">getnum</span>());</span><br><span class="line">                operate1.<span class="built_in">putacount</span>(username);</span><br><span class="line">                operate1.<span class="built_in">putdate</span>();</span><br><span class="line">                operate1.<span class="built_in">putflag</span>(<span class="number">0</span>);</span><br><span class="line">                operationinformation&lt;&lt;operate1.<span class="built_in">getflag</span>()&lt;&lt;endl;</span><br><span class="line">                operationinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getkinds</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getnum</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getacount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">25</span>)&lt;&lt;operate1.<span class="built_in">getdate</span>()&lt;&lt;endl;</span><br><span class="line">                operationinformation.<span class="built_in">close</span>();</span><br><span class="line">                operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op2==<span class="string">&quot;2&quot;</span>)</span><br><span class="line">        &#123;  </span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;请输入您需要删除的商品编号:&quot;</span>;</span><br><span class="line">            string no1;</span><br><span class="line">            cin&gt;&gt;no1;</span><br><span class="line">            <span class="type">int</span> flag2=<span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> line=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                string no2;</span><br><span class="line">                goodsinformation&gt;&gt;no2;</span><br><span class="line">                string name2;</span><br><span class="line">                goodsinformation&gt;&gt;name2;</span><br><span class="line">                string count2;</span><br><span class="line">                goodsinformation&gt;&gt;count2;</span><br><span class="line">                string price2;</span><br><span class="line">                goodsinformation&gt;&gt;price2;</span><br><span class="line">                <span class="type">int</span> num2;</span><br><span class="line">                goodsinformation&gt;&gt;num2;</span><br><span class="line">                <span class="keyword">if</span>(goodsinformation.<span class="built_in">eof</span>())<span class="comment">//判断是否读取到文件末尾</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span>(no2==no1)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//删除商品信息</span></span><br><span class="line">                    <span class="built_in">DelLineData</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>, line);</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;删除商品种类成功&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    flag2=<span class="number">1</span>;</span><br><span class="line">                    <span class="comment">//保留操作记录</span></span><br><span class="line">                    operations operate1;</span><br><span class="line">                    operate1.<span class="built_in">putno</span>(no2);</span><br><span class="line">                    operate1.<span class="built_in">putkinds</span>(<span class="string">&quot;删除商品种类&quot;</span>);</span><br><span class="line">                    operate1.<span class="built_in">putnum</span>(num2);</span><br><span class="line">                    operate1.<span class="built_in">putacount</span>(username);</span><br><span class="line">                    operate1.<span class="built_in">putdate</span>();</span><br><span class="line">                    operate1.<span class="built_in">putflag</span>(<span class="number">0</span>);</span><br><span class="line">                    operationinformation&lt;&lt;operate1.<span class="built_in">getflag</span>()&lt;&lt;endl;</span><br><span class="line">                    operationinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getkinds</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getnum</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getacount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">25</span>)&lt;&lt;operate1.<span class="built_in">getdate</span>()&lt;&lt;endl;</span><br><span class="line">                    operationinformation.<span class="built_in">close</span>();</span><br><span class="line">                    operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                line++;</span><br><span class="line">            &#125;</span><br><span class="line">            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="keyword">if</span>(flag2==<span class="number">0</span>)</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;系统中没有编号为&quot;</span>&lt;&lt;no1&lt;&lt;<span class="string">&quot;的商品信息,删除商品失败,请检查后再试&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op2==<span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;请输入需要进货的商品编号:&quot;</span>;</span><br><span class="line">            goods good2;</span><br><span class="line">            string no1;</span><br><span class="line">            cin&gt;&gt;no1;</span><br><span class="line">            <span class="type">int</span> flag2=<span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> line=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                line++;</span><br><span class="line">                string no2;</span><br><span class="line">                goodsinformation&gt;&gt;no2;</span><br><span class="line">                string name2;</span><br><span class="line">                goodsinformation&gt;&gt;name2;</span><br><span class="line">                string count2;</span><br><span class="line">                goodsinformation&gt;&gt;count2;</span><br><span class="line">                string price2;</span><br><span class="line">                goodsinformation&gt;&gt;price2;</span><br><span class="line">                <span class="type">int</span> num2;</span><br><span class="line">                goodsinformation&gt;&gt;num2;</span><br><span class="line">                <span class="keyword">if</span>(goodsinformation.<span class="built_in">eof</span>())<span class="comment">//判断是否读取到文件末尾</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span>(no2==no1)</span><br><span class="line">                &#123;</span><br><span class="line">                    flag2=<span class="number">1</span>;</span><br><span class="line">                    <span class="comment">//显示该商品在系统中的信息</span></span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;编号&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;名称&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;单位&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;价格&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;库存量&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    cout&lt;&lt;no2&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;name2&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;count2&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;price2&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;num2&lt;&lt;endl;</span><br><span class="line">                    <span class="comment">//进货</span></span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;请输入进货量：&quot;</span>;</span><br><span class="line">                    <span class="type">int</span> num1;</span><br><span class="line">                    cin&gt;&gt;num1;</span><br><span class="line">                    <span class="comment">//判断非负</span></span><br><span class="line">                    <span class="keyword">if</span>(num1&lt;<span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        cout&lt;&lt;<span class="string">&quot;进货量不能小于零,输入有误,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    good2.<span class="built_in">putnum</span>(num1+num2);</span><br><span class="line">                    good2.<span class="built_in">putno</span>(no2);</span><br><span class="line">                    good2.<span class="built_in">putname</span>(name2);</span><br><span class="line">                    good2.<span class="built_in">putcount</span>(count2);</span><br><span class="line">                    good2.<span class="built_in">putprice</span>(price2);</span><br><span class="line">                    <span class="built_in">DelLineData</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>, line);</span><br><span class="line">                    goodsinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getname</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getcount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getprice</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getnum</span>()&lt;&lt;endl;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;进货成功&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    <span class="comment">//保留操作记录</span></span><br><span class="line">                    operations operate1;</span><br><span class="line">                    operate1.<span class="built_in">putno</span>(no2);</span><br><span class="line">                    operate1.<span class="built_in">putkinds</span>(<span class="string">&quot;商品进货&quot;</span>);</span><br><span class="line">                    operate1.<span class="built_in">putnum</span>(num2);</span><br><span class="line">                    operate1.<span class="built_in">putacount</span>(username);</span><br><span class="line">                    operate1.<span class="built_in">putdate</span>();</span><br><span class="line">                    operate1.<span class="built_in">putflag</span>(<span class="number">0</span>);</span><br><span class="line">                    operationinformation&lt;&lt;operate1.<span class="built_in">getflag</span>()&lt;&lt;endl;</span><br><span class="line">                    operationinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getkinds</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getnum</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getacount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">25</span>)&lt;&lt;operate1.<span class="built_in">getdate</span>()&lt;&lt;endl;</span><br><span class="line">                    operationinformation.<span class="built_in">close</span>();</span><br><span class="line">                    operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="keyword">if</span>(flag2==<span class="number">0</span>)</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;系统中没有编号为&quot;</span>&lt;&lt;no1&lt;&lt;<span class="string">&quot;的商品信息,商品进货失败,请检查后再试&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op2==<span class="string">&quot;4&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;请输入需要售出的商品编号:&quot;</span>;</span><br><span class="line">            goods good2;</span><br><span class="line">            string no1;</span><br><span class="line">            cin&gt;&gt;no1;</span><br><span class="line">            <span class="type">int</span> flag2=<span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> line=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                line++;</span><br><span class="line">                string no2;</span><br><span class="line">                goodsinformation&gt;&gt;no2;</span><br><span class="line">                string name2;</span><br><span class="line">                goodsinformation&gt;&gt;name2;</span><br><span class="line">                string count2;</span><br><span class="line">                goodsinformation&gt;&gt;count2;</span><br><span class="line">                string price2;</span><br><span class="line">                goodsinformation&gt;&gt;price2;</span><br><span class="line">                <span class="type">int</span> num2;</span><br><span class="line">                goodsinformation&gt;&gt;num2;</span><br><span class="line">                <span class="keyword">if</span>(goodsinformation.<span class="built_in">eof</span>())<span class="comment">//判断是否读取到文件末尾</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span>(no2==no1)</span><br><span class="line">                &#123;</span><br><span class="line">                    flag2=<span class="number">1</span>;</span><br><span class="line">                    <span class="comment">//显示该商品在系统中的信息</span></span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;编号&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;名称&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;单位&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;价格&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;库存量&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    cout&lt;&lt;no2&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;name2&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;count2&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;price2&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;num2&lt;&lt;endl;</span><br><span class="line">                    <span class="comment">//进货</span></span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;请输入销售量：&quot;</span>;</span><br><span class="line">                    <span class="type">int</span> num1;</span><br><span class="line">                    cin&gt;&gt;num1;</span><br><span class="line">                    <span class="keyword">if</span>(num1&lt;<span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        cout&lt;&lt;<span class="string">&quot;销售量不能小于零,输入有误,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">int</span> out=num2-num1;</span><br><span class="line">                    <span class="keyword">if</span>(out&lt;<span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        cout&lt;&lt;<span class="string">&quot;库存量不足,无法销售,请核对后重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    good2.<span class="built_in">putnum</span>(out);</span><br><span class="line">                    good2.<span class="built_in">putno</span>(no2);</span><br><span class="line">                    good2.<span class="built_in">putname</span>(name2);</span><br><span class="line">                    good2.<span class="built_in">putcount</span>(count2);</span><br><span class="line">                    good2.<span class="built_in">putprice</span>(price2);</span><br><span class="line">                    <span class="built_in">DelLineData</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>, line);</span><br><span class="line">                    goodsinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getname</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getcount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getprice</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getnum</span>()&lt;&lt;endl;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;商品销售成功&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    <span class="comment">//保留操作记录</span></span><br><span class="line">                    operations operate1;</span><br><span class="line">                    operate1.<span class="built_in">putno</span>(no2);</span><br><span class="line">                    operate1.<span class="built_in">putkinds</span>(<span class="string">&quot;商品销售&quot;</span>);</span><br><span class="line">                    operate1.<span class="built_in">putnum</span>(num2);</span><br><span class="line">                    operate1.<span class="built_in">putacount</span>(username);</span><br><span class="line">                    operate1.<span class="built_in">putdate</span>();</span><br><span class="line">                    operate1.<span class="built_in">putflag</span>(<span class="number">0</span>);</span><br><span class="line">                    operationinformation&lt;&lt;operate1.<span class="built_in">getflag</span>()&lt;&lt;endl;</span><br><span class="line">                    operationinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getkinds</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getnum</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getacount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">25</span>)&lt;&lt;operate1.<span class="built_in">getdate</span>()&lt;&lt;endl;</span><br><span class="line">                    operationinformation.<span class="built_in">close</span>();</span><br><span class="line">                    operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="keyword">if</span>(flag2==<span class="number">0</span>)</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;系统中没有编号为&quot;</span>&lt;&lt;no1&lt;&lt;<span class="string">&quot;的商品信息,商品销售失败,请检查后再试&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op2==<span class="string">&quot;5&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;编号&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;名称&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;单位&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;价格&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;库存量&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="keyword">while</span>(!goodsinformation.<span class="built_in">eof</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                string informate;</span><br><span class="line">                <span class="built_in">getline</span>(goodsinformation,informate);</span><br><span class="line">                <span class="keyword">if</span>(goodsinformation.<span class="built_in">fail</span>())</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                cout&lt;&lt;informate&lt;&lt;endl;</span><br><span class="line">            &#125;</span><br><span class="line">            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op2==<span class="string">&quot;6&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> optime=<span class="number">1</span>;</span><br><span class="line">            cout&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;<span class="string">&quot;编号&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;<span class="string">&quot;商品编号&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;<span class="string">&quot;所作操作&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;<span class="string">&quot;数量&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;<span class="string">&quot;操作人账户&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">25</span>)&lt;&lt;<span class="string">&quot;操作时间&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="keyword">while</span>(!operationinformation.<span class="built_in">eof</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> flag;</span><br><span class="line">                operationinformation&gt;&gt;flag;</span><br><span class="line">                string empty;</span><br><span class="line">                <span class="built_in">getline</span>(operationinformation,empty);</span><br><span class="line">                <span class="keyword">if</span> (flag==<span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    string informate;</span><br><span class="line">                    <span class="built_in">getline</span>(operationinformation,informate);</span><br><span class="line">                    <span class="keyword">if</span>(operationinformation.<span class="built_in">fail</span>())</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    cout&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;optime&lt;&lt;informate&lt;&lt;endl;</span><br><span class="line">                    optime++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (flag==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    string informate;</span><br><span class="line">                    <span class="built_in">getline</span>(operationinformation,informate);</span><br><span class="line">                    <span class="keyword">if</span>(operationinformation.<span class="built_in">fail</span>())</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="built_in">SetConsoleTextAttribute</span>(<span class="built_in">GetStdHandle</span>(STD_OUTPUT_HANDLE), FOREGROUND_INTENSITY | FOREGROUND_RED);</span><br><span class="line">                    cout&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;optime&lt;&lt;informate&lt;&lt;endl;</span><br><span class="line">                    <span class="built_in">SetConsoleTextAttribute</span>(<span class="built_in">GetStdHandle</span>(STD_OUTPUT_HANDLE), FOREGROUND_RED |FOREGROUND_GREEN | FOREGROUND_BLUE);</span><br><span class="line">                    optime++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            operationinformation.<span class="built_in">close</span>();</span><br><span class="line">            operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op2==<span class="string">&quot;7&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;编号&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;名称&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;单位&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;价格&quot;</span>&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;<span class="string">&quot;库存量&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="keyword">while</span>(!goodsinformation.<span class="built_in">eof</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                string informate;</span><br><span class="line">                <span class="built_in">getline</span>(goodsinformation,informate);</span><br><span class="line">                <span class="keyword">if</span>(goodsinformation.<span class="built_in">fail</span>())</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                cout&lt;&lt;informate&lt;&lt;endl;</span><br><span class="line">            &#125;</span><br><span class="line">            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;---------------------------------------------&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="type">int</span> flagx=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(flagx==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;是否需要平库?(是请按1,否请按0)&quot;</span>;</span><br><span class="line">                <span class="type">int</span> op3;</span><br><span class="line">                cin&gt;&gt;op3;</span><br><span class="line">                <span class="keyword">if</span>(op3==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">int</span> flagy=<span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">while</span>(flagy==<span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">//设置红色字体</span></span><br><span class="line">                        <span class="built_in">SetConsoleTextAttribute</span>(<span class="built_in">GetStdHandle</span>(STD_OUTPUT_HANDLE), FOREGROUND_INTENSITY | FOREGROUND_RED);</span><br><span class="line">                        cout &lt;&lt; <span class="string">&quot;您需要出库还是入库?(出库请按1,入库请按0):&quot;</span> ;</span><br><span class="line">                        <span class="type">int</span> op4;</span><br><span class="line">                        cin&gt;&gt;op4;</span><br><span class="line">                        <span class="built_in">SetConsoleTextAttribute</span>(<span class="built_in">GetStdHandle</span>(STD_OUTPUT_HANDLE), FOREGROUND_RED |FOREGROUND_GREEN | FOREGROUND_BLUE);<span class="comment">//把颜色换回来</span></span><br><span class="line">                        <span class="keyword">if</span>(op4==<span class="number">0</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            flagy=<span class="number">1</span>;</span><br><span class="line">                            cout&lt;&lt;<span class="string">&quot;请输入需要入库的商品编号:&quot;</span>;</span><br><span class="line">                            goods good2;</span><br><span class="line">                            string no1;</span><br><span class="line">                            cin&gt;&gt;no1;</span><br><span class="line">                            <span class="type">int</span> flag2=<span class="number">0</span>;</span><br><span class="line">                            <span class="type">int</span> line=<span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">                            &#123;</span><br><span class="line">                                line++;</span><br><span class="line">                                string no2;</span><br><span class="line">                                goodsinformation&gt;&gt;no2;</span><br><span class="line">                                string name2;</span><br><span class="line">                                goodsinformation&gt;&gt;name2;</span><br><span class="line">                                string count2;</span><br><span class="line">                                goodsinformation&gt;&gt;count2;</span><br><span class="line">                                string price2;</span><br><span class="line">                                goodsinformation&gt;&gt;price2;</span><br><span class="line">                                <span class="type">int</span> num2;</span><br><span class="line">                                goodsinformation&gt;&gt;num2;</span><br><span class="line">                                <span class="keyword">if</span>(goodsinformation.<span class="built_in">eof</span>())<span class="comment">//判断是否读取到文件末尾</span></span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">if</span>(no2==no1)</span><br><span class="line">                                &#123;</span><br><span class="line">                                    flag2=<span class="number">1</span>;</span><br><span class="line">                                    <span class="comment">//入库</span></span><br><span class="line">                                    cout&lt;&lt;<span class="string">&quot;请输入入库量：&quot;</span>;</span><br><span class="line">                                    <span class="type">int</span> num1;</span><br><span class="line">                                    cin&gt;&gt;num1;</span><br><span class="line">                                    <span class="comment">//判断非负</span></span><br><span class="line">                                    <span class="keyword">if</span>(num1&lt;<span class="number">0</span>)</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        cout&lt;&lt;<span class="string">&quot;入库量不能小于零,输入有误,请重新输入入库量:&quot;</span>;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    good2.<span class="built_in">putnum</span>(num1+num2);</span><br><span class="line">                                    good2.<span class="built_in">putno</span>(no2);</span><br><span class="line">                                    good2.<span class="built_in">putname</span>(name2);</span><br><span class="line">                                    good2.<span class="built_in">putcount</span>(count2);</span><br><span class="line">                                    good2.<span class="built_in">putprice</span>(price2);</span><br><span class="line">                                    <span class="built_in">DelLineData</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>, line);</span><br><span class="line">                                    goodsinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getname</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getcount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getprice</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getnum</span>()&lt;&lt;endl;</span><br><span class="line">                                    cout&lt;&lt;<span class="string">&quot;商品盘点成功&quot;</span>&lt;&lt;endl;</span><br><span class="line">                                    <span class="comment">//保留操作记录</span></span><br><span class="line">                                    operations operate1;</span><br><span class="line">                                    operate1.<span class="built_in">putno</span>(no2);</span><br><span class="line">                                    operate1.<span class="built_in">putkinds</span>(<span class="string">&quot;盘点入库&quot;</span>);</span><br><span class="line">                                    operate1.<span class="built_in">putnum</span>(num2);</span><br><span class="line">                                    operate1.<span class="built_in">putacount</span>(username);</span><br><span class="line">                                    operate1.<span class="built_in">putdate</span>();</span><br><span class="line">                                    operate1.<span class="built_in">putflag</span>(<span class="number">1</span>);</span><br><span class="line">                                    operationinformation&lt;&lt;operate1.<span class="built_in">getflag</span>()&lt;&lt;endl;</span><br><span class="line">                                    operationinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getkinds</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getnum</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getacount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">25</span>)&lt;&lt;operate1.<span class="built_in">getdate</span>()&lt;&lt;endl;</span><br><span class="line">                                    operationinformation.<span class="built_in">close</span>();</span><br><span class="line">                                    operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">                            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                            <span class="keyword">if</span>(flag2==<span class="number">0</span>)</span><br><span class="line">                                cout&lt;&lt;<span class="string">&quot;系统中没有编号为&quot;</span>&lt;&lt;no1&lt;&lt;<span class="string">&quot;的商品信息,商品盘点失败,请检查后再试&quot;</span>&lt;&lt;endl;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(op4==<span class="number">1</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            flagy=<span class="number">1</span>;</span><br><span class="line">                            cout&lt;&lt;<span class="string">&quot;请输入需要出库的商品编号:&quot;</span>;</span><br><span class="line">                            goods good2;</span><br><span class="line">                            string no1;</span><br><span class="line">                            cin&gt;&gt;no1;</span><br><span class="line">                            <span class="type">int</span> flag2=<span class="number">0</span>;</span><br><span class="line">                            <span class="type">int</span> line=<span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">                            &#123;</span><br><span class="line">                                line++;</span><br><span class="line">                                string no2;</span><br><span class="line">                                goodsinformation&gt;&gt;no2;</span><br><span class="line">                                string name2;</span><br><span class="line">                                goodsinformation&gt;&gt;name2;</span><br><span class="line">                                string count2;</span><br><span class="line">                                goodsinformation&gt;&gt;count2;</span><br><span class="line">                                string price2;</span><br><span class="line">                                goodsinformation&gt;&gt;price2;</span><br><span class="line">                                <span class="type">int</span> num2;</span><br><span class="line">                                goodsinformation&gt;&gt;num2;</span><br><span class="line">                                <span class="keyword">if</span>(goodsinformation.<span class="built_in">eof</span>())<span class="comment">//判断是否读取到文件末尾</span></span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">if</span>(no2==no1)</span><br><span class="line">                                &#123;</span><br><span class="line">                                    flag2=<span class="number">1</span>;</span><br><span class="line">                                    <span class="comment">//出库</span></span><br><span class="line">                                    cout&lt;&lt;<span class="string">&quot;请输入出库量：&quot;</span>;</span><br><span class="line">                                    <span class="type">int</span> num1;</span><br><span class="line">                                    cin&gt;&gt;num1;</span><br><span class="line">                                    <span class="keyword">if</span>(num1&lt;<span class="number">0</span>)</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        cout&lt;&lt;<span class="string">&quot;出库量不能小于零,输入有误,请重新输入出库量:&quot;</span>;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="type">int</span> out=num2-num1;</span><br><span class="line">                                    <span class="keyword">if</span>(out&lt;<span class="number">0</span>)</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        cout&lt;&lt;<span class="string">&quot;库存量不足,无法完成出库操作,请核对后重新输入出库量:&quot;</span>;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    good2.<span class="built_in">putnum</span>(out);</span><br><span class="line">                                    good2.<span class="built_in">putno</span>(no2);</span><br><span class="line">                                    good2.<span class="built_in">putname</span>(name2);</span><br><span class="line">                                    good2.<span class="built_in">putcount</span>(count2);</span><br><span class="line">                                    good2.<span class="built_in">putprice</span>(price2);</span><br><span class="line">                                    <span class="built_in">DelLineData</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>, line);</span><br><span class="line">                                    goodsinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getname</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getcount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getprice</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">10</span>)&lt;&lt;good2.<span class="built_in">getnum</span>()&lt;&lt;endl;</span><br><span class="line">                                    cout&lt;&lt;<span class="string">&quot;商品盘点成功&quot;</span>&lt;&lt;endl;</span><br><span class="line">                                    <span class="comment">//保留操作记录</span></span><br><span class="line">                                    operations operate1;</span><br><span class="line">                                    operate1.<span class="built_in">putno</span>(no2);</span><br><span class="line">                                    operate1.<span class="built_in">putkinds</span>(<span class="string">&quot;盘点出库&quot;</span>);</span><br><span class="line">                                    operate1.<span class="built_in">putnum</span>(num2);</span><br><span class="line">                                    operate1.<span class="built_in">putacount</span>(username);</span><br><span class="line">                                    operate1.<span class="built_in">putdate</span>();</span><br><span class="line">                                    operate1.<span class="built_in">putflag</span>(<span class="number">1</span>);</span><br><span class="line">                                    operationinformation&lt;&lt;operate1.<span class="built_in">getflag</span>()&lt;&lt;endl;</span><br><span class="line">                                    operationinformation&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getno</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getkinds</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getnum</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">15</span>)&lt;&lt;operate1.<span class="built_in">getacount</span>()&lt;&lt;<span class="built_in">setw</span>(<span class="number">25</span>)&lt;&lt;operate1.<span class="built_in">getdate</span>()&lt;&lt;endl;</span><br><span class="line">                                    operationinformation.<span class="built_in">close</span>();</span><br><span class="line">                                    operationinformation.<span class="built_in">open</span>(<span class="string">&quot;operationinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">                            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">                            <span class="keyword">if</span>(flag2==<span class="number">0</span>)</span><br><span class="line">                                cout&lt;&lt;<span class="string">&quot;系统中没有编号为&quot;</span>&lt;&lt;no1&lt;&lt;<span class="string">&quot;的商品信息,商品进货失败,请检查后再试&quot;</span>&lt;&lt;endl;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            cout&lt;&lt;<span class="string">&quot;输入有误,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">                    &#125;</span><br><span class="line">                    flagx=<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(op3==<span class="number">0</span>)</span><br><span class="line">                    flagx=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;输入有误,请重新输入&quot;</span>&lt;&lt;endl;</span><br><span class="line">            &#125;</span><br><span class="line">            goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">            goodsinformation.<span class="built_in">open</span>(<span class="string">&quot;goodsinformation.txt&quot;</span>,ios::in|ios::app);</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op2==<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;正在为您登出中……&quot;</span>;</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">            <span class="keyword">return</span>;         </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;您输入了无效的操作代码,请重新输入&quot;</span>;</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        goodsinformation.<span class="built_in">close</span>();</span><br><span class="line">        operationinformation.<span class="built_in">close</span>();</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>图3.6 “退出登录”功能效果图</em></p>
<p><img src="/images/vendition/3-9.png" alt="10"></p>
<p><em>图3.7 “新增商品种类”功能效果图</em></p>
<p><img src="/images/vendition/3-10.png" alt="11"></p>
<p><img src="/images/vendition/3-11.png" alt="12"></p>
<p><em>图3.8 “删除商品种类”功能效果图</em></p>
<p><img src="/images/vendition/3-12.png" alt="13"></p>
<p><img src="/images/vendition/3-13.png" alt="14"></p>
<p><em>图3.9 “商品进货”功能效果图</em></p>
<p><img src="/images/vendition/3-14.png" alt="15"></p>
<p><img src="/images/vendition/3-15.png" alt="16"></p>
<p><img src="/images/vendition/3-16.png" alt="17"></p>
<p><em>图3.10 “商品销售”功能效果图</em></p>
<p><img src="/images/vendition/3-17.png" alt="18"></p>
<p><img src="/images/vendition/3-18.png" alt="19"></p>
<p><img src="/images/vendition/3-19.png" alt="20"></p>
<p><img src="/images/vendition/3-20.png" alt="21"></p>
<p><em>图3.11 “浏览商品信息”功能效果图</em></p>
<p><img src="/images/vendition/3-21.png" alt="22"></p>
<p><em>图3.12 “显示操作记录”功能效果图</em></p>
<p><img src="/images/vendition/3-22.png" alt="23"></p>
<p><em>图3.13 “盘点”功能效果图</em></p>
<p><img src="/images/vendition/3-23.png" alt="24"></p>
<br>

<h4 id="四、总结"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结</h4><hr>
<p>本文首先对进销存管理业务的现状进行归纳，通过分析目前的进销存管理流程，找出存在的问题和原因，对信息化手段给进销存管理带来的好处进行评估，并制订流程以改进管理方案，从系统功能、性能、运行环境等方面提出进销存管理系统的需求，确定开发方案，本着面向对象编程的核心思想，根据数据结构，找到实体间的关系，细化设计思路，并最终依托命令行界面完成了整个进销存管理系统的设计与实现。 根据需要，本进销存管理系统采用三层架构设计，功能模块涵盖了系统管理与商品信息管理两大板块，采用文本文件作为整个系统的数据库，具有实用性、通用性、使用性、扩充性、安全性能高，维护成本低等优点。</p>
<p>在完成了初版的整体设计以及程序实现之后，又对其各项功能进行了多方面的测试，针对其中不足的方面以及小的漏洞进行了进一步的调试、修正、完善与迭代，目前已经能够正常运行。在整个项目的完成过程中，一方面是对于C++编程语言的掌握在实践中进行又一次的巩固加强，另一方面也是对于面向对象这一重要的程序设计思想的深入体会。</p>
<p>总而言之，个人对于本次进销存管理系统项目的完成度是比较满意的，但目前的系统程序仍然存在着许多问题有待于进一步深入研究与学习。一方面是模块化的程度并没有达到预期的效果，整个程序结构仍然稍显冗长。事实上在整个程序设计过程中，受限于不断要对文件进行读写，很难将每一个选项卡单独拆分出来作为独立的函数，同时对于面向对象过程中类的使用仅仅停留在对于其内部私有成员的封装与访问，而并没有涉及到更进一步的针对于特定对象的函数编写与使用 ，希望之后可以进行进一步的迭代与改进。另一方面，虽然在界面设计时本着简洁实用的思想，但很多流程上以及设计上的细节仍然可以进一步深挖改进，这也需要基于一定的实际投放测试并收集反馈来进行；同时受限于时间紧迫，对于QT图形界面无法进行详细的学习以应用在本项目中，希望如果之后有机会可以基于QT界面对于本进销存管理系统进行进一步的重塑与迭代。</p>
<br>

<h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><hr>
<p>[1]   郭宁 , 郑小玲.管理信息系统[M].北京 : 人民邮电出版社 , 2009.</p>
<p>[2]   刘俊 , 钱瑞明 , 基于 B&#x2F;S 结构、面向供应链的供销管理系统设计[J] , 微计算机管理 , 2004 ( 1 ) : 42-43</p>
<p>[3]   吴雪海.食品公司进销存系统设计与实现[D].导师：赫枫龄;张雪松.吉林大学,2015.</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/03/20/20230320/"><img class="fill" src="/images/story/4.jpg" alt="20230320"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-03-19T16:00:00.000Z" title="2023/3/20 00:00:00">2023-03-20</time>发表</span><span class="level-item"><time dateTime="2023-08-04T03:12:43.283Z" title="2023/8/4 11:12:43">2023-08-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/About-XJH/">About XJH</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/">碎碎念</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/CQU/">CQU</a></span><span class="level-item">5 分钟读完 (大约749个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/20/20230320/">20230320</a></p><div class="content"><p>“十九岁的憔悴<br>朋友 生活从不搭理心结<br>啤酒 笑声和烟<br>朋友 和我聊聊疲倦”<br>——蔡维泽《十九》<br>十四岁的时候第一次听到这首歌，或许那时的我从来不会想到，五年后的自己，会来到这座陌生的城市，开启自己新的生活。<br>可是弹指一挥间，我们就已经长大了。<br>不知道下一次再听到这首歌，想起那个和那些如烟火般绚烂的夏天，又会是谁的十九岁呢？<br>小的时候，觉得大人总是忘记自己的生日是一件特别不可思议的事情。可是，直到一两周之前，我才猛然发现，被忙碌的生活裹挟着的我们，竟也一步步沦为这样的可悲。<br>忙里偷闲，在快节奏的学习生活里学会享受生活的美好与“慢乐”，或许是之后很长一段时间内的人生课题吧。<br>很久没有发过说说了。很大一部分原因是，在经历了那些值得纪念的盛大之后，往往都已经精疲力竭了；而等到精力回复好的时候，却早已失去那股新鲜劲，分享的欲望已不在了。<br>虽然事实上，生活中许多琐碎而有趣的美好瞬间，似乎比那些精彩的活动更加值得纪念。生活着的每一分每一秒，都在真实地塑造着我们每一个人。<br>但是。尽管数不清的琐事和艰巨的项目让空闲显得那么难能可贵，尽管学习的压力逐渐消磨着我们分享与记录的欲望与能力，可值得庆幸的是，当我们还想同感彼此的悲欢，倾诉彼此的心声的时候，你们依然在我的身边，依然是那些最值得分享与信赖的朋友。<br>所以，我仍然觉得我是幸运的。起码，比十九岁的蔡维泽，要幸运很多。<br>希望，在遍体鳞伤之时，我们都能迎来，属于自己的浴火重生。<br>去看更大的世界，体验更缤纷的人生。<br>无限风光在险峰，无限伟岸雄伟壮观，有些路或许一生也难以用脚丈量。<br>那么，就勇敢的向前走吧。<br>再见了，我的十八岁。终究和你迎来告别。<br>你好，十九岁。<br>十九岁的你，应该会比十八岁更厉害吧。<br>但还是希望你，和你的朋友们，健康而快乐地，度过未来的每一天。<br>“我们仍是唱着歌的，不论悲喜的明天。”</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-03-05T05:12:58.000Z" title="2023/3/5 13:12:58">2023-03-05</time>发表</span><span class="level-item"><time dateTime="2023-08-03T09:18:18.757Z" title="2023/8/3 17:18:18">2023-08-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a><span> / </span><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E5%8E%9F%E7%90%86/">工程原理</a></span><span class="level-item">30 分钟读完 (大约4448个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/05/car/">寻迹小车</a></p><div class="content"><h4 id="一、绪论"><a href="#一、绪论" class="headerlink" title="一、绪论"></a>一、绪论</h4><hr>
<h5 id="1-1-实验背景"><a href="#1-1-实验背景" class="headerlink" title="1.1 实验背景"></a>1.1 实验背景</h5><h6 id="1-1-1-问题的情景"><a href="#1-1-1-问题的情景" class="headerlink" title="1.1.1 问题的情景"></a>1.1.1 问题的情景</h6><p>长期以来，由于我国是人口大国而且工业基础薄弱，因此早期在我国机器人的发展受到一定的限制。然而随着制造业工人的人力成本的不断上升与社会自动化程度的不断提高，我国也开始着重于发展机器人，并且也取得了较大的进步。在 1995 年，我国沈阳自动化所开始研制HT—100A点焊机器人，是我国较早的机器人了，如图1所示；此后，沈阳新松公司研发出了6 kg弧焊机器人，此机器人不仅实用，而且轻便，如图 2 所示；之后，哈尔滨工业大学机器 人研究所也研发出了便携式机器人，此机器人具有 6 自由度，增强了焊接能力，成为在恶劣环境中实现焊接功能的重要设备。总之，在国家“863 计划”与“十一五”计划的指导下，我国机器人的设计取得了飞速发 展，甚至在机器人的某些关键部件的设计已经接近于世界先进水平，并在世界工业机器人领域已经占有一席之地了。</p>
<p><img src="/images/car/1.png" alt="1"></p>
<p><img src="/images/car/2.png" alt="2"></p>
<h6 id="1-1-2-实验的目的"><a href="#1-1-2-实验的目的" class="headerlink" title="1.1.2 实验的目的"></a>1.1.2 实验的目的</h6><p>目前，机器人的发展趋势非常的迅猛，机器人可以替代人类去从事高危险的工作，减轻了人类的劳动强度。本文通过对机器人的发展史进行简要的介绍，阐明了我国发展机器人的必要性。同时，对于我国的发展而言，我国正处于工业化进程的关键时期，将来的高强度、高危险行业的工人数量将会急剧的下降，机器人将会迎来新的“春天”，所以机器人的发展仍拥有巨大的发展空间。同时，由于我国各机器人的厂商对于机器人的研发能力与金钱投资的不同，在我国的机器人市场上的竞争也会愈演愈烈，最终也将形成我国的机器人研发市场。总之，在未来的几十年里，相信重点发展机器人将会成为社会的发展趋势，不久机器人将会引领未来，加入到我国现代化建设的行列中。小车，也就是轮式机器人，作为以学科交叉、产品创新为特色的明月班同学，切入这个产业不失为优秀的选择，故而选取小车为切入点了解相关知识。</p>
<h5 id="1-2-实验内容"><a href="#1-2-实验内容" class="headerlink" title="1.2 实验内容"></a>1.2 实验内容</h5><h6 id="1-2-1-使用51单片机控制及其元器件"><a href="#1-2-1-使用51单片机控制及其元器件" class="headerlink" title="1.2.1 使用51单片机控制及其元器件"></a>1.2.1 使用51单片机控制及其元器件</h6><p>STC89C52控制板芯片、1.5V干电池x4、L298N电机驱动板x1、红外循迹模块、直流电机x2以及搭建材料若干；</p>
<p><img src="/images/car/3.jpg" alt="3"></p>
<h6 id="1-2-2使用FPGA开发板控制及其元器件"><a href="#1-2-2使用FPGA开发板控制及其元器件" class="headerlink" title="1.2.2使用FPGA开发板控制及其元器件"></a>1.2.2使用FPGA开发板控制及其元器件</h6><p>Cyclonell EP2C5T144控制板芯片1.5V干电池x4、L298N电机驱动板x1、红外循迹模块、直流电机x2以及搭建材料若干；</p>
<p><img src="/images/car/4.jpg" alt="4"></p>
<br>

<h4 id="二、实现过程"><a href="#二、实现过程" class="headerlink" title="二、实现过程"></a>二、实现过程</h4><hr>
<h5 id="2-1-总体工作原理简释"><a href="#2-1-总体工作原理简释" class="headerlink" title="2.1 总体工作原理简释"></a>2.1 总体工作原理简释</h5><h6 id="2-1-2-红外循迹模块"><a href="#2-1-2-红外循迹模块" class="headerlink" title="2.1.2 红外循迹模块"></a>2.1.2 红外循迹模块</h6><p>第一步，位于小车前端的红外模块会释放红外线探测下方是否为黑色区域，并将相应的高低电平信号传递至控制模块（51单片机&#x2F;FPGA开发板）处理，控制模块随后将发送信息至L298N电机驱动的控制模块，并由此控制左右两轮的转动速度以及转动方向，从而实现对黑线的反应和循迹。</p>
<p>作为电机的驱动模块，该模块对控制小车移动有着重要且直接的作用。</p>
<p><img src="/images/car/5.png" alt="5"></p>
<p>利用红外发射器向地面发射红外线，并用传感器接收由地面反射的红外线。当红外接收模块下方为黑色轨迹时，红外线被黑色轨迹吸收，传感器没有接收到红外线，红外循迹模块输出低电平到单片机。反之，传感器接收到红外线，红外循迹模块输出高电平到单片机。可通过红外循迹模块输出的信号来判断小车是否偏离轨迹。可调电阻可以调节传感器的灵敏度，易于调试。使用红外循迹模块方案也易于实现，红外循迹方案相比于摄像循迹成本更加便宜，软件设计更加简单，设计制作周期短，具备一定可靠性。</p>
<p>对于左电机，共有输入ENA、IN1、IN2，输出OUT1（黑线）、OUT2（红线）、其信号与运动对应如下：（0,X,X）停止、（1,0,0）停止、（1,1,0）正传、（1,0,1）反转、（1,1,1）停止；</p>
<p>对于右电机，共有输入ENB、IN3、IN4，输出OUT3（黑线）、OUT4（红线），其信号与运动对应如下：（0,X,X）停止、（1,0,0）停止、（1,1,0）反传、（1,0,1）正转、（1,1,1）停止。</p>
<h6 id="2-1-3-L298N电机驱动模块"><a href="#2-1-3-L298N电机驱动模块" class="headerlink" title="2.1.3 L298N电机驱动模块"></a>2.1.3 L298N电机驱动模块</h6><p><img src="/images/car/6.jpg" alt="6"></p>
<p>L298N是ST公司的一款电机驱动芯片，也是集成了双H桥，但与上面两个略有不同。电机驱动电压3~48V；可持续工作的输出电流为2A，峰值可达3A。如上图，L298N模块明显有较多的外接元件，这与L298N的内部结构有关。如上图，由于该芯片在H桥上的损耗严重发热较明显（饱和压降大），需要加装散热片，因此在使用上比前两个芯片复杂，体积也相对较大。其各引脚如下图所示。</p>
<p><img src="/images/car/7.png" alt="7"></p>
<h5 id="2-2-使用51单片机部分"><a href="#2-2-使用51单片机部分" class="headerlink" title="2.2 使用51单片机部分"></a>2.2 使用51单片机部分</h5><h6 id="2-2-1-硬件接线"><a href="#2-2-1-硬件接线" class="headerlink" title="2.2.1 硬件接线"></a>2.2.1 硬件接线</h6><p><img src="/images/car/8.png" alt="8"></p>
<p><img src="/images/car/9.png" alt="9"></p>
<p>1为电源输入，与电池盒的输出线相连；2为电源输出，3为驱动板输入，两者需要相连，注意红线为VCC，黑线为GND；4 为单片机IO口引脚，5为驱动板的IN1到 IN4以及ENA和ENB，按照器件上的标注对应连接即可。 6 为与循迹模块的对应接口，按照器件上的标注对应连接即可。 7 和 8 为驱动板与两个电机之间的连线，按照上图所示连接即可。 到这里，基本完成了小车的硬件组装与线路连接，小车要完成循迹进行这些连线就够了，不过在烧录程序到单片机中时还需要 额外的连线，这个将在后面进行说明。</p>
<p>供电上使用四节5号电池。</p>
<h6 id="2-2-2-程序设计"><a href="#2-2-2-程序设计" class="headerlink" title="2.2.2 程序设计"></a>2.2.2 程序设计</h6><p>首先是如何处理红外模块的探测结果。我们需要先对结果进行编码。我们记没有识别到黑线为0，识别到为1，则我们需要一个算式来囊括左右传感器结果并能对不同情况进行表示。在这里，我们记data2为左边的结果，data3为右边的结果，现给出算式data1&#x3D;data2*10+data3，data1即检测结果。根据data2、data3不同组合：（1,1）在黑线上；（1,0）略向右偏离；（0,1）略向左偏离；（0,0）完全偏离轨道，分别对应了data1的四个取值，即11、10、1、0，亦即四种情况。相应的，我们需要做出四种反馈，即“前进”、“左转”、“右转”、“停下”。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span><span class="comment">//51头文件</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> pwm\_val\_left, pwm\_val\_right; <span class="comment">//中间变量</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> pwm\_left, pwm\_right; <span class="comment">//定义PWM输出高电平的时间的变量（用户操作PWM的变量）</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PWM\_DUTY 100 <span class="comment">//定义PWM的周期，数值为定时器0溢出周期，假如定时器溢出时间为100us，则PWM周期为10ms。</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PWM\_HIGH\_MIN 35 <span class="comment">//限制PWM输出的最小占空比</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PWM\_HIGH\_MAX PWM\_DUTY <span class="comment">//限制PWM输出的最大占空比</span></span></span><br><span class="line"></span><br><span class="line">/\*电机驱动IO定义\*/</span><br><span class="line">sbit leftMotorPwm = P1^<span class="number">5</span>; <span class="comment">//为1 左电机使能</span></span><br><span class="line">sbit IN1 = P1^<span class="number">4</span>; <span class="comment">//为1 左电机正转</span></span><br><span class="line">sbit IN2 = P1^<span class="number">3</span>; <span class="comment">//为1 左电机反转</span></span><br><span class="line">sbit IN3 = P1^<span class="number">2</span>; <span class="comment">//为1 右电机反转</span></span><br><span class="line">sbit IN4 = P1^<span class="number">1</span>; <span class="comment">//为1 右电机正转</span></span><br><span class="line">sbit rightMotorPwm = P1^<span class="number">0</span>; <span class="comment">//为1 右电机使能</span></span><br><span class="line"></span><br><span class="line">sbit leftSensor = P3^<span class="number">4</span>;<span class="comment">//左传感器：为0没有识别到黑线，为1识别到黑线</span></span><br><span class="line">sbit rightSensor = P3^<span class="number">5</span>;<span class="comment">//右传感器：为0没有识别到黑线，为1识别到黑线</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> Timer0\_Init(<span class="type">void</span>); <span class="comment">//定时器初始化</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">LoadPWM</span><span class="params">(<span class="type">void</span>)</span>;<span class="comment">//装入PWM输出值</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">forward</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span>;<span class="comment">//前进</span></span><br><span class="line"><span class="type">void</span> left\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed);<span class="comment">//左转</span></span><br><span class="line"><span class="type">void</span> right\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed);<span class="comment">//右转</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">back</span><span class="params">(<span class="type">void</span>)</span>;<span class="comment">//后退修正</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Tracking</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//为0 没有识别到黑线 为1识别到黑线</span></span><br><span class="line"><span class="type">char</span> data1, data2 = leftSensor,data3 = rightSensor;</span><br><span class="line">data1 = data2\*<span class="number">10</span>+data3;</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">11</span>)<span class="comment">//在黑线上，前进</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//forward(120,120);//前进</span></span><br><span class="line">forward(<span class="number">70</span>,<span class="number">70</span>);<span class="comment">//前进</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">10</span>)<span class="comment">//小幅偏右，左转</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//left\_run(80,160);//左转</span></span><br><span class="line">left\_run(<span class="number">70</span>,<span class="number">70</span>);<span class="comment">//左转</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">1</span>)<span class="comment">//小幅偏左，右转</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//right\_run(160,80);//右转</span></span><br><span class="line">right\_run(<span class="number">70</span>,<span class="number">70</span>);<span class="comment">//右转</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(data1 == <span class="number">0</span>)<span class="comment">//大幅偏左或偏右，已脱离轨道</span></span><br><span class="line">&#123;</span><br><span class="line">back();<span class="comment">//后退校正</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/\*主函数\*/</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">Timer0\_Init();<span class="comment">//定时0初始化</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">Tracking();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">forward</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed,<span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span></span><br><span class="line">&#123;</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">1</span>;</span><br><span class="line">IN2 = <span class="number">0</span>;</span><br><span class="line">IN3 = <span class="number">0</span>;</span><br><span class="line">IN4 = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> left\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span><br><span class="line">&#123;</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">1</span>;</span><br><span class="line">IN2 = <span class="number">0</span>;</span><br><span class="line">IN3 = <span class="number">1</span>;</span><br><span class="line">IN4 = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> right\_run(<span class="type">unsigned</span> <span class="type">char</span> LeftSpeed, <span class="type">unsigned</span> <span class="type">char</span> RightSpeed)</span><br><span class="line">&#123;</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">0</span>;</span><br><span class="line">IN2 = <span class="number">1</span>;</span><br><span class="line">IN3 = <span class="number">0</span>;</span><br><span class="line">IN4 = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">back</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">pwm\_left = LeftSpeed,pwm\_right = RightSpeed;<span class="comment">//设置速度</span></span><br><span class="line">IN1 = <span class="number">0</span>;</span><br><span class="line">IN2 = <span class="number">1</span>;</span><br><span class="line">IN3 = <span class="number">1</span>;</span><br><span class="line">IN4 = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Timer0初始化\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/</span><br><span class="line"><span class="type">void</span> Timer0\_Init(<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">TMOD |= <span class="number">0x02</span>;<span class="comment">//定时器0，8位自动重装模块</span></span><br><span class="line">TH0 = <span class="number">164</span>;</span><br><span class="line">TL0 = <span class="number">164</span>;<span class="comment">//11.0592M晶振，12T溢出时间约等于100微秒</span></span><br><span class="line">TR0 = <span class="number">1</span>;<span class="comment">//启动定时器0</span></span><br><span class="line">ET0 = <span class="number">1</span>;<span class="comment">//允许定时器0中断</span></span><br><span class="line">EA = <span class="number">1</span>;<span class="comment">//总中断允许</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Timer0中断函数\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/</span><br><span class="line"><span class="type">void</span> timer0\_int (<span class="type">void</span>) interrupt <span class="number">1</span></span><br><span class="line">&#123;</span><br><span class="line">pwm\_val\_left++;</span><br><span class="line">pwm\_val\_right++;</span><br><span class="line"><span class="keyword">if</span>(pwm\_left &gt; PWM\_HIGH\_MAX) pwm\_left = PWM\_HIGH\_MAX; <span class="comment">//如果左输出写入大于最大占空比数据，则强制为最大占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_left &lt; PWM\_HIGH\_MIN) pwm\_left = PWM\_HIGH\_MIN; <span class="comment">//如果左输出写入小于最小占空比数据，则强制为最小占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_right &gt; PWM\_HIGH\_MAX) pwm\_right = PWM\_HIGH\_MAX; <span class="comment">//如果右输出写入大于最大占空比数据，则强制为最大占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_right &lt; PWM\_HIGH\_MIN) pwm\_right = PWM\_HIGH\_MIN; <span class="comment">//如果右输出写入小于最小占空比数据，则强制为最小占空比。</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_left&lt;=pwm\_left) leftMotorPwm = <span class="number">1</span>; <span class="comment">//装载左PWM输出高电平时间</span></span><br><span class="line"><span class="keyword">else</span> leftMotorPwm = <span class="number">0</span>; <span class="comment">//装载左PWM输出低电平时间</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_left&gt;=PWM\_DUTY) pwm\_val\_left = <span class="number">0</span>; <span class="comment">//如果左对比值大于等于最大占空比数据，则为零</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_right&lt;=pwm\_right) rightMotorPwm = <span class="number">1</span>; <span class="comment">//装载右PWM输出高电平时间</span></span><br><span class="line"><span class="keyword">else</span> rightMotorPwm = <span class="number">0</span>; <span class="comment">//装载右PWM输出低电平时间</span></span><br><span class="line"><span class="keyword">if</span>(pwm\_val\_right&gt;=PWM\_DUTY) pwm\_val\_right = <span class="number">0</span>; <span class="comment">//如果右对比值大于等于最大占空比数据，则为零</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-3-使用FPGA开发板部分"><a href="#2-3-使用FPGA开发板部分" class="headerlink" title="2.3 使用FPGA开发板部分"></a>2.3 使用FPGA开发板部分</h5><h6 id="2-3-1-硬件接线"><a href="#2-3-1-硬件接线" class="headerlink" title="2.3.1 硬件接线"></a>2.3.1 硬件接线</h6><p>系统时钟和复位信号必须为PIN17和PIN_90，不过这两个引脚在开发板上已经连接上了，无须手动连接。其它的引脚可以在下表中“FPGA引出I&#x2F;O”部分选择即可，然后参照之间的51单片机进行连接。</p>
<p>此处附上接线实物图，需要注意的是，FPGA需要独立的接线供电，如充电宝等等。</p>
<p><img src="/images/car/10.jpg" alt="10"></p>
<h6 id="2-3-2程序设计"><a href="#2-3-2程序设计" class="headerlink" title="2.3.2程序设计"></a>2.3.2程序设计</h6><p>逻辑上大体与51相同，此处附上代码部分以及引脚的设置图。</p>
<p><img src="/images/car/11.jpg" alt="11"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">LIBRARY ieee;</span><br><span class="line">USE ieee.<span class="built_in">std</span>\_logic\_1164.all;</span><br><span class="line">ENTITY cartracking IS</span><br><span class="line"><span class="title function_">GENERIC</span> <span class="params">(</span></span><br><span class="line"><span class="params">--时钟为<span class="number">50</span>MHz，为了产生<span class="number">100</span>Hz的PWM波，设置计数值为<span class="number">500000</span></span></span><br><span class="line"><span class="params">cnt\_meta : INTEGER := <span class="number">500000</span>;</span></span><br><span class="line"><span class="params">--对应了停止、前进、左转、右转状态IN4到IN1的输出</span></span><br><span class="line"><span class="params">Back : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">&quot;0110&quot;</span>;</span></span><br><span class="line"><span class="params">Forward : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">&quot;1001&quot;</span>;</span></span><br><span class="line"><span class="params">Left\_Go : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">&quot;0101&quot;</span>;</span></span><br><span class="line"><span class="params">Right\_Go : STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>) := <span class="string">&quot;1010&quot;</span></span></span><br><span class="line"><span class="params">)</span>;</span><br><span class="line"></span><br><span class="line">--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*输入输出端口\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*</span><br><span class="line">PORT (</span><br><span class="line">sys\_clk : IN STD\_LOGIC;</span><br><span class="line">sys\_rst\_n : IN STD\_LOGIC;</span><br><span class="line">infrared : IN STD\_LOGIC\_VECTOR(<span class="number">1</span> DOWNTO <span class="number">0</span>);</span><br><span class="line">pwm\_left : OUT STD\_LOGIC;</span><br><span class="line">pwm\_right : OUT STD\_LOGIC;</span><br><span class="line">in\_motor : OUT STD\_LOGIC\_VECTOR(<span class="number">3</span> DOWNTO <span class="number">0</span>)</span><br><span class="line">);</span><br><span class="line">END cartracking;</span><br><span class="line"></span><br><span class="line">ARCHITECTURE trans OF cartracking IS</span><br><span class="line">SIGNAL cnt : INTEGER;</span><br><span class="line">SIGNAL duty\_left : INTEGER;</span><br><span class="line">SIGNAL duty\_right : INTEGER;</span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">PROCESS</span> <span class="params">(sys\_rst\_n, infrared)</span></span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(sys\_rst\_n = <span class="string">&#x27;0&#x27;</span>)</span> THEN</span><br><span class="line">duty\_right &lt;= <span class="number">60</span>;</span><br><span class="line">duty\_left &lt;= <span class="number">60</span>;</span><br><span class="line">ELSE</span><br><span class="line">CASE infrared IS</span><br><span class="line">WHEN <span class="string">&quot;00&quot;</span> =&gt;</span><br><span class="line">in\_motor &lt;= Back;--后退</span><br><span class="line">WHEN <span class="string">&quot;01&quot;</span> =&gt;</span><br><span class="line">in\_motor &lt;= Right\_Go;--右转</span><br><span class="line">--PWM波的占空比，应设置合适的值来控制小车的转速，为了在仿真时可以对比，特将左右轮设置了不同的占空比。</span><br><span class="line">duty\_left &lt;= <span class="number">35</span>;</span><br><span class="line">duty\_right &lt;= <span class="number">55</span>;</span><br><span class="line">WHEN <span class="string">&quot;10&quot;</span> =&gt;</span><br><span class="line">in\_motor &lt;= Left\_Go;--左转</span><br><span class="line">duty\_left &lt;= <span class="number">55</span>;</span><br><span class="line">duty\_right &lt;= <span class="number">35</span>;</span><br><span class="line">WHEN OTHERS =&gt;</span><br><span class="line">in\_motor &lt;= Forward;--前进</span><br><span class="line">duty\_left &lt;= <span class="number">50</span>;</span><br><span class="line">duty\_right &lt;= <span class="number">50</span>;</span><br><span class="line">END CASE;</span><br><span class="line">END IF;</span><br><span class="line">END PROCESS;</span><br><span class="line"></span><br><span class="line">PROCESS (sys\_clk, sys\_rst\_n)</span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(sys\_rst\_n = <span class="string">&#x27;0&#x27;</span>)</span> THEN</span><br><span class="line">cnt &lt;= <span class="number">0</span>;</span><br><span class="line">ELSIF (sys\_clk<span class="number">&#x27;</span>EVENT AND sys\_clk = <span class="string">&#x27;1&#x27;</span>) THEN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(cnt = cnt\_meta)</span> THEN</span><br><span class="line">cnt &lt;= <span class="number">0</span>;</span><br><span class="line">ELSE</span><br><span class="line">cnt &lt;= cnt + <span class="number">1</span>;</span><br><span class="line">END IF;</span><br><span class="line">END IF;</span><br><span class="line">END PROCESS;</span><br><span class="line"></span><br><span class="line">PROCESS (sys\_clk, sys\_rst\_n)</span><br><span class="line">BEGIN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(sys\_rst\_n = <span class="string">&#x27;0&#x27;</span>)</span> THEN</span><br><span class="line">pwm\_left &lt;= <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">pwm\_right &lt;= <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">ELSIF (sys\_clk<span class="number">&#x27;</span>EVENT AND sys\_clk = <span class="string">&#x27;1&#x27;</span>) THEN</span><br><span class="line"><span class="title function_">IF</span> <span class="params">(cnt &gt;= (cnt\_meta / <span class="number">100</span>)\* duty\_left)</span> THEN</span><br><span class="line">pwm\_left &lt;= <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">ELSE</span><br><span class="line">pwm\_left &lt;= <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">END IF;</span><br><span class="line">IF (cnt &gt;= (cnt\_meta / <span class="number">100</span>) \* duty\_right) THEN</span><br><span class="line">pwm\_right &lt;= <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">ELSE</span><br><span class="line">pwm\_right &lt;= <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">END IF;</span><br><span class="line">END IF;</span><br><span class="line">END PROCESS;</span><br><span class="line">END trans;</span><br></pre></td></tr></table></figure>

<br>

<h4 id="3调试及优化"><a href="#3调试及优化" class="headerlink" title="3调试及优化"></a>3调试及优化</h4><hr>
<h5 id="3-1简单优化"><a href="#3-1简单优化" class="headerlink" title="3.1简单优化"></a>3.1简单优化</h5><p>由于在测试时需要在保证小车前进速度的同时兼顾其转弯的效率和稳定性，特别是如果直行时转速过快会导致小车在转弯时直接冲出赛道而无法循迹。在原本的设计中，我们将未识别到黑线的反应设置为电机停转而使得小车停止，而这会使得小车无法在冲出赛道后进行自我校正。因此，我们将未识别到黑线时的输出信号由“0000”改为“0110”，即使得左右电机均由原本的停转改为反转，从而实现循迹过程中对于轨道循迹的自我修正。</p>
<p>在 PWM 频率设置的时候， PWM 的频率太低可能导致电机转动不稳定，不 是匀速转动，而 PWM 频率过高可能导致电机反应不过来或者超过电路的上限截止频率。事实上，考虑到转弯过程的稳定性与速度问题，包括与直行过程的速度以及传感器的灵敏度调节配合，我们需要通过实际测试来进一步确定在直行、左转、右转和倒退过程中设定的PWM占空比与转速。具体在调试之后所得到的合适参数已经在上面的代码中有所体现，在此不过多赘述。</p>
<p><img src="/images/car/12.png" alt="12"></p>
<p><img src="/images/car/13.png" alt="13"></p>
<h5 id="3-2调试过程"><a href="#3-2调试过程" class="headerlink" title="3.2调试过程"></a>3.2调试过程</h5><p>考虑到验收时的重要评判标准是小车循迹一周的时间，且小车本身运动缓慢，我们首先将目光放在了转速的提高上。修改参数大幅提高了轮子的转速后，我们进行了一次实验：结果出乎意料，小车非但没有预想的那样，反而在行进的过程中持续摇摆。分析原因是行进角度不平行于轨道时容易冲出轨道，后续针对此原因，在红外灵敏度以及直行、左转、右转和倒退过程中设定的PWM占空比与转速多次调试与测试。中途红外模块损坏，经过排查确定后更换了新的。此外，我们注意到行进中的不稳定性还来自于万向轮的松散，我们尝试了不限于胶带、缠绳等各种方式加以限制，效果均不理想，虽然直道可以稳定快速行进，转弯却尤为吃力。</p>
<p>最后51的部分取得了第二名的不错成绩。但是FPGA部分却难遂人意。我们一直将注意力放在数据的调试上却忽略了时间的把控，以至于直到最后快结束才仓促进行测试，测试时还发生了接线断开等突发状况。我们本着希望更加灵活的愿望想别的同学借来充电宝供电，没想到这成为了测试失败的最大缘由——充电宝供电严重不足，导致小车行进乏力，但等到我们重新接上电脑供电确认可以正常运行时，却被告知时间已到，不允许再次测试以保证公平。最后无奈接受这个最慢的成绩。</p>
<br>

<h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><hr>
<p>[1] 默默无闻小菜鸡. 电机驱动芯片（H桥、直流电机驱动方式）——DRV8833、TB6612、A4950、L298N的详解与比较[EB&#x2F;OL]. <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44897194/article/details/105524808">https://blog.csdn.net/qq_44897194/article/details/105524808</a>, 2020-5-11.</p>
<p>[2] 周海,叶兵. 机器人的发展现状及应用前景[J]. <a target="_blank" rel="noopener" href="https://kns.cnki.net/kcms2/article/abstract?v=3uoqIhG8C44YLTlOAiTRKibYlV5Vjs7iAEhECQAQ9aTiC5BjCgn0Rn5ykE3W8_mbbrKtMuQk3r9gP-p4derKJErhs1XrNO9Y&uniplatform=NZKPT">https://kns.cnki.net/kcms2/article/abstract?v=3uoqIhG8C44YLTlOAiTRKibYlV5Vjs7iAEhECQAQ9aTiC5BjCgn0Rn5ykE3W8_mbbrKtMuQk3r9gP-p4derKJErhs1XrNO9Y&amp;uniplatform=NZKPT</a>, 2017-6-18.</p>
<br>

<h4 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h4><hr>
<p>感谢老师们在本课程中的精心准备与付出。在数电和模电部分得到了曾正教授和袁刚教授的悉心教诲，在后续的项目部分得到了李敏教授和凌睿教授的认真指导，最终得以基本实现预定目标，特此鸣谢！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-11T15:23:03.000Z" title="2023/2/11 23:23:03">2023-02-11</time>发表</span><span class="level-item"><time dateTime="2023-08-04T05:43:29.521Z" title="2023/8/4 13:43:29">2023-08-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a><span> / </span><a class="link-muted" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/">线性代数</a></span><span class="level-item">几秒读完 (大约75个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/11/facerecognition/">人脸识别项目</a></p><div class="content"><p>本项目全部代码已同步上传至Github,仓库链接：<a target="_blank" rel="noopener" href="https://github.com/Asgard-Tim/face_recoginition">Asgard-Tim&#x2F;face_recoginition: 重庆大学明月科创实验班线性代数课程项目 (github.com)</a></p>
<p>使用方法与识别效果如下。</p>
<p><img src="/images/face/1.png" alt="1"></p>
<p><img src="/images/face/2.png" alt="2"></p>
<p><img src="/images/face/3.png" alt="3"></p>
<p><img src="/images/face/4.png" alt="4"></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/01/20230101/"><img class="fill" src="/images/story/5.jpg" alt="20230101"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-12-31T16:00:00.000Z" title="2023/1/1 00:00:00">2023-01-01</time>发表</span><span class="level-item"><time dateTime="2023-08-04T03:12:59.626Z" title="2023/8/4 11:12:59">2023-08-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/About-XJH/">About XJH</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/">碎碎念</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/CQU/">CQU</a></span><span class="level-item">7 分钟读完 (大约1047个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/01/20230101/">20230101</a></p><div class="content"><p>“天空不留下我的痕迹，但我已经飞过。”<br>我们或许都只是漫漫岁月长河之中的过客罢了。<br>好像是在重庆的某个瞬间，看到手机上苏州地铁S1线23年底有望开通的时候，才突然想起来，好像已经是2022年了。<br>小的时候看新闻夜班车说十年之后苏州会有一条地铁叫S1，可以直接从苏州乘到上海，那个时候觉得这是多么的不可思议，而十年又是多么漫长。<br>却是一眨眼就来到。<br>即使是现在，想想这一年过来仍然是做梦一般。零模之后是为了HanYu而疯狂的一整个冬天和4A＜的遗憾收场，然后是疫情打乱了所有人的步伐顺便毁掉了最后的春天和最后的樱花。昙花一现之后是低谷，站起来之后再倒下然后再是拼命爬起，高考最终还是猝不及防地如期而至。接着就是混乱之夏。兴奋、焦急、离别、泪水、遗憾、愤怒、纠结、不甘与沉沦，这些词语交织在一起，连同着记忆中的那片园子和那些这辈子都不会忘记的好朋友，共同埋葬了整个夏天和整个青春。但时光从不让我们做好准备，金秋九月大学的生活依旧虽迟但到，我们被迫分别，终究还是离开了这个学习生活了十余载的故乡，来到了陌生的城市，对于新的生活与新的世界充满了美好的幻想，却仍然被最后的疫情击得粉碎碎。所有的尝试与冲撞终究败给了现实，所幸热爱可抵岁月漫长。国庆节的二次选拔充满了戏剧性，从满怀期待到心慌意乱再到欣喜若狂却终究败兴而归然后是重整行装东山再起最终还是不负众望，一切都是命运最好的安排。紧接着迎来的就是一段“痛并快乐着”的忙碌生活，充实快乐与疲惫不堪裹挟着我们每一个人，最后还是被返乡的风吹回县城，小阳人终于迎来了久违的安逸与平静。<br>把这一年的故事讲完，我的内心静如止水。或者是释怀，或许是淡然，但所有的轰轰烈烈都是那么刻骨铭心，我们也终究要告别热烈的过去，奔赴更加美好的未来。<br>没有遗憾是不可能的，但过往的挫败从来不妨碍我们继续向前奋力奔跑，不是吗？朝着更美好的明天。<br>生命的意义，就是即使知晓痛苦的结局，依然向着命运抗争。<br>“你无法阻止波涛汹涌，但你可以学会踏浪而行。”<br>卑微的起点会促使你开始一件事，但是让你坚持下来的，一定是热情和使命。<br>生命要么是一场伟大的冒险，要么什么都不是。<br>All in, or nothing.<br>悟已往之不谏，知来者之可追。<br>钟表能回到原点，但不再是昨天。<br>所以我们从不后悔，也从不停止向前。<br>没有借口。下次人山人海，我会站上去。<br>“祝愿祖国繁荣昌盛、国泰民安！祝愿世界和平美好、幸福安宁！祝愿大家新年快乐、皆得所愿！”<br>那么，就是2023了。<br>这一年，又会发生些什么呢？我也不知道。<br>但我唯一知道的是，你们肯定还在，还在我的身边。<br>岂曰无衣，与子同袍。<br>兄弟们天下无敌！<br>新年快乐！</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/10/09/20221009/"><img class="fill" src="/images/story/6.jpg" alt="20221009"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-10-09T12:00:00.000Z" title="2022/10/9 20:00:00">2022-10-09</time>发表</span><span class="level-item"><time dateTime="2023-08-04T03:11:44.295Z" title="2023/8/4 11:11:44">2023-08-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/About-XJH/">About XJH</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/">碎碎念</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/CQU/">CQU</a></span><span class="level-item">几秒读完 (大约98个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/10/09/20221009/">20221009</a></p><div class="content"><p>“热爱可抵岁月漫长。”<br>生命要么是一场伟大的冒险，要么什么都不是。<br>生命的意义，就是即使知晓痛苦的结局，依然向着命运抗争。<br>“你无法阻止波涛汹涌，但你可以学会踏浪而行。”<br>努力终会有回报，我用歌声来证明！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-10-04T11:31:00.000Z" title="2022/10/4 19:31:00">2022-10-04</time>发表</span><span class="level-item"><time dateTime="2023-08-04T03:11:41.121Z" title="2023/8/4 11:11:41">2023-08-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/About-XJH/">About XJH</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/">碎碎念</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/CQU/">CQU</a></span><span class="level-item">2 分钟读完 (大约231个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/10/04/20221004/">20221004</a></p><div class="content"><p>昂首阔步向前走，向着过去挥挥手。<br>当然这远远不够，往前走之后你还要跳跃，这个跳跃就是信仰。<br>荒谬就是理性遇到了终点，但理性的终点就是信仰的起点。<br>人类社会一路走来，过去我们看到雷鸣电闪，我们有了神话；后来我们看到战争，我们遇到了宗教；现代人遭遇了生活的荒谬，我们有了哲学。<br>我们从来没有放弃过信仰，尤其是对苦难的信仰。<br>多难兴邦，天将降大任于斯人也。<br>这跟享受荒谬一样，是多么反直觉的答案，但这个答案就叫做信仰。<br>我们必须从苦难中汲取营养，因为只有享受苦难，我们才能享受生活。</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/09/25/20220925/"><img class="fill" src="/images/story/7.jpg" alt="20220925"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-09-25T08:16:00.000Z" title="2022/9/25 16:16:00">2022-09-25</time>发表</span><span class="level-item"><time dateTime="2023-08-04T03:25:19.685Z" title="2023/8/4 11:25:19">2023-08-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/About-XJH/">About XJH</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/">碎碎念</a><span> / </span><a class="link-muted" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/CQU/">CQU</a></span><span class="level-item">1 分钟读完 (大约183个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/09/25/20220925/">20220925</a></p><div class="content"><p>年轻的躯体里充斥着自由的空气，随着血液氤氲扩散，遍布每一个细胞。它们贪婪地吮吸着，破晓前最后的黑暗。他们知道，走过这漫漫长夜，明天曙光就会照耀整个大地。<br>#重启线下课#<br>谁能想到，半个下午找完了所有要上课的教结果室发现才走了学校的一半还不到<br>谁又能想到，从教学楼的二楼走楼梯上楼，楼上居然还是二楼<img src="http://qzonestyle.gtimg.cn/qzone/em/e114.png"><br>但宿舍楼下就有钢琴我是真的会爱住<br>那我们就明天见咯<img src="http://qzonestyle.gtimg.cn/qzone/em/e271.png"></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/">上一页</a></div><div class="pagination-next is-invisible is-hidden-mobile"><a href="/page/3/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link is-current" href="/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/head.jpg" alt="明诚"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">明诚</p><p class="is-size-6 is-block">走过的路，每一步都算数。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>江苏 苏州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">20</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">28</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Asgard-Tim" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Asgard-Tim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://www.weibo.com/u/6315188431"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://space.bilibili.com/171895120"><i class="fab fa-bilibili"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://jaguarliu.me/ai-projects" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">AI-Tools</span></span><span class="level-right"><span class="level-item tag">jaguarliu.me</span></span></a></li><li><a class="level is-mobile" href="https://zlibrary-east.se/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Zlibrary</span></span><span class="level-right"><span class="level-item tag">zlibrary-east.se</span></span></a></li><li><a class="level is-mobile" href="https://www.cnki.net/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CNKI</span></span><span class="level-right"><span class="level-item tag">www.cnki.net</span></span></a></li><li><a class="level is-mobile" href="https://chat.openai.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ChatGPT</span></span><span class="level-right"><span class="level-item tag">chat.openai.com</span></span></a></li><li><a class="level is-mobile" href="https://www.iodraw.com/tool/sketch" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">照片转素描</span></span><span class="level-right"><span class="level-item tag">www.iodraw.com</span></span></a></li><li><a class="level is-mobile" href="https://www.integral-calculator.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">积分计算器</span></span><span class="level-right"><span class="level-item tag">www.integral-calculator.com</span></span></a></li><li><a class="level is-mobile" href="https://cli.im/text" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">二维码生成器</span></span><span class="level-right"><span class="level-item tag">cli.im</span></span></a></li><li><a class="level is-mobile" href="https://tool.sacdr.net/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">音乐解锁</span></span><span class="level-right"><span class="level-item tag">tool.sacdr.net</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/About-XJH/"><span class="level-start"><span class="level-item">About XJH</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"><span class="level-start"><span class="level-item">碎碎念</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul><li><a class="level is-mobile" href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/CQU/"><span class="level-start"><span class="level-item">CQU</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">个人项目</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">动手学深度学习</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">课程项目</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%AE%9A%E9%87%8F%E5%B7%A5%E7%A8%8B%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95I/"><span class="level-start"><span class="level-item">定量工程设计方法I</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E5%8E%9F%E7%90%86/"><span class="level-start"><span class="level-item">工程原理</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">工程设计</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"><span class="level-start"><span class="level-item">线性代数</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">软件设计</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2023/10/05/3.%E7%BA%BF%E6%80%A7%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><img src="/images/phi.png" alt="3.线性神经网络"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-10-05T08:20:00.000Z">2023-10-05</time></p><p class="title"><a href="/2023/10/05/3.%E7%BA%BF%E6%80%A7%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">3.线性神经网络</a></p><p class="categories"><a href="/categories/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">动手学深度学习</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2023/10/01/%E6%8A%A5%E5%91%8A/"><img src="/images/wall/3.jpg" alt="具有一定扶正能力的船舶设计"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-10-01T10:08:58.000Z">2023-10-01</time></p><p class="title"><a href="/2023/10/01/%E6%8A%A5%E5%91%8A/">具有一定扶正能力的船舶设计</a></p><p class="categories"><a href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/">课程项目</a> / <a href="/categories/%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/%E5%B7%A5%E7%A8%8B%E8%AE%BE%E8%AE%A1/">工程设计</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2023/09/27/2.%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/"><img src="/images/phi.png" alt="2.预备知识"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-09-27T06:06:00.000Z">2023-09-27</time></p><p class="title"><a href="/2023/09/27/2.%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/">2.预备知识</a></p><p class="categories"><a href="/categories/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">动手学深度学习</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2023/08/02/index/"><img src="/images/book.jpeg" alt="Welcome to XJH&#039;s Secret Base!"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-08-02T11:52:30.000Z">2023-08-02</time></p><p class="title"><a href="/2023/08/02/index/">Welcome to XJH&#039;s Secret Base!</a></p><p class="categories"><a href="/categories/About-XJH/">About XJH</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2023/07/05/20230705/"><img src="/images/story/1.jpg" alt="20230705"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-07-05T01:43:03.000Z">2023-07-05</time></p><p class="title"><a href="/2023/07/05/20230705/">20230705</a></p><p class="categories"><a href="/categories/About-XJH/">About XJH</a> / <a href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/">碎碎念</a> / <a href="/categories/About-XJH/%E7%A2%8E%E7%A2%8E%E5%BF%B5/CQU/">CQU</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">八月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">七月 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">五月 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">三月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C51/"><span class="tag">C51</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CQU/"><span class="tag">CQU</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ChatGPT/"><span class="tag">ChatGPT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FPGA/"><span class="tag">FPGA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MATLAB/"><span class="tag">MATLAB</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/QQbot/"><span class="tag">QQbot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RANSAC/"><span class="tag">RANSAC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROS/"><span class="tag">ROS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/STM32/"><span class="tag">STM32</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XJH/"><span class="tag">XJH</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BC%A0%E7%83%AD%E5%AD%A6/"><span class="tag">传热学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%86%9B%E8%AE%AD/"><span class="tag">军训</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="tag">动手学深度学习</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/"><span class="tag">单片机</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB/"><span class="tag">图像识别</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="tag">学习笔记</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9A%E9%87%8F%E5%88%86%E6%9E%90/"><span class="tag">定量分析</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%8F%E4%BD%9C%E6%96%87/"><span class="tag">小作文</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%8F%E8%BD%A6/"><span class="tag">小车</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"><span class="tag">年终总结</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%9F%E6%97%A5/"><span class="tag">生日</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"><span class="tag">碎碎念</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"><span class="tag">线性代数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%88%B9/"><span class="tag">船</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/"><span class="tag">路径规划</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/title.png" alt="XJH&#039;s Secret Base" height="28"></a><p class="is-size-7"><span>&copy; 2023 明诚</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© Copyright by XJH 此心安处是吾乡。</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Asgard-Tim"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/chitose.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>